# -*- coding: utf-8 -*-
<%inherit file='../base.html'/>
<%namespace file='../../common/widgets.html' name='widget' />
<%namespace file='picklist_summary.html' name='picklist' />

<%def name="page_title()">${_('Evergreen Picklist Entry')}</%def>
<%def name="block_content()">

<%
     fund_map = [(fund.id(), fund.name()) for fund in c.oils.acq.fund_list.value]
%>

${picklist.summary(c.oils.acq.picklist.value, link=True)}

<%include file='lineitem_summary.html'/>

<table id='oils-acq-lineitem-summary'>
    % for attr in c.oils.acq.lineitem.value.attributes():
        <tr>
            <td class='oils-acq-lineitem-attr-name'>
                ${attr.attr_name()}
            </td>
            <td class='oils-acq-lineitem-attr-value'>
                ${attr.attr_value()}
            </td>
        </tr>
    % endfor
</table>

<table id="oils-acq-lineitem-details-table">
    <thead>
        <tr><td>Fund</td><td>Home Library</td></tr>
    </thead>
    <tbody>
        % for detail in c.oils.acq.lineitem.value.lineitem_details():
	    <tr>
	        <td>
		    <form method="post"
			  action="${c.oils.acq.prefix.value}/picklist/update_lineitem">
		        <input type="hidden"
			       name="${c.oils.acq.lineitem_id.cgi_name}"
			       value="${c.oils.acq.lineitem.value.id()}" />
		        <button name='${c.oils.acq.lineitem_detail_id.cgi_name}'
				value='${detail.id()}'>${_("Update")}</button>
		        ${widget.build_selector(c.oils.acq.fund_id.cgi_name, fund_map, detail.fund())}
		    </form>
		</td>
		<td>${detail.owning_lib() or '&nbsp;'}</td>
	    </tr>
	% endfor
    </tbody>
</table>
<div id='oils-acq-lineitem-marc-block'>
    <div id='oils-acq-lineitem-marc'>
        ${unicode(c.oils.acq.lineitem_marc_html.value, 'utf-8')}
    </div>
</div>

</%def>

