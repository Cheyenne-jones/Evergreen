# -*- coding: utf-8 -*-
<%inherit file='../base.html'/>
<%namespace file='../../common/widgets.html' name='widget' />
<%namespace file='picklist_summary.html' name='picklist' />

<%def name="page_title()">${_('Evergreen Picklist Entry')}</%def>
<%def name="block_content()">

<%
     fund_map = [(fund.id(), fund.name()) for fund in c.oils.acq.fund_list.value]
     def sort_lid(a, b):
         return cmp(a.id(), b.id())
%>

${picklist.summary(c.oils.acq.picklist.value, link=True)}

<%include file='lineitem_summary.html'/>

<table id='oils-acq-lineitem-summary'>
    % for attr in c.oils.acq.lineitem.value.attributes():
        % if attr.attr_name() != 'title':
            <tr>
                <td class='oils-acq-lineitem-attr-name'>
                    ${attr.attr_name()}
		</td>
		<td class='oils-acq-lineitem-attr-value'>
                    ${attr.attr_value()}
		</td>
            </tr>
	% endif
    % endfor
</table>

<table id="oils-acq-lineitem-details-table">
    <thead>
        <tr><td>ID</td><td>Fund</td><td>Home Library</td></tr>
    </thead>
    <tbody>
        ${c.oils.acq.lineitem.value.lineitem_details().sort(sort_lid)}
        % for detail in c.oils.acq.lineitem.value.lineitem_details():
	    <Form method="post"
		  action="${c.oils.acq.prefix.value}/picklist/update_lineitem">
	        <input type="hidden"
		       name="${c.oils.acq.lineitem_id.cgi_name}"
		       value="${c.oils.acq.lineitem.value.id()}" />
		<tr>
	            <td>${detail.id()}</td>
	            <td>
		        ${widget.build_selector(c.oils.acq.fund_id.cgi_name, fund_map, detail.fund())}
		    </td>
		    <td>${detail.owning_lib() or 'None'}</td>
		    <td>
		        <button name='${c.oils.acq.lineitem_detail_id.cgi_name}'
				value='${detail.id()}'>${_("Update")}</button>
		    </td>
		</tr>
	    </form>
	% endfor
    </tbody>
</table>
<div id='oils-acq-lineitem-marc-block'>
    <div id='oils-acq-lineitem-marc'>
        ${unicode(c.oils.acq.lineitem_marc_html.value, 'utf-8')}
    </div>
</div>

</%def>

