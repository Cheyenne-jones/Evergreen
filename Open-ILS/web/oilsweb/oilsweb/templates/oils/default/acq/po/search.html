# -*- coding: utf-8 -*-
<%inherit file='base.html'/>
<%def name="page_title()">${_('PO Search')}</%def>
<%def name="block_content()">

<div id='oils-acq-list-header' class='container'>
    <div id='oils-acq-list-header-label'>${_('PO Search')}</div>
</div>

<!-- load the page-specific JS -->
<script src='${c.oils.core.media_prefix.value}/ui_js/oils/default/acq/po/search.js'> </script>

<script>
    function getId(rowIndex) {
        data = poGrid.model.getRow(rowIndex);
        if(!data) return;
        return '<a href="${c.oils.acq.prefix.value}/po/view/' + data.id + '">'+data.id;
    }
</script>


<form dojoType='dijit.form.Form' action='' method=''>
    <script type="dojo/method" event="onSubmit">
        fields = this.getValues();
        if(fields.provider == '')
            delete fields.provider;
        if(isNaN(fields.id))
            delete fields.id;
        doSearch(fields);
        return false; /* don't redirect */
    </script>
    <table class='oils-acq-basic-form-table'>
        <tr>
            <td><label for='id'>${_('ID')}</label></td>
            <td><input dojoType='dijit.form.NumberTextBox' name='id'> </input></td>
        </tr>
        <tr>
            <td><label for='provider'>${_('Provider')}</label></td>
            <td><select labelAttr='code' searchAttr='code' name='provider' 
                style='overflow-y:auto;' jsId="providerSelector" dojoType="dijit.form.FilteringSelect"> </select></td>
        </tr>
        <tr>
            <td><label for='state'>${_('State')}</label></td>
            <td>
                <select dojoType='dijit.form.FilteringSelect' name='state' value=''>
                    <option value='new'>${_("New")}</option>
                    <option value='in-process'>${_("In Process")}</option>
                </select>
            </td>
        </tr>
        <tr>
            <td><label for='ordering_agency'>${_('Ordering Agency')}</label></td>
            <td><select jsId='poSearchOrderingAgencySelect' 
                dojoType='openils.widget.OrgUnitFilteringSelect' name='ordering_agency'>
                </select>
            </td>
        </tr>
        <tr>
            <td style='text-align:center;'><div dojoType='dijit.form.Button' type='submit'>${_("Search")}</div></td>
        </tr>
    </table>
</form>

<script>
    var poGridStructure = [{
        cells : [[
            {name: '${_("ID")}', field: 'id', get:getId},
            {name: '${_("Owner")}', get:getPOOwner},
            {name: '${_("Ordering Agency")}', get:getOrgInfo},
            {name: '${_("Create Time")}', field:'create_time', get:getDateTimeField, width:'auto'},
            {name: '${_("Edit Time")}', field: "edit_time", get:getDateTimeField, width:'auto'},
            {name: '${_("Provider")}', get:getProvider, width:'auto'},
            {name: '${_("State")}', field:'state'}
        ]]
    }];
</script>
<div jsId='poGrid' id='po-grid' dojoType="dojox.Grid" structure='poGridStructure'></div>
<script>dojo.style('po-grid', 'visibility', 'hidden');</script>

</%def>


