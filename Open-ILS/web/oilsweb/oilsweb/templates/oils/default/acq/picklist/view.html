# -*- coding: utf-8 -*-
<!-- 
 vim:ts=4:sw=4:et:ft=mako: 
-->
<%inherit file='base.html'/>
<%namespace file='../../common/jubgrid.html' name='jubgrid'/>
<%def name="block_js()">
    ${parent.block_js()}
    <script type='text/javascript'>
	dojo.require('dijit.layout.LayoutContainer');
	dojo.require('dijit.layout.ContentPane');
    dojo.require('openils.acq.Picklist');
    </script>
</%def>
<%def name="page_title()">${_('Picklist')}</%def>

<%def name="block_content()">
<div dojoType="dijit.layout.LayoutContainer" style="height:100%">
    <div dojoType="dijit.layout.ContentPane" layoutAlign="top" jsId="pl_header">
	<div id='oils-acq-picklist-header'>
            ${_('Picklist')}
	    <span id='oils-acq-picklist-name'> </span>
	    <div class='oils-acq-picklist-attributes'>
		<div>Create
		date: <span id="oils-acq-picklist-attr-cdate"></span></div>
		<div>Last updated: <span id="oils-acq-picklist-attr-edate"></span></div>
		<div>Selector: <span id="oils-acq-picklist-attr-owner"></span></div>
	    </div>
	</div>
    </div>
    <script type="text/javascript">
            var plist = null;
            function loadPL() {
		plist = new openils.acq.Picklist(${c.oils.acq.picklist.value},
				function(model) {
				    dojo.byId("oils-acq-picklist-name").innerHTML = plist.name();
				    dojo.byId("oils-acq-picklist-attr-cdate").innerHTML = plist.create_time();
				    dojo.byId("oils-acq-picklist-attr-edate").innerHTML = plist.edit_time();
				    dojo.byId("oils-acq-picklist-attr-owner").innerHTML = plist.owner();
				    JUBGrid.populate(pickListGrid,
						     model,
						     plist._items);
				    dojo.connect(model.store,
						 "onSet",
						 function(griditem,
							  attr,
							  oldVal,
							  newVal) {
						     plist.onJUBSet(griditem,
								    attr,
								    oldVal,
								    newVal);
						 }); 
				});
            }
	    dojo.addOnLoad(loadPL);
    </script>
    ${jubgrid.jubgrid('oils-acq-picklist', 'pickListGrid')}
</div>
</%def>
<!-- Local Variables: -->
<!-- mmm-classes: html-js -->
<!-- End: -->
