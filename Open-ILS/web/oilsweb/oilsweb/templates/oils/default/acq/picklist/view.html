# -*- coding: utf-8 -*-
<!-- 
 vim:ft=mako: 
-->
<%inherit file='../base.html'/>
<%namespace file='../../common/widgets.html' name='widget' />

<%def name="page_title()">${_('Picklist')}</%def>
<%def name="block_content()">

<%include file='picklist_summary.html'/>

<%
    import oilsweb.lib.bib
    from oilsweb.lib.acq.picklist import PicklistMgr
%>

<form method='POST' action='${c.oils.acq.prefix.value}/picklist/update'>
<input type='hidden' name='${c.oils.acq.picklist_source_id.cgi_name}' value='${c.oils.acq.picklist.value.id()}'/>
<table id='oils-acq-picklist-table'>
    <thead>
        <tr>
            <td colspan='3' id='oils-acq-picklist-header-block'>
                <table id='oils-acq-picklist-header-subtable'><tr>
                <td id='oils-acq-picklist-paging-block'>
		  ${widget.paging(c.oils.acq.offset.value,
		                  c.oils.acq.limit.value,
		                  c.oils.acq.picklist.value.entry_count())}
                </td>
                <td id='oils-acq-picklist-actions-block'>
                    <select name='${c.oils.acq.picklist_action.cgi_name}'>
                        <option value='move_selected'>${_('Move Selected to Picklist...')}</option>
                    </select>
                    <select name='${c.oils.acq.picklist_dest_id.cgi_name}'>
                        <option selected='selected' value=''>${_('-- Select A Picklist --')}</option>
                        % for list in c.oils.acq.picklist_list.value:
                            <option value='${list.id()}'>${list.name()}</option>
                        % endfor
                    </select>
                    <input type='submit' value='${_("Submit")}'/>
                </td>
                </tr></table>
            </td>
        </tr>
    </thead>
    <tbody>
    % for lineitem in c.oils.acq.picklist.value.entries():
    <tr class='oils-acq-picklist-records-title-row'>
        <td rowspan='3'>
            <img class='oils-acq-picklist-records-jacket'
                src='${c.oils.core.ac_prefix.value}/jacket/small/${oilsweb.lib.bib.scrub_isbn(PicklistMgr.find_lineitem_attr(lineitem, "isbn"))}'/>
        </td>
        <td>
            <a href='../view_lineitem/${lineitem.id()}'>${h.util.html_escape(PicklistMgr.find_lineitem_attr(lineitem, "title"))}</a>
        </td>
        <td class='oils-acq-picklist-records-service-td'>
            % if lineitem.provider():
                ${lineitem.provider().name()}
            % endif
        </td>
        <td><input type='checkbox' name='${c.oils.acq.lineitem_id_list.cgi_name}' value='${lineitem.id()}'/></td>
    </tr>

    <tr class='oils-acq-picklist-records-author-row'>
        <td colspan='4'>${PicklistMgr.find_lineitem_attr(lineitem, "author")}</td>
    </tr>
    <tr class='oils-acq-picklist-records-phys_desc-row'>
        <td colspan='4'>
            ${PicklistMgr.find_lineitem_attr(lineitem, "isbn")} |
            ${PicklistMgr.find_lineitem_attr(lineitem, "pubdate")} |
            ${PicklistMgr.find_lineitem_attr(lineitem, "pagination")}
            <a class='oils-acq-picklist-lineitem-delete-link' href='${c.oils.acq.prefix.value}/picklist/delete_lineitem/${lineitem.id()}'>${_('Delete')}</a>
        </td>
    </tr>
    % endfor
    </tbody>
</table>
</form>
</%def>
