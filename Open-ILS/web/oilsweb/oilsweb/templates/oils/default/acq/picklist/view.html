# -*- coding: utf-8 -*-
<!-- 
 vim:ts=4:sw=4:et:ft=mako: 
-->
<%inherit file='../base.html'/>
<%namespace file='../../common/widgets.html' name='widget' />
<%namespace file='picklist_summary.html' name='picklist' />
<%def name="page_title()">${_('Picklist')}</%def>
<%def name="block_content()">

<%
    import oilsweb.lib.bib
    from oilsweb.lib.acq.picklist import PicklistMgr
%>

${picklist.summary(c.oils.acq.picklist.value)}

<div id='oils-acq-picklist-header-block'>
    <div class='spacer'>&nbsp;</div>
    <div id="oils-acq-picklist-paging-block">
      ${widget.paging(c.oils.acq.offset.value, c.oils.acq.limit.value,
                      c.oils.acq.picklist.value.entry_count())}
    </div>
    <div id="oils-acq-picklist-actions-block">
        <select name='${c.oils.acq.picklist_action.cgi_name}'>
            <option value='move_selected'>${_('Move Selected to Picklist...')}</option>
        </select>
        <select name='${c.oils.acq.picklist_dest_id.cgi_name}'>
            <option selected='selected' value=''>${_('-- Select A Picklist --')}</option>
            % for list in c.oils.acq.picklist_list.value:
                <option value='${list.id()}'>${list.name()}</option>
            % endfor
o        </select>&nbsp;<input type='submit' value='${_("Submit")}'/>
    </div>
    <div class='spacer'>&nbsp;</div>
</div>
<div id='fred'>
<table id="oils-acq-picklist-table">
  <thead>
    <tr>
        <td colspan="2">Item Description</td>
	<td class="oils-acq-picklist-records-copies">#&nbsp;of&nbsp;Copies</td>
    </tr>
  </thead>
  <tbody>
    % for lineitem in c.oils.acq.picklist.value.entries():
        <tr class='oils-acq-picklist-records-title'>
	    <td class='oils-acq-picklist-records-jacket-td'>
	        <img class='oils-acq-picklist-records-jacket'
		     src='${c.oils.core.ac_prefix.value}/jacket/small/${oilsweb.lib.bib.scrub_isbn(PicklistMgr.find_lineitem_attr(lineitem, "isbn"))}'/>
	    </td>
	    <td><a href='../view_lineitem/${lineitem.id()}'>${h.util.html_escape(PicklistMgr.find_lineitem_attr(lineitem, "title"))}</a>
	        ${PicklistMgr.find_lineitem_attr(lineitem, "publisher")}
	        ${PicklistMgr.find_lineitem_attr(lineitem, "pubdate")}
	        ${PicklistMgr.find_lineitem_attr(lineitem, "pagination")}
	        ${PicklistMgr.find_lineitem_attr(lineitem, "isbn")}
	        ${PicklistMgr.find_lineitem_attr(lineitem, "price")}
	    </td>
	    <td class="oils-acq-picklist-records-copies">
	        <form method="POST"
		      action="${c.oils.acq.prefix.value}/picklist/update">
		    <input name="${c.oils.acq.picklist_source_id.cgi_name}"
			   type="hidden"
			   value="${c.oils.acq.picklist.value.id()}" />
	            <input name="${c.oils.acq.lineitem_item_count.cgi_name}"
		       type="text" size="3" value="${lineitem.item_count()}" />
            <button name='${c.oils.acq.lineitem_id.cgi_name}'
             value='${lineitem.id()}'>${_("Update")}</button>
		</form>
	    </td>
        </tr>
    % endfor
  </tbody>
</table>
</div>
</%def>
