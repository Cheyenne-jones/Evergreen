# -*- coding: utf-8 -*-
<!-- 
 vim:ft=mako: 
-->
<%inherit file='../base.html'/>
<%def name="page_title()">${_('Picklist')}</%def>
<%def name="block_content()">

<%include file='picklist_summary.html'/>

<%
    import oilsweb.lib.bib
    from oilsweb.lib.acq.picklist import PicklistMgr
%>

<form method='POST' action='${c.oils.acq.prefix.value}/picklist/update'>
<input type='hidden' name='${c.oils.acq.picklist_source_id.cgi_name}' value='${c.oils.acq.picklist.value.id()}'/>
<table id='oils-acq-picklist-table'>
    <thead>
        <tr>
            <td colspan='3' id='oils-acq-picklist-header-block'>
                <table id='oils-acq-pikclist-header-subtable'><tr>
                <td id='oils-acq-picklist-paging-block'>
                    <%
                        c.oils.acq.offset.value = int(c.oils.acq.offset.value)
                        c.oils.acq.limit.value = int(c.oils.acq.limit.value)
                        # set up the paging info
                        paging = _('Entries %(offset)s - %(limit)s') % {
                            'offset': c.oils.acq.offset.value + 1,
                            'limit': c.oils.acq.limit.value + c.oils.acq.offset.value
                        }
                    %>
                    ${paging}
                    % if c.oils.acq.offset.value > 0:
                        <a href='?${c.oils.acq.offset.cgi_name}=${c.oils.acq.offset.value - c.oils.acq.limit.value}'>&#171;</a>
                    % endif
                    <a href='?${c.oils.acq.offset.cgi_name}=${c.oils.acq.offset.value + c.oils.acq.limit.value}'>&#187;</a>
                </td>
                <td id='oils-acq-picklist-actions-block'>
                    <select name='${c.oils.acq.picklist_action.cgi_name}'>
                        <option value='move_selected'>${_('Move Selected to Picklist...')}</option>
                    </select>
                    <select name='${c.oils.acq.picklist_dest_id.cgi_name}'>
                        <option selected='selected' value=''>${_('-- Select A Picklist --')}</option>
                        % for list in c.oils.acq.picklist_list.value:
                            <option value='${list.id()}'>${list.name()}</option>
                        % endfor
                    </select>
                    <input type='submit' value='${_("Submit")}'/>
                </td>
                </tr></table>
            </td>
        </tr>
    </thead>
    <tbody>
    % for entry in c.oils.acq.picklist.value.entries():
    <tr class='oils-acq-picklist-records-title-row'>
        <td rowspan='3'>
            <img class='oils-acq-picklist-records-jacket'
                src='${c.oils.core.ac_prefix.value}/jacket/small/${oilsweb.lib.bib.scrub_isbn(PicklistMgr.find_entry_attr(entry, "isbn"))}'/>
        </td>
        <td>
            <a href='../view_entry/${entry.id()}'>${PicklistMgr.find_entry_attr(entry, "title")}</a>
        </td>
        <td class='oils-acq-picklist-records-service-td'>
            % if entry.provider():
                ${entry.provider().name()}
            % endif
        </td>
        <td><input type='checkbox' name='${c.oils.acq.picklist_entry_id_list.cgi_name}' value='${entry.id()}'/></td>
    </tr>

    <tr class='oils-acq-picklist-records-author-row'>
        <td colspan='4'>${PicklistMgr.find_entry_attr(entry, "author")}
    </tr>
    <tr class='oils-acq-picklist-records-phys_desc-row'>
        <td colspan='4'>
            ${PicklistMgr.find_entry_attr(entry, "isbn")} |
            ${PicklistMgr.find_entry_attr(entry, "pubdate")} |
            ${PicklistMgr.find_entry_attr(entry, "pagination")}
            <a class='oils-acq-picklist-entry-delete-link' href='${c.oils.acq.prefix.value}/picklist/delete_entry/${entry.id()}'>${_('Delete')}</a>
        </td>
    </tr>
    % endfor
    </tbody>
</table>
</form>
</%def>
