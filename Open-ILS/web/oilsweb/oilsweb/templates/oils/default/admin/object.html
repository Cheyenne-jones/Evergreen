<!-- vim:set filetype=mako: -->
<%inherit file='base.html'/>
<%namespace name='widget' file='widgets.html'/>

<%def name="page_title()">${_('Evergreen Admin')}</%def>
<%def name="block_content()">
    <div id='oils-admin-object-lable'>${c.oils.adm.object_meta.value.label}</div>
    % if c.oils.adm.mode.value == 'delete':
    <div>
        <%
        ## Why does doing this inline (inside ${...}) give me a syntax error????
        string = _("Are you sure you want to delete %(cls)s with id %(id)d?") % {"cls":c.oils.adm.object_class.value, "id":c.oils.adm.object.value.id()}
        %>
        ${string}
    </div>
    % else:
    <form action='update_object' method='POST'>
    <table id='oils-admin-object-table'>
        % for fieldmeta in [ f for f in c.oils.adm.object_meta.value.fields if not f.virtual]:
            <tr>
                <td>${fieldmeta.label}</td>
                <td>
                    % if c.oils.adm.mode.value == 'update':
                        (${fieldmeta.rpt_datatype}) 
                        ${widget.load(fieldmeta.rpt_datatype,fieldmeta.name, getattr(c.oils.adm.object.value, fieldmeta.name)())}
                    % else:
                        % if c.oils.adm.mode.value == 'create':
                            <input type='text' size='36' />
                        % else:
                            % if c.oils.adm.mode.value == 'view':
                                <span>${unicode(getattr(c.oils.adm.object.value, fieldmeta.name)())}</span>
                            % endif
                        % endif
                    % endif
                </td>
            </tr>
        % endfor
    </table>
    </form>
    % endif
</%def>

