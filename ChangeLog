Changes between version 1.6.1.0 and 2.0.0 (approximately)
=========================================================

2010-06-14  senator

	* Tiny bug in 16714; fixing it prevents a useless logline in some
	  cases

2010-06-14  phasefx

	* the dojo code now behind the util.date iso8601 formatter neither
	  needs nor likes us appending timestamps to dates like that

2010-06-15  phasefx

	* in patron editor, prevent Save and Save & Clone from working with
	  an invalid form, or duplicate barcode or usrname

2010-06-15  dbs

	* Avoid spurious errors when searching more granular indexes
	  
	  The storage service automatically generates methods for each
	  top-level search
	  class, like
	  open-ils.storage.authority.keyword.see_from.controlled.atomic,
	  but
	  here we were trying to access more granular methods (which
	  storage does not
	  know about) when a granular index was used. This generated an
	  ugly error in
	  the logs.
	  
	  To avoid these errors, we'll only look for cross references from
	  the broad
	  index class to which the granular index belonds.

2010-06-15  miker

	* support pre-indexing normalizers for facet value normalization
	  (negative pos value in the field-norm map)

2010-06-15  senator

	* Acq: minor menu reorganization. Move admin-oriented interfaces to
	  admin menu.
	  
	  Also remove "Purchase Order Events" from the acq menu: it's
	  outmoded.

2010-06-15  phasefx

	* specify @autoscroll=false for xul browser elements

2010-06-15  erickson

	* no need to start a xact in lineitem search api call, especially
	  if it's not closed out when done

2010-06-15  senator

	* Acq: misc minor bugfixes to various admin interfaces that didn't
	  load
	  consistently. Also a little more menu re-org.

2010-06-16  phasefx

	* the layer/bundle version of dojo I was using hid the need for
	  this dojo.require line

2010-06-16  miker

	* add support for status and copy location filters to supercat
	  browse apis for call number, title/author/etc, item age and
	  general tag browsing

2010-06-16  erickson

	* make logout with receipt the default for self-check

2010-06-16  senator

	* Acq: bugfixes for "Import Catalog Records by ID"
	  
	  Previously, this interface did not correctly interpret realistic
	  CSV data as
	  produced by the Reporter module, as it was intended to do.

2010-06-16  miker

	* update the documentation for browse methods re status/location
	  filters

	* steps toward wiring up authority browse via supercat

	* use the authority, instead of bib, general tag browse method

	* add authority marcxml retrieve method, switch on record type

	* typo in json_query for authority browse

	* split registration of authority browse urls out from record; add
	  authority formats ML method

2010-06-16  senator

	* Acq: Fix display failure in fund tag interface. Add admin
	  interfaces for
	  invoice_payment_method and invoice_item_type.

	* Acq: remove PO search interface from staff client's acquisitions
	  menu
	  
	  The PO search interface is redundant with the generalized
	  Acquisitions Search
	  interface

2010-06-17  scottmk

	* Support CAST expressions, taking care to avoid SQL injection.
	  
	  M Open-ILS/include/openils/oils_buildq.h
	  M Open-ILS/src/c-apps/oils_storedq.c
	  M Open-ILS/src/c-apps/buildSQL.c

2010-06-17  phasefx

	* id collision preventing proper use of these columns

	* correctly sort date/timestamp columns in xul lists now that
	  they're localized

	* more column id collisions and code to rename such id's if they
	  slip through in the future

	* Kludge to fix ISO timestamp parsing in AutoFieldWidget

2010-06-17  miker

	* protecting facet_xpath from returning empty nodesets

2010-06-17  phasefx

	* typo

2010-06-17  miker

	* record evidence of the perl-xpath experiment ... not faster
	  enough to warrant the danger of XML::LibXML

2010-06-17  senator

	* Acq: Remove the "Selection Lists" entry from the staff client's
	  menu
	  
	  The unified search interface now does everything that the
	  Selection Lists
	  interface could.
	  
	  Also, merging selection lists now updates the edit_time field on
	  the lead
	  list.

2010-06-17  scottmk

	* 1. Disable fleshing for PCRUD. Otherwise fleshing would provide a
	  back door whereby a user could see stuff he has no permission to
	  see.
	  
	  2. For the id_list method: strip out the "flesh_fields" entry,
	  not
	  the "flesh_columns" entry (which doesn't exist). This actually
	  makes
	  no difference, but if we're going to do something useless, we
	  might
	  as well do it right.
	  
	  M Open-ILS/src/c-apps/oils_sql.c

2010-06-18  miker

	* support unapi tag embedding in authority records

	* pushing unapi depth support back into trunk

2010-06-18  scottmk

	* Define some stock datatypes in query.datatype.
	  
	  Set the sequence for query.datatype to leave room for more
	  stock datatypes if we want to add them.
	  
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  M Open-ILS/src/sql/Pg/008.schema.query.sql
	  A Open-ILS/src/sql/Pg/upgrade/0311.data.query-seed-datatypes.sql
	  M Open-ILS/src/sql/Pg/950.data.seed-values.sql

2010-06-18  miker

	* add prompt to install Google Chrome Frames when in IE

	* setting the noGCF cookie to expire after a year, instead of at
	  the end of the browser session

2010-06-18  atz

	* EDI/JEDI Translator test client
	  
	  Signed-off-by: Joe Atzberger <atz@esilibrary.com>

	* Repo note

	* Extra field in display (slight reorder)

	* Log message to both STDERR and log.

	* 0312 - JEDI template support for multiple ISBNs
	  
	  of same or different types. The first ISBN-13 is treated as
	  primary, if there is one. Otherwise the first ISBN-10 is used.
	  
	  Signed-off-by: Joe Atzberger <atz@esilibrary.com>

2010-06-18  miker

	* add serial.subscription.owning_lib

	* make sure $depth is defined, and used

2010-06-18  senator

	* Acq: more menu reorganization
	  
	  New entry points to selection list, PO, and invoice interfaces.
	  Also replaced
	  visible references to "Pick List" with "Selection List" wherever
	  I could think
	  of, for consistency's sake.

2010-06-18  phasefx

	* stop the autoscrolling behavior with AutoFieldWidget

	* expose the internal record id and create date for a user as a
	  tooltip over the user's name in the patron display

2010-06-18  miker

	* add serials holdings to the holdings_xml data for bibs

2010-06-19  dbs

	* Apply RHEL5 prerequisite installer patch by Lee Dickens
	  <ldickens@esilibrary.com>
	  
	  Tweaked slightly to break some long lines over multiple shorter
	  lines

2010-06-21  senator

	* Acq: add default sort order to canned searches, and provide
	  middle layer
	  support for sort order for unified search generally. The UI for
	  that may
	  come later.

	* Acq: yet another menu-reorganizing commit

2010-06-21  phasefx

	* rough cut at integrating ChiliFresh reviews with OPAC search
	  results and record details page. Needs polish

2010-06-22  scottmk

	* 1. In oils_sql.c: make the functions is_identifier() and
	  is_good_operator()
	  global instead of static.
	  
	  2. Use them to protect qstore against various forms of sql
	  injection.
	  
	  M Open-ILS/include/openils/oils_sql.h
	  M Open-ILS/src/c-apps/oils_storedq.c
	  M Open-ILS/src/c-apps/oils_sql.c

2010-06-22  gmc

	* bug #597245: remove ersatz $7 "tags" from MARC tag selector
	  
	  Signed-of-by: Galen Charlton <gmc@esilibrary.com>

2010-06-22  erickson

	* when you execute MARC, it opens a portal to the hellmouth

	* added warnings for missing params to MinPassiveTargetAge
	  validator; missing params results in invalid for all target
	  objects (noop_false)

	* removed deprecated MaxPassiveDelayAge validator from default
	  courtesy notice definition

2010-06-22  phasefx

	* better way of setting these environment variables

	* this should place things better across different browsers re:
	  Chilifresh

2010-06-22  senator

	* Acq: add a Create PO interface for workflows starting with new,
	  blank POs

	* Acq: make the PO summary pane less monstrously vertical; add PO
	  history link

2010-06-22  miker

	* caching extention for org tree traversal

2010-06-22  gmc

	* add 954.data.marc21expand880.sql to build-db.sh so that it gets
	  picked up during new installations
	  
	  Signed-of-by: Galen Charlton <gmc@esilibrary.com>

2010-06-22  atz

	* Script for git-svn repos (with possible github remote)
	  
	  Please heed WARNING in the script comments.

2010-06-23  atz

	* SIP Callnumber extensions, POD
	  
	  Use org_unit shortname everywhere, no owning_lib.
	  
	  Checkin response and Item Info response now return callnumber w/
	  current SIP code.

2010-06-23  miker

	* protect templated slots from errors when there are no template
	  variables

2010-06-23  phasefx

	* correct the logic for detecting whether ChiliFresh has been
	  configured, and add similar support for Novelist

	* proper spelling of this trademark

2010-06-23  miker

	* a bit more protection for non-cached values; beware the null
	  depth in the two-param version of actor.org_unit_descendants!

2010-06-23  dbs

	* Add an explicit link to the favicon.ico per
	  http://www.w3.org/2005/10/howto-favicon
	  
	  Yeah, we're not using the profile attribute on the HEAD element.
	  Do we really need that?

2010-06-23  atz

	* Cancel reasons from EDI spec
	  
	  Technically, these aren't all cancellation reasons, they are just
	  "Action request/notification description codes". A "5" (or 1005,
	  here)
	  actually means success, for example.
	  
	  Examine the EDI list here:
	  http://www.stylusstudio.com/edifact/D04B/1229.htm
	  
	  Include keep_debits field although it does not necessarily apply
	  to each row.
	  
	  Signed-off-by: Joe Atzberger <atz@esilibrary.com>

2010-06-24  scottmk

	* Whenever a database call fails -- i.e. whenever dbi_conn_query()
	  or
	  dbi_conn_queryf() returns NULL -- call dbi_conn_error() to get a
	  description of the error, and include that description in the log
	  message.
	  
	  M Open-ILS/src/c-apps/oils_sql.c

2010-06-24  gmc

	* remove duplicate entries for tag 760 from MARC21 tag list
	  
	  Signed-of-by: Galen Charlton <gmc@esilibrary.com>

2010-06-24  dbs

	* First stab at Fedora 13 support in prerequisite installer
	  
	  Of possible concern: the use of -JS_THREADSAFE in
	  JavaScript::SpiderMonkey.
	  Need to test this change on other distros - but it enabled me to
	  avoid
	  the libperl.so linking hacks used on RHEL and CentOS.

	* We don't need to install plpython for PostgreSQL;
	  also, add a target for the Fedora PostgreSQL server prereqs.

	* Fix Fedora 13 compiling for libdbi/libdbd
	  
	  * Add libdbi-devel as a prereq
	  * Add Fedora's 64-bit location for the dbd driver libraries

	* Fix compile error due to undefined LONG_MAX constant, which is
	  defined in limits.h

	* Make '3 Day Pre-Overdue Notice' work in seed data; we were
	  missing a validator
	  
	  This was inserted properly in upgrade 0054, so we're just playing
	  catch-up here

	* Use a valid validator for 3 Day Pre-Overdue notice event
	  
	  Curse traitorous middle-click and my tired eyes.

2010-06-24  atz

	* 0314 Baseline data
	  
	  Signed-off-by: Joe Atzberger <atz@esilibrary.com>

2010-06-24  miker

	* and imagine that, the ou passed to
	  actor.org_unit_descendants(INT) might also be null. super.

	* add agency-stripping and btrim normalizers; add identifier|arcn
	  index def as facet

	* arg ... thinkos. 0315 will work now

2010-06-24  scottmk

	* 1. Degrade (relatively) gracefully when the database connection
	  dies.
	  
	  Problem to be solved: a server drone that loses its database
	  connection
	  immediately becomes unusable. It might manage to reconnect, but
	  that
	  wouldn't help if a transaction was in progress at the time of the
	  failure.
	  
	  If the drone merely reports an error and then makes itself
	  available
	  for more requests, every request that it services thereafter will
	  fail.
	  It will continue to fail repeatedly until it reaches the
	  max_requests
	  limit, or until someone kills it manually.
	  
	  Solution: terminate immediately, without waiting for max_requests
	  or a
	  DISCONNECT request. The listener can replace it with a new drone,
	  which will try to establish its own database connection.
	  
	  2. Correct an oversigt in doUpdate() and doDelete().
	  
	  If the database operation fails, report an error to the client.
	  The old code would log an error message but otherwise behave as
	  if
	  the operation had succeeded.
	  
	  It is conceivable that this change will appear to break
	  something,
	  because an operation will fail that would otherwise have appeared
	  to succeed. However if that happens, whatever breaks was already
	  broken; the appearance of success was a snare and a delusion.
	  
	  M Open-ILS/include/openils/oils_sql.h
	  M Open-ILS/src/c-apps/oils_sql.c

2010-06-24  miker

	* doh, another thinko. spotted by Scott McKellar

2010-06-24  dbs

	* Return NULL if we don't have anything else to return (keeps the
	  compiler happy)

2010-06-25  dbs

	* Provide support for Class::DBI::Frozen::301 via
	  UNIVERSAL::require
	  
	  Class::DBI changed its API interfaces after the 3.0.1 release,
	  causing much
	  pain (and incompatibility for existing applications like
	  Evergreen). Some
	  distributions package Class::DBI 0.96 or 3.0.1, but newer
	  distributions
	  package an incompatible 3.0.17. An alternative is to install the
	  Class::DBI::Frozen::301 module from source; UNIVERSAL::require
	  enables us
	  to try loading both and use whichever one we find.

2010-06-25  miker

	* vandelay.add_field bug fix; add stored procs to 1) create an
	  authority-based overlay template and 2) allow simple application
	  of said template directly with marcxml

	* we will use a real mapping table instead

2010-06-25  dbs

	* Make CentOS/RHEL use Class::DBI::Frozen::301 and remove
	  Class::DBI::Pg (not necessary)

2010-06-25  senator

	* Acq: fixing misc UI glitches
	  
	  Creating allocations and credits in the Funding Source Details
	  interface
	  didn't populate the appropriate grid immediately, but now it
	  does.
	  
	  New tags didn't seem to persist in the Fund Details interface if
	  you switched
	  tabs and then came back to the Tags tab. Fixed.
	  
	  Changed some tab names of misc Acq interfaces to match their
	  current names in
	  the staff client menu.

2010-06-25  miker

	* add bib-authority linking table; add stored proc to extract
	  linking; add hook to ingest (controlled by internal_flag) to
	  implement authority link extraction

	* add stored procs to implement authority propagation if links
	  exist; add trigger to optionally fire this propagation (default
	  ON)

2010-06-25  phasefx

	* proxied added content support for ContentCafe

2010-06-27  dbs

	* Correct syntax for dojo.string.substitute() and remove offending
	  unpaired parens

2010-06-28  miker

	* thinko when trying to preserve any user change to the
	  internal_flag version of the ingest.disable_authority_linking
	  enabled setting

2010-06-28  scottmk

	* Support function calls with subfields, e.g. (func(args))."id".
	  
	  Note that this support treats the subfield as an optional
	  component of the functional call, not as a type of expression
	  in its own right. A subsequent commit will eliminate the "xfld"
	  expression type.
	  
	  M Open-ILS/include/openils/oils_buildq.h
	  M Open-ILS/src/c-apps/oils_storedq.c
	  M Open-ILS/src/c-apps/buildSQL.c

2010-06-28  miker

	* forcibly maintain an appropriate 901 field in all MARC data via
	  triggers

	* add missed stored proc to base schema; adjust said stored proc to
	  use 901 (or provided id) instead of 035 for bib-authority linking

2010-06-28  scottmk

	* Represent a subfield expression as a variant of a function call
	  expression, rather than a function call in its own right.
	  
	  1. Eliminate 'xfld' as a valid value for query.expression.type.
	  
	  2. Eliminate the query.expr_xfld view.
	  
	  3. Expand the query.expr_xfunc view to include the column_name
	  column.
	  
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  M Open-ILS/src/sql/Pg/008.schema.query.sql
	  A Open-ILS/src/sql/Pg/upgrade/0322.schema.query.no-xfld-expr.sql
	  M Open-ILS/examples/fm_IDL.xml

2010-06-29  senator

	* Booking: begin forward-porting code from rel_1_6.
	  
	  Booking (regrettably) was largely written directly against a 1.6
	  environment
	  instead of written for trunk and backported. So now we have
	  booking code in
	  rel_1_6 and rel_1_6_1 that works, but that needs to be cleanly
	  merged with
	  trunk. There has been a lot of drift, and this won't be easy.
	  
	  Here is the first step (some of the easy stuff). These files have
	  been updated
	  wholesale with their contents from rel_1_6, since they don't
	  affect anything
	  other than booking itself.
	  
	  Just to be clear: this commit does not complete the booking
	  foward-port. The
	  booking module did not work in trunk before this commit, and it
	  does not work
	  after this commit. For the moment, booking only works in the
	  rel_1_6 branch,
	  in the rel_1_6_1 branch, and in 1.6.1.* releases. It still does
	  not work in
	  trunk, and it will take a few more hairy commits to get things in
	  sync.
	  
	  Once that's finally done, any future Booking code can be written
	  the Right Way
	  (in trunk) and *back*ported thence to whatever other branches as
	  needed.

	* Fix copy-and-paste-o.

2010-06-29  miker

	* improve browse support; correct thinkos in new holdings fleshing
	  code; improve generated MODS XML (remove some namespace prefixes)

2010-06-29  phasefx

	* File->Join Tabs experiment. Can disable through prefs.js, and I
	  may make disabled the default before we branch trunk depending
	  how things play out. One current limitation is that the
	  interfaces thus joined get reloaded as a consequence of their
	  respective DOM nodes being relocated, so tab joining is most
	  useful to setup prior to retrieving information you'd like to
	  view side by side. I haven't found an easy way around this,
	  though we could roll our own tab browser (bleh) or come up with a
	  generic way for interfaces to save their state. Tab labels are
	  also imperfect, given that interfaces are able to dynamically
	  modify the tab label and can clobber each other if sharing a tab

2010-06-29  senator

	* Booking: forward-porting bit-by-bit; see commit msg for r16827

	* Booking: bit-by-bit forward-port; see commit msg for r16827

	* Booking: thinko: default value for an org_unit_setting has to
	  come after
	  the org_unit_setting_type is defined

2010-06-30  scottmk

	* 1. Degrade gracefully when the database connection dies.
	  
	  2. Validate the user-specified operator in a series expression.
	  
	  M Open-ILS/include/openils/oils_buildq.h
	  M Open-ILS/src/c-apps/oils_qstore.c
	  M Open-ILS/src/c-apps/oils_buildq.c
	  M Open-ILS/src/c-apps/oils_storedq.c
	  M Open-ILS/src/c-apps/oils_execsql.c

2010-06-30  dbs

	* explode_array() is needed by 030.schema.metabib.sql now; create
	  it early so that database schema creation doesn't fail

	* Lenny needs DBD::Pg; the unnecessary Class::DBI::Pg had pulled
	  that in as a dependency

2010-06-30  gmc

	* bug #600432: fix MARC expert search
	  
	  Fix gitch introduced via overzealous tidying that broke MARC
	  expert search; in the expression @array || $scalar, @array
	  is evaluated in scalar context and thus returns the number
	  of elements in it.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-07-01  gmc

	* bug #600021: fix lookup of FIFO holds OU setting
	  
	  Patch from Anoop Atre that fixes enabling FIFO
	  holds via the circ.holds_fifo org unit setting.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-07-01  scottmk

	* 1. Support the peculiar syntax of EXTRACT().
	  
	  2. Repair a regression to make SELECT * work again.
	  
	  M Open-ILS/src/c-apps/oils_storedq.c
	  M Open-ILS/src/c-apps/buildSQL.c

	* Support the following built-in functions with peculiar syntax.
	  They take no parameters and don't even accept empty parentheses:
	  
	  current_date
	  current_time
	  current_timestamp
	  localtime
	  localtimestamp
	  
	  M Open-ILS/src/c-apps/buildSQL.c

2010-07-01  senator

	* Fix missing dojo.require() in a couple of interfaces.
	  
	  This bug doesn't manifest itself in releases, as the
	  openils_dojo.js layer
	  seems to take care of overlooked calls to dojo.require() anyway.

2010-07-01  miker

	* remove as many namespace prefixes as I can from the MODS record
	  output

2010-07-02  erickson

	* repaired bug where parsing intervals with months failed becuase
	  dojo.date.add() wants the full word 'months' whereas postgres
	  stores them abbreviated as 'mons'

2010-07-06  senator

	* Booking: fixed the last db upgrade script. It was trying to
	  insert a row
	  in config.org_unit_setting_type that had already been covered by
	  0109, but
	  which had not been in the seed data until recently, so I think
	  one would have
	  only noticed this if hadn't installed a new schema from scratch
	  in some time.
	  
	  If you already ran 0323 and it worked for you, you don't have to
	  do anything.
	  
	  Also, this now avoids clobbering already-set default_elbow_room
	  values.

	* Selfcheck: Show friendly error messages based on circ event
	  fail_part field
	  
	  Messages lifted from opac.dtd

2010-07-06  erickson

	* added stored proc to return the distinct set of target copies
	  from a users visible circ history

2010-07-06  scottmk

	* Add a configuration entry for the qstore server. This entry will
	  look just
	  like the entry for open-ils.cstore, except:
	  
	  1. The <implementation> is oils_qstore.so instead of
	  oils_cstore.so, obviously.
	  
	  2. There is no need (or use) for the max_query_recursion element.
	  
	  M Open-ILS/examples/opensrf.xml.example

2010-07-06  miker

	* integrate serial.unit by relaxing fkeys against asset.copy and
	  adding hold support

2010-07-06  phasefx

	* augment these payment receipt templates with more info

2010-07-06  miker

	* use SQL function for speed, instead of PLPGSQL

2010-07-06  erickson

	* added ability to tag bib record results from staged multiclass
	  search as previously checked out by the user. the code compares
	  search results to the set of circs in the user's visible
	  circulations history. the ultimate goal is to provide the ability
	  to style rows in search results so the patron can see if he/she
	  already circulated the item (assuming some widget to turn this
	  feature on/off for a search)

2010-07-06  miker

	* remove all the 901 mangling -- handled by the db now

	* add metarecord support to "already circulated" tagging

2010-07-06  senator

	* CC payments: address situations where
	  Business::CreditCard::validate() returns
	  true yet Business::CreditCard::cardtype() returns the string
	  "Unknown"
	  
	  Curse you inconsistent APIs! :-)

2010-07-06  erickson

	* return IDs of newly created payments on success

	* showing the more descriptive cc payment errors in self-check.
	  printing CC payment receipts from self-check. added a
	  commented-out cc type picker for possible future use

2010-07-06  phasefx

	* adjust code for an API change. Assume success if no ils_event

2010-07-06  erickson

	* added opac user setting for default sort order for search results

2010-07-06  scottmk

	* Add new program test_qstore, a command-line utility for testing
	  and exercising most of the code for the qstore server.
	  
	  A Open-ILS/src/c-apps/test_qstore.c
	  M Open-ILS/src/c-apps/Makefile.am

2010-07-07  miker

	* adding status/copy_location filter support to call number browse

2010-07-07  erickson

	* updated call number browse pass-thru to accommodate new copy
	  location and status filters

	* added OPAC support for 1) selecting SSL manually and having it
	  stick and 2) forcing SSL when the user is logged in to protect
	  auth tokens and other private data. The latter option is enabled
	  via new apache env variable

2010-07-07  phasefx

	* define these variables as parameters

2010-07-07  miker

	* Forward port of r16867: add missing event definition required by
	  vandelay authority import

2010-07-07  phasefx

	* Merge branch 'browser'

	* Lost my commit msg the first time around, so...
	  
	  This CGI script might be useful for providing an easy way for
	  EZproxy to authenticate users against an Evergreen instance.
	  
	  For example, if you modify your eg_vhost.conf by adding this:
	  <Directory "/openils/var/cgi-bin/ezproxy">
	  AddHandler cgi-script .pl
	  AllowOverride None
	  Options +ExecCGI
	  allow from all
	  </Directory>
	  
	  and make that directory and copy remoteauth.cgi to it:
	  mkdir /openils/var/cgi-bin/ezproxy/
	  cp remoteauth.cgi /openils/var/cgi-bin/ezproxy/
	  
	  Then you could add a line like this to the users.txt of your
	  EZproxy instance:
	  
	  ::external=https://hostname/cgi-bin/ezproxy/remoteauth.cgi,post=user=^u&passwd=^p

2010-07-08  scottmk

	* Fix a bug in pcrud.
	  
	  When checking a row for permissions, we often read a fresh copy
	  of the
	  row in order to ensure that we have all the foreign keys that we
	  need.
	  However in some cases (mainly when the class is a view), there is
	  no
	  primary key, so we can't re-read the row.
	  
	  Solution: if there is no primary key, don't try to do a fresh
	  read.
	  Use the row image that we already have.
	  
	  For these cases, this solution re-creates the possibility that we
	  may
	  not have all the necessary columns. There's no good way around
	  that
	  problem.
	  
	  M Open-ILS/src/c-apps/oils_sql.c

2010-07-08  phasefx

	* populate some fields in Item Status->Alternate View->Circulation
	  History->Most Recent Circ Group when we're not bothering to
	  retrieve the circ chain

	* hold/transit data in Item Status->Alternate View->Holds/Transit

	* adding a cc_name field to money.credit_card_payment to hold the
	  human name on the credit card

	* column tweaks. If you already ran 0328, see comments at top

2010-07-08  dbs

	* Enable plain up-arrow and down-arrow to jump to next row in MARC
	  editor
	  
	  As TAB/shift-TAB move between each editable element of the MARC
	  record,
	  we already have fine-grained keyboard navigation. However, moving
	  down
	  10 data fields requires around 50 TAB presses or more, depending
	  on how
	  many subfields are in the intervening data fields, or a looonng
	  hold of
	  the tab key; not good for RSI.
	  
	  The up-arrow and down-arrow keys, then, move directly to the next
	  or
	  previous row, placing the focus in the first editable subfield
	  element
	  rather than in the tag name (under the assumption that
	  cataloguers are
	  most likely to want to edit the contents of a given subfield, and
	  not
	  the tag name or indicators).
	  
	  Now, in the worst-case scenario, a cataloguer who wants to edit
	  the tag
	  name of a field 10 rows below their current position will have to
	  make 14 key presses (10 down arrows, 4 shift-TABs). Not too
	  shabby.

2010-07-08  erickson

	* instead of reading the MARC data directly from the socket, set
	  the end-of-line character appropriately and read the data
	  directly from STDIN. The 'wait' time is now only used as a
	  security measure to prevent accidental hogging of worker
	  processes

2010-07-08  scottmk

	* Streamline pcrud a bit.
	  
	  If there is a permacrud entry for the relevant action, but the
	  list of
	  permissions is empty, we grant access.
	  
	  The change: grant access as soon as the permission list can be
	  known
	  to be empty, instead of doing a lot of irrelevant stuff first
	  (including extra database fetches in some cases).
	  
	  M Open-ILS/src/c-apps/oils_sql.c

2010-07-08  senator

	* Acq: If you go from a catalog record to "View/Place orders",
	  there are now
	  easy shortcuts for adding a new lineitem to a selection list or a
	  PO if there
	  aren't already any existing lineitems to work with.

2010-07-08  phasefx

	* record the billing_last and billing_first fields from
	  bill_cc_info.xul into cc_first_name and cc_last_name on
	  money.credit_card_payment, even for out-of-band (externally
	  processed) payments. Also protect the bill_cc_info dialog from
	  patrons with no billing address (such as admin)

2010-07-08  dbs

	* Reclaim cataloguing real estate by hiding unnecessary rows in
	  fixed field grid editor
	  
	  The fixed field grid editor currently shows blank rows for fixed
	  field
	  attributes that don't apply to the currently displayed MARC
	  record type. We
	  can hide these rows and offer more screen real estate for the
	  MARC record
	  proper.

2010-07-08  senator

	* Acq: try looking up jacket image by UPC if ISBN is not available

2010-07-08  phasefx

	* Fixes Mark Claimed Returned. It seems that dojo isn't the only
	  library picky about ISO8601;
	  DateTime::Format::ISO8601->parse_datetime was choking in this
	  case

2010-07-08  dbs

	* Give the "About" button a legitimate accesskey
	  
	  r15562 contained a fix for this to rel_1_6_0, but apparently I
	  never
	  forward-ported that "fix". Unfortunately, this leads to broken
	  interfaces in
	  the i18n build (bug re-found by Robert Souilliere in the 1.6.1.1
	  release).

2010-07-08  erickson

	* add sig handler back in for alarm. log error when read times out
	  from alarm

2010-07-08  miker

	* fix initial subfield detection bug

2010-07-09  dbs

	* SuperCat requests for plain marcxml were returning holdings /
	  links
	  
	  This could cause "great fun" in the MARC editor as a bib record
	  suddenly
	  grew volume and xhtml:link elements; everything would spiral
	  downward
	  from there.

	* vandelay.dtd already includes the arrows in the entity definition
	  for next/previous page

2010-07-09  miker

	* add support for switching between xul and textarea marc editors

2010-07-09  dbs

	* Initial support for wrapping long subfields in the MARC editor
	  
	  Limitations of the current approach are that the line width is
	  arbitrarily set
	  to break at 100 characters, and is only calculated on a
	  per-subfield basis. So
	  if a given field contains 50 subfields, each with 90 characters,
	  this commit
	  isn't going to help you. (But really... in that scenario, you're
	  beyond help
	  anyway!)
	  
	  Also, the double-dagger aligns itself at the top of the box
	  rather than the
	  middle once the box goes into multiline mode, which is annoying;
	  but long 505
	  fields that scroll ten screens to the right are more annoying, so
	  I'll commit
	  this for now rather than waste more time trying to CSS it into
	  shape.

	* Restore whitespace consistency (spaces not tabs)

	* New feature: maintain control numbers (001, 003, 035) for MARC
	  records
	  
	  If a site wishes to maintain their control numbers and control
	  number
	  identifiers in authority, bibliographic, and MFHD MARC records
	  according
	  to the MARC21 specification, they will now be able to:
	  
	  1. Enable the global flag 'cat.maintain_control_numbers' to turn
	  on
	  control number maintenance. This is disabled by default, so no
	  changes
	  will be made by the system until the flag is enabled.
	  
	  2. (Optionally) Set the cat.marc_control_number_identifier OU
	  setting
	  to override the control number identifier for records owned by
	  that OU;
	  if this is not set, then the control number identifier defaults
	  to the
	  OU shortname.
	  
	  3. Set the owner field for the records that are to be controlled;
	  otherwise
	  they will fall back to the global default which is currently
	  hardcoded as
	  'EVRGRN'.

	* dojo == elegant; refactor cursor up/down and hide fixed fields in
	  MARC editor

2010-07-11  miker

	* break facets out to a separate table for speed

	* thinko in upgrade script

2010-07-12  miker

	* facet query correction

2010-07-12  dbs

	* NFC() needs Unicode::Normalize - strange that this didn't come up
	  in previous testing

	* Several fixes for authority-controlled field and control number
	  syncing
	  
	  The fix for maintain_control_numbers() was committed earlier, but
	  wasn't
	  part of a new upgrade script; this will ensure that everyone
	  following
	  trunk picks up the correction.

2010-07-12  gmc

	* cache OPAC-visibility of copies and bibs
	  
	  Create a new "materialized view" table,
	  asset.opac_visible_copies,
	  for use during the copy visibility check during OPAC searches.
	  This
	  is used by search.query_parser_fts(), replacing a check of a
	  five-table
	  join for each bib in the search results that proved to be far
	  too slow on some large databases.
	  
	  This table is maintained by triggers on inserts and updates to
	  the
	  following tables:
	  
	  actor.org_unit
	  biblio.record_entry
	  config.copy_status
	  asset.call_number
	  asset.copy
	  asset.copy_location
	  serial.unit
	  
	  During a migration or large global change operation, it is
	  recommended
	  that those triggers be disabled. To (re)populate the materialized
	  view, do
	  
	  SELECT asset.refresh_opac_visible_copies_mat_view();
	  
	  Thanks to Mike Ryladner for his help with this.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* protect against deletion of serial.unit rows
	  
	  Rules are not inherited by child tables, so must
	  add one explicitly.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-07-12  phasefx

	* printing the contents of iframes is sometimes problematic,
	  especially with complex DHTML, etc. This change allows content to
	  define a printable_output() function for simple text to print
	  instead of the rendered content itself

	* printable_output() for the patron editor, given that printing the
	  Dojo here is problematic

2010-07-12  senator

	* Make a translate button available in the name column of copy
	  locations editor

2010-07-12  dbs

	* Prevent MARC batch import from blindly trusting the user by
	  checking LDR/06
	  
	  With this commit, Vandelay will now check the leader of the
	  incoming MARC
	  record to ensure that its MARC type matches the indicated import
	  record
	  type. This is useful, for example, if you have a mixed set of bib
	  & holdings
	  records that you want to import; you don't want to import the
	  holdings records
	  as bib records.
	  
	  This is a fairly strict implementation; we could relax this by
	  turning the
	  check on its head and allowing the import as the user-indicated
	  type as long
	  as the LDR/06 doesn't explicitly match another record type.

	* Whitespace consistency for Vandelay

2010-07-13  dbs

	* Add 100$e (relator) and 711$c (Location of meeting) to controlled
	  field map
	  
	  We'll probably flesh this out further as we get more serious
	  about authority
	  control, but these ones stood out in our initial testing.

2010-07-13  scottmk

	* Add limit_count and offset_count columns to query.stored_query
	  table.
	  
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  M Open-ILS/src/sql/Pg/008.schema.query.sql
	  A Open-ILS/src/sql/Pg/upgrade/0334.schema.query-limit-offset.sql
	  M Open-ILS/examples/fm_IDL.xml

2010-07-13  dbs

	* Stub script for adding authority control to an existing set of
	  bibs
	  
	  The goal of this script is to iterate over every bib record
	  listed at
	  the command line (or --all) and check every controlled bib field
	  for
	  matching subfield combinations in authority records. This is
	  going to
	  be slow, friends, but for this iteration we're looking at paying
	  a
	  one-time cost; after that, controlled fields will automatically
	  be
	  maintained by triggers on the authority.record_entry tables.
	  
	  The bib field-to-auth field mapping needs to be fleshed out
	  (should
	  be comparable to the mapping in marcedit.js) and floating
	  subdivisions
	  still need to be controlled. Probably in a separate pass over the
	  bibs,
	  given the current "design".
	  
	  We extend open-ils.s*.authority.validate.tag to offer an
	  id_list() variant
	  so that we can get the corresponding authority record ID back
	  from the
	  call, instead of just a count.

	* Make maintain_901() more robust in the presence of namespaces
	  
	  Some records manage to get XML namespace declarations into each
	  element,
	  like <datafield xmlns:marc="http://www.loc.gov/MARC21/slim"
	  
	  This broke the old maintain_901(), so we'll make the regex more
	  robust

2010-07-13  scottmk

	* Qstore: support LIMIT and OFFSET clauses.
	  
	  Also: add some links to the IDL, that should have been there
	  in the first place.
	  
	  M Open-ILS/include/openils/oils_buildq.h
	  M Open-ILS/src/c-apps/oils_storedq.c
	  M Open-ILS/src/c-apps/buildSQL.c
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  M Open-ILS/src/sql/Pg/008.schema.query.sql
	  A
	  Open-ILS/src/sql/Pg/upgrade/0336.schema.query-limit-offset-fkey.sql
	  M Open-ILS/examples/fm_IDL.xml

2010-07-13  dbs

	* Relax bib type parsing a little and allow spaces (like the
	  comments promised)
	  
	  Also fix a few drive-by typos

2010-07-13  miker

	* remove even more namespace prefixes ... take THAT, IE!

2010-07-13  dbs

	* Be more relaxed about what we receive in Vandelay (a bad LDR/09
	  need not lead to complete misery)
	  
	  If MARC::File::XML->as_xml_record() receives a record with
	  anything other
	  than 'a' in LDR/09 position, it will try to run a MARC8-to-UTF8
	  conversion
	  on the record - even though the source file itself was XML and
	  clearly
	  couldn't have been MARC8.
	  
	  This code corrects the leader on the fly so that MARC::File::XML
	  won't
	  try to convert it and throw a "wide character" warning, but the
	  fix
	  means that something was wrong with the leader to begin with, so
	  we also
	  write a warning to the log about the situation.

2010-07-14  dbs

	* Improve auto-authority-control processing script:
	  * Prevent duplicate $0 subfields from being generated by multiple
	  runs
	  * Provide more bib field/subfield -> auth field/subfield mappings
	  * Protect against missing bib->auth maps
	  * Correct --all option to actually retrieve all undeleted records

	* validate.tag.id_list: Return an empty list instead of 0 in the
	  case of no matching records
	  
	  This makes it a little easier to handle cases where there was no
	  match,
	  rather than having to check to see if we have a scalar or a
	  reference
	  to a list.

	* In theory, this would be a step towards MFHD records in the
	  editor looking saner.
	  
	  In practice, the BKS fixed fields are hidden. Sadly, the leader
	  values
	  for the MFHD record are not displayed either.

	* Set the 004 of the new MFHD record to the ID of the targeted bib
	  record

2010-07-14  scottmk

	* When returning a list of bind variables: If a default_ or
	  actual_value
	  is undefined for a given variable, leave it out of the JSON
	  object
	  altogether, rather than create an entry with a JSON null for it.
	  
	  That way the client can distinguish between an undefined value
	  and
	  a value defined as null.
	  
	  M Open-ILS/src/c-apps/buildSQL.c

2010-07-14  dbs

	* CSS makes things visible, or not. Display the nascent MFHD
	  fixed-field editor.

	* Authority records get some fixed-field love in the MARC Editor

2010-07-15  dbs

	* Teach assets.merge_record_assets() to also merge authority->bib
	  links

	* On second thought, delete authority links pointing to stale bib
	  records
	  
	  This avoids the overhead of updating controlled fields in deleted
	  bib records.

	* asset.merge_record_assets() needs auth_link declaration (was in
	  upgrade script)

2010-07-15  gmc

	* bug 605884: make MARC expert search of control fields work
	  
	  Allows users to search on the 001 and 003 fields, for example.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* bug 605921: fix bib search hang on queries like "title ;
	  subtitle"
	  
	  More generally, the fix avoids a to_tsquery exception in cases
	  where a search term is normalized away to the empty string.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-07-15  dbs

	* Delete links to deleted bib records as part of
	  biblio.indexing_ingest_or_delete()
	  
	  Moves authority.bib_linking cleanup from the special case
	  of merging bib record assets to the general case of deleting bib
	  records

2010-07-15  miker

	* companion to "browse", which drops you into the middle of a list
	  centered on your input, "startwith" browses only from your input
	  on

2010-07-15  dbs

	* Protect authority records from real deletion and add a "merge
	  authorities" function

2010-07-15  erickson

	* return # of imported and failed records to the caller

2010-07-15  miker

	* ARG! Missed a semicolon. Perl, be like JS and make them optional.
	  On second thought do not be like JS in any way.

2010-07-15  senator

	* make openils.widget.TranslatorPopup a little more
	  environment-agnostic

2010-07-15  phasefx

	* add copy circ lib to alternative item details view

	* allow open-ils.circ.hold.update.batch to apply nulls to fields

	* wrong variable; could refresh the wrong rows

	* more configuration options for date/timepicker dialog, and use
	  that dialog with staff editing of hold thaw date and expire time

	* Have open-ils.circ.circulation.due_date.update return the circ
	  instead of the circ id so that modified rows in Items Out refresh
	  correctly, and have Items Out -> Edit Due Date, -> Renew with
	  Specific Date, and -> Mark Claimed Returned use the
	  date/timepicker dialog

2010-07-15  senator

	* This should have been part of r16946. Now the TranslatorPopup
	  works in the
	  Copy Location Editor

2010-07-16  miker

	* use a left join instead of -not-exists for anti-join -- much
	  faster for large nullable-side sets in this case

2010-07-16  gmc

	* whitespace consistency improvements
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* add --timeout switch to marc_export
	  
	  Provides way to export bibs with holdings
	  that have a large number of copies attached. Default
	  timeout remains 1 second when exporting bibs; increased
	  to 300 seconds when exporting holdings based on
	  empirical tests on a big database.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-07-16  erickson

	* rearrange while loop to prevent error: Can't 'last' outside a
	  loop block

2010-07-16  dbs

	* Add the new owner column to the are object in the IDL

	* serial.record_entry already had an owner column spelled
	  "owning_lib"
	  
	  Adjust the table and affected function accordingly

2010-07-16  gmc

	* make --timeout actually work if setting a timeout > 60 seconds
	  
	  Also remove ersatz XML declarations so that XML output
	  is well-formed.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-07-16  phasefx

	* get rid of the chrome instantiated sound object so it's every
	  interface for itself, and have remote xul load
	  server/skin/custom.js instead of chrome

2010-07-16  erickson

	* return NULL terminator to indicate successful read; fixed typo

2010-07-16  dbs

	* It is important to update the upgrade_log to prevent collisions
	  and such.
	  
	  Updating config.upgrade_log to 0340.

2010-07-16  gmc

	* add seed for COPY_NEEDED_FOR_HOLD.override permission
	  
	  Being careful during the upgrade since a fair number of
	  EG database in the wild had this one added manually.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-07-17  dbs

	* Fix schema creation breakage. Damn you dangling commas.

	* Switch to ingesting authority records automatically via database
	  triggers
	  
	  Taken largely from the existing approach for ingesting biblio
	  records,
	  there is some duplication here that we could genericize. But for
	  now,
	  we'll go with the working-but-separate approach to avoid
	  introducing
	  badness into the relatively stable biblio ingest pipeline.
	  
	  Also, move some of the existing authority-related functions out
	  of
	  the metabib schema file and into 999.functions.global.sql.
	  
	  Finally, the direct_ingest.pl script is no longer necessary for
	  ingest of authority records, either, so die in that case as well.

	* Teach marc2sre.pl MFHD record ingest script to read a mapping of
	  library names to OU IDs
	  
	  The past approach required workarounds that weren't fun for a
	  library
	  without in-house scripting expertise; this provides a
	  straightforward
	  mapping approach with docs and a working sample. Which should be
	  helpful
	  for all of the libraries that will go with the MFHD serials
	  approach in
	  the future. Heh.

2010-07-18  miker

	* remove ingest service call from authority import thanks to in-db
	  ingest of auth by dbs; send final message with total and count
	  processed; send record counts at most every 3%; rearrange queue
	  cleanup code to aviod needless rollback and cover all queues, not
	  just the first one we test

	* put the null return back, in case that is important on the client
	  side

2010-07-19  erickson

	* repaired sql syntax for upgrade log commit

	* when calculating estimed hold wait time, don't ignore copies that
	  have no circ modifier

	* updated default estimated hold wait display to handle seconds
	  instead of days returned by the ML API call. TODO, consider
	  if/how to handle sub-day intervals

2010-07-19  miker

	* use LEFT JOIN to allow a single query to count copies per circ
	  mod

	* use abs() to get page number in either direction

2010-07-20  erickson

	* md5 module is deprecated; move to hashlib

2010-07-20  miker

	* backporting r16982: use the correct table and field, caught by
	  Doug Kyle and reported via IRC

	* Patch from John Craig providing a saner timestamp cleansing setup
	  for backdated circs

2010-07-20  erickson

	* added support for selecting individual copy statuses that will
	  prevent checkout at self-check even when the generic
	  copy_not_available event has been overridden to allow for
	  non-standard copy circs from selfcheck. TODO: ui for managing the
	  list

	* flush the xmpp socket before attempting to process new marc
	  stream requests

	* login just before starting work and log out after each request is
	  handled. this is removes the need to check for bad authtokens and
	  re-login mid-process

2010-07-20  gmc

	* set truncation to 1 for all biblios.net Z39.50 attributes
	  
	  Thanks to Anoop Atre for spotting the problem.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-07-21  scottmk

	* Two new tables in action schema: fieldset and fieldset_col_val.
	  
	  M Open-ILS/src/sql/Pg/090.schema.action.sql
	  M Open-ILS/src/sql/Pg/999.functions.global.sql
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  A Open-ILS/src/sql/Pg/upgrade/0346.schema.action-fieldset.sql
	  M Open-ILS/examples/fm_IDL.xml

2010-07-21  miker

	* index which /greatly/ speeds collection of pending active events

2010-07-21  gmc

	* improve documentation of macros available to receipt templates
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-07-21  miker

	* add copy_circ_lib and copy_owning_lib to circ matrix matchpoints,
	  closer one (if both are set) is more important to the ordering

	* add parameter support to acn, acp and auri unapi axes

	* protect acn, acp and auri from our $lib faking

2010-07-21  erickson

	* pushed view-in-catalog link up to the main lineitem display.
	  moved pl/po/worksheet/catalog links to a row of their own for a
	  more consistent location (visually).
	  replaced 'PO:' 'PL:' with small icons to easier catch the eye;
	  added 'worksheet' tag to the worksheet icon for clarity
	  TODO: plug in bib discovery and linking mechanism for freerange
	  lineitems

	* add collection code as non-i18n version of shelving location

	* added an 'Add Brief Record' button to the PO interface, which is
	  visible when there are no lineitems on an existing PO.

2010-07-22  miker

	* retain the indicators on located uri 856 merge during asset
	  merge; update script and backporting to come

	* upgrade script and version bump for r17007

2010-07-22  senator

	* Acq: always show "add to new selection list" / "create new PO"
	  buttons in
	  related lineitems interface

	* Acq: attempt to fix issue where adding copies in an LI table's
	  copies
	  interface, then returning to the table view, then going back to
	  copies
	  doesn't show the most recent saved changes.

2010-07-22  gmc

	* bug #608937: make barcode search from main patron search form
	  case-insensitive
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-07-22  erickson

	* fixed bug in related lineitems page where it was attempting to
	  fetch the bib record based on the lineitem id

	* Added option to link a (freerange) lineitem to a catalog
	  record via simple pop-up search page.

2010-07-22  senator

	* Acq: revert something I didn't mean in r17013

2010-07-23  erickson

	* log the IP address of the connecting client

2010-07-23  phasefx

	* support printing of stat cats and surveys from patron editor

	* logic error preventing deletion of addresses in patron editor

2010-07-23  miker

	* Forward-port r17024: include null fields, via .toStoreItem(),
	  when creating a permission map store item

2010-07-23  scottmk

	* Add procedure action.apply_fieldset.
	  
	  M Open-ILS/src/sql/Pg/090.schema.action.sql
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  A
	  Open-ILS/src/sql/Pg/upgrade/0350.schema.action-apply-fieldset.sql

2010-07-26  dbs

	* Update README and prereq installer for Evergreen trunk:
	  
	  * Favour PostgreSQL 8.4
	  * Add ISN contrib
	  * Update Dojo to 1.3.3
	  * Add Ubuntu Lucid as a target
	  * Remove Gentoo support (until we have a volunteer)
	  * Remove Ubuntu Karmic support (can add back in at release time
	  if warranted)

	* Mention oils_web.xml in the README

2010-07-26  gmc

	* improve description of VIEW_PERMIT_CHECKOUT and VIEW_HOLD_PERMIT
	  permissions
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-07-26  scottmk

	* New table: actor.usr_saved_search
	  
	  M Open-ILS/src/sql/Pg/005.schema.actors.sql
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  A Open-ILS/src/sql/Pg/upgrade/0351.schema.usr_saved_search.sql
	  M Open-ILS/examples/fm_IDL.xml

2010-07-26  phasefx

	* tweak hold "status" for canceled holds. And one whitespace fix

2010-07-27  dbs

	* We require Buttons on this form. Continuing the good work senator
	  started.

2010-07-27  scottmk

	* Merge Dan Wells' changes to the serial schema from the
	  seials-integration branch.
	  
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  A Open-ILS/src/sql/Pg/upgrade/0352.schema.serials-integration.sql
	  M Open-ILS/src/sql/Pg/210.schema.serials.sql
	  M Open-ILS/examples/fm_IDL.xml

2010-07-27  dbs

	* Reverse dojo.mixin() order in AutoFieldWidget to favour passed-in
	  constraints; otherwise we stomp them

	* Prevent years in "New Fund" dialog from being displayed with a
	  comma separator
	  
	  Also limit to a seemingly reasonable range of 2000 - 2200 for the
	  year

2010-07-27  phasefx

	* put these command elements into the overlay, closer to where
	  they're being used

	* entry point and function stub for Mark Item as Missing Pieces
	  entry point for scanning item as missing pieces and stub dialog

	* flesh out scan item as missing pieces dialog

	* since we're re-circulating to previous patrons sometimes as a
	  poor man's check-in undo, give us the power to turn off these
	  fee-generating features. berick++

	* middle layer support and client-side utility function. missing
	  messagecat for missing pieces dialog

2010-07-28  miker

	* documentation for facet value retrieve method

2010-07-28  senator

	* Syntax error in serials schema file.

2010-07-29  miker

	* Patch from Jason Stephenson:
	  
	  The patch adds (BinaryEncoding => 'UTF-8') wherever
	  MARC::File::XML is used in the database
	  PgPerl functions where it is not already being done. This stops
	  the functions like
	  maintain_control_number() from trying to convert records from
	  MARC8 to UTF-8 and blowing up,
	  when the records are already UTF-8.

2010-07-29  dbs

	* Build a threadsafe libjs so that JavaScript::SpiderMonkey can be
	  threadsafe
	  
	  Thomas Berezansky <tsbere@mvlc.org> reported problems building
	  JavaScript::SpiderMonkey on 64-bit Ubuntu and offered some
	  patches to build it without -JS_THREADSAFE. The real problem,
	  however,
	  was that libjs was not itself being built with the JS_THREADSAFE
	  option.
	  
	  Enabling the JS_THREADSAFE option pulls in the requirement of
	  the nspr4-dev package on Ubuntu and Debian.
	  
	  Tested on 64-bit Ubuntu Lucid and 64-bit Debian Lenny. 64-bit
	  Fedora 13
	  worked previously because it uses the packaged version of libjs -
	  which
	  was already built with the JS_THREADSAFE option.

	* Add Developer Instructions section, like the OpenSRF README, per
	  tsbere's suggestion

2010-07-29  atz

	* Need to die if we fail to find a picklist, symmetric to the top
	  of the conditional.
	  
	  Otherwise, we crash out on $conn->respond($picklist->id);

2010-07-29  senator

	* Acq: better labels for adding catalog record based item to PL or
	  PO

2010-07-29  miker

	* This patch replaces the result page sidebar new-search trees
	  (implemented before "faceting" became a thing, and designed for
	  new-search, not drill-down) with and implementation of what has
	  become
	  the generally accepted "way to do faceting". This is implemented
	  as a
	  Dojo Dijit, and the markup and code footprints within the OPAC
	  proper
	  are small, just a couple <div>s and a little bit of glue code to
	  help
	  the facet rendering engine find the data it needs. The set and
	  order
	  of facet classes to display in a given facet bar (title, author,
	  subject, etc) is configurable in the markup, as are the number of
	  values displayed for each facet when collapsed (before the
	  [More...]
	  button is pushed).
	  
	  Also included is a Searcher Dijit which implements an embeddable
	  advanced search interface. This is mainly useful for constructing
	  boolean-chained searches (we support AND and OR now, though
	  they're
	  spelled && and || in the query string), and has the beginnings of
	  support for filters and modifiers.

2010-07-29  erickson

	* repaired copy/paste thinko in the vandelay
	  auto-overlay-with-merge-profile logic

2010-07-30  atz

	* Admin Menu link for viewing EDI Messages
	  
	  Modifies and uses the existing page for viewing one PO's
	  messages.
	  
	  TODO: Other kinds of filtering/searching.
	  TODO: Display PO number where name unavailable.

2010-08-02  phasefx

	* toward printing slip and letter for missing pieces

2010-08-02  miker

	* update schema list for Slony replication

	* create correct primary key constraints for some view-based /
	  inheritted tables

2010-08-02  atz

	* 0356 fixup - the updates otherwise failed for syntax or dependent
	  constraints

2010-08-02  miker

	* escape more in the cn label for browse xml

2010-08-03  dbs

	* Correct DDL for creating a fresh schema - match upgrade 0356

	* Slight overhaul of ISBN indexing focused on the
	  translate_isbn1013 function
	  
	  * Switch to a PLPERLU function built on Business::ISBN for more
	  robust
	  indexing of records with problematic ISBNs; thanks to Jason
	  Stephenson
	  <jstephenson@mvlc.org> for the initial implementation
	  
	  * Remove the first_word, naco_normalize, and split_date_range
	  normalizers
	  from the indexing chain for ISBNs, as these unnecessarily munge
	  the
	  ISBNs. We can trust Business::ISBN to determine what is a real
	  ISBN,
	  hyphens and all.
	  
	  * Index all ISBNs in a given record and generate the
	  corresponding
	  ISBN10/ISBN13 variations. Also, fix the checksum if given an ISBN
	  with
	  a bad checksum, but be sure to index the original bad-checksum
	  ISBN as
	  well.
	  
	  * Add a set of 10 MARC records with bad ISBNs (thanks to Jason
	  Stephenson
	  again for these) for testing purposes to Open-ILS/tests/datasets
	  
	  * Add the Business::ISBN Perl module as a prerequisite to the
	  installer
	  
	  * Remove contrib/isn from the PostgreSQL install instructions

2010-08-03  erickson

	* added open-ils.circ.copy.due_date.retrieve API call to return the
	  due date for a given copy if it's circulating. method does not
	  require auth, so only the due date is exposed, not the circ or
	  user, etc.

2010-08-03  atz

	* 0358 more values for acq.cancel_reason
	  
	  Note: we won't be using all of them, the set is just there for
	  completeness.

2010-08-03  scottmk

	* New org unit setting type: serial.prev_issuance_copy_location
	  
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  A
	  Open-ILS/src/sql/Pg/upgrade/0359.data.setting-prev-iss-copy-loc.sql
	  M Open-ILS/src/sql/Pg/950.data.seed-values.sql

2010-08-04  atz

	* Simple 1-line feature for EDI translator
	  
	  Allows us to know what the effective version of openils-mapper
	  is.

2010-08-04  phasefx

	* previous changes to better support the embedded browser Print
	  button broke printing elsewhere

	* print missing pieces slip

2010-08-04  erickson

	* updated patron fee amount call to use cstore for speed

2010-08-04  dbs

	* Close LP bug 613551 - JS error in Internet Explorer from
	  google.loader.callbacks.books
	  
	  Bizarre, this line does not appear to be necessary at all.
	  Vamoose it.

	* Firefox is picky about having attribute values quoted, let's
	  oblige it
	  
	  Still some generated dojo.query() expressions throwing warnings
	  but we can tackle those... later

2010-08-04  miker

	* segregate the old version of facet-modified JS to be
	  craftsman-specific

	* a glue method used to apply a template to a set of records

2010-08-04  phasefx

	* tweak to item attribute editor to support hiding of fields with
	  cat_custom.css

2010-08-04  erickson

	* require latest last_xact_id for payments
	  
	  To prevent accidental multiple payments on the transaction or
	  payments
	  against stale information, require the latest user last_xact_id
	  to be
	  passed into the payment API call. Update staff client (thanks
	  jason)
	  and self-check payment interfaces to match.

2010-08-04  miker

	* allow ACQ-driven ordering and claiming of serial items

2010-08-04  phasefx

	* required column for item stat cats

2010-08-04  senator

	* Provide a handy method for dojo-based interfaces to correctly
	  show timestamps
	  from fieldmapper object fields.

2010-08-04  erickson

	* no need to search for patron summary, instead retrieve directly
	  by usr id

2010-08-04  phasefx

	* add Required to copy stat cat editor, add User Summary to patron
	  stat cat editor for initial stat cat creation, and fix a bug
	  where editing an existing copy stat cat would attempt to set
	  usr_summary. Modified behavior a bit so that an update is
	  attempted whenever the user presses update, and not just if data
	  is changed (this was me punting instead of trying to modify the
	  test for both copy and patron stat cats)

2010-08-05  gmc

	* bug 613703: normalize backdate on item checkin better
	  
	  Fixes bug that appears to cause all checkins uploaded
	  via offline circ to fail with an "invalid date format"
	  error.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-08-05  dbs

	* Fix typo in --boostrap option, keeping it as an alias for
	  possible automated scripts

2010-08-05  phasefx

	* updating some auditor tables that were causing problems in cstore
	  with missing columns, but not sure how to reset the _lifecycle
	  views

	* the caption id was important after all, for keyboard navigation

	* fix color highlighting for xulrunner 1.9.2

	* disable Create/Modify button in item attribute editor if Required
	  fields are Unset

2010-08-05  erickson

	* removed some deprecated code

2010-08-05  dbs

	* Remove OpenILS::Utils::FlatXML - code that has been unused since
	  before 1.0

	* The old default skin is the new default skin
	  
	  We need people willing to maintain the craftsman skin, as it is
	  falling
	  behind "default" in functionality and goes for long periods in a
	  broken state.
	  
	  This change gives Evergreen the most functional and most likely
	  to work skin
	  by default, which is important for making positive first
	  impressions on
	  possible adopters of the project.

2010-08-05  erickson

	* return the matched circ rule during inspect

	* Log the found matchpiont with indb circ policy test

2010-08-05  scottmk

	* Correcting some mistakes. Sequence names must be qualified by
	  schema.
	  
	  M Open-ILS/examples/fm_IDL.xml

2010-08-05  miker

	* speed up open circ counting and listing

2010-08-05  erickson

	* prev commit left some un-esacped <'s. fixed

	* repaired primary key column; removed trailing semi's from SQL

2010-08-05  phasefx

	* fix open-ils.circ.prev_renewal_chain.retrieve_by_circ.summary to
	  return the correct user for the previous circ chain, and some
	  debugging tweaks to Item Status Alternate View and avoid a widget
	  collision with hold patrons

2010-08-05  erickson

	* updated IDL parser to 1) load oils_object:required attr at field
	  level
	  instead of class level and 2) added the oils_persist:i18n attr as
	  another field-level boolean

	* honoring IDL 'required' attr for autofieldwidget for styling

	* added oils_obj:required attrs for circ_matrix_matchpoint

2010-08-05  phasefx

	* Fixed form validation with surveys (the filteringSelect dijits
	  were treating themselves as invalid if not set)
	  Some I18N for form validation
	  Removed some lingering (and annoying) scrollOnFocus behavior with
	  the non-autoField widgets

2010-08-06  gmc

	* bug 614132: fix glitch when used cached permission group widget
	  
	  Fixes bug where the initial permission group value in a circ or
	  hold matrix entry was not displayed when editing an
	  existing matchpoint.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* bug 614150: bail out on ACTOR_USER_NOT_FOUND
	  
	  This fixes a bug where uploading an offline checkout
	  that refers to a missing patron returns an INTERNAL_SERVER_ERROR
	  instead of ACTOR_USER_NOT_FOUND. More generally, this avoids
	  an exception in case case where a circ operation is made
	  without checking the existence of the patron record beforehand.
	  
	  mk_env could use a better name, too.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* added CentOS/RHEL packages for Business::ISBN and friend
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-08-06  scottmk

	* Refine the way we detect loss of the database connection.
	  
	  This is a terrible, horrible, no good, very bad kludge.
	  
	  We do an innocuous SELECT 1. If this query succeeds, then we know
	  that the
	  connection is still good. If it fails, well...
	  
	  Sometimes the SELECT 1 query fails, not because the database
	  connection is dead,
	  but because (due to a previous error) the database is ignoring
	  all commands,
	  even innocuous SELECTs, until the current transaction is rolled
	  back. The only
	  known way to detect this condition via the dbi library is by
	  looking at the error
	  message returned by dbi_conn_error(). This approach will break if
	  the language
	  or wording of the message ever changes.
	  
	  Note: the dbi_conn_ping function purports to determine whether
	  the database
	  connection is live. At this writing, it follows the same approach
	  as described
	  above: try a SELECT 1 and see if it works. Consequently it
	  presumably suffers
	  from the same shortcoming: it may erroneously report a dead
	  connection when the
	  database is in fact just ignoring commands due to a previous
	  error. In addition,
	  if it determines (rightly or wrongly) that the connection is
	  dead, it silently
	  tries to reconnect; if the reconnect is succesful, the function
	  reports that the
	  connection is still alive, as if nothing had happened. If you
	  were in the middle
	  of a transaction at the time, you wouldn't know that it got
	  rolled back.
	  
	  M Open-ILS/src/c-apps/oils_sql.c

2010-08-06  miker

	* Index the internal bib id and tcn value to make searching simpler

2010-08-06  erickson

	* repaired circ-mod retrieval call to use retrieve instead of
	  search

2010-08-06  phasefx

	* menu.js and patron/display.js were passing xulG functions to
	  browser.js differently. This makes browser.js a little smarter
	  (so that it doesn't trampled xulG-destined members sent via
	  passthru_content_params) and sidesteps some security blockers
	  with inspecting xulG. xulG is a namespace/object for shoving
	  foreign data and/or functions into a given window

2010-08-06  gmc

	* bug 532217: work around caching issue resulting doubled title
	  display
	  
	  Quick hack shamelessly borrowed from Dan Scott to fix problem
	  of title being displayed twice on bib details page when back
	  button is used in OPAC or staff client.
	  
	  This is a temporary fix in lieu of rewriting the bib details
	  display to use BibTemplate exclusively.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-08-06  erickson

	* add some tests for copy existence in checkin routines

2010-08-07  dbs

	* Functionality-affecting typo: subjet -> subject

	* Build 210.serial before 200.acq, because 200.acq references
	  serials
	  
	  Confusing due to the order implied by the filename numbers, but
	  priority
	  has to be on getting trunk to build cleanly again; we can sort
	  out a
	  better way later.

	* Basic call-number sorting by classification scheme
	  
	  Until now, call numbers like 'K 22 .U748 v.18' and 'K 215 .E53
	  W37 1997' would
	  sort incorrectly in Evergreen, making call number browsing
	  painful.
	  
	  The following patch adds the following to Evergreen to support
	  better call
	  number sorting:
	  
	  * asset.call_number gains two new columns:
	  - label_class - identifies the classification scheme for the
	  given callnumber
	  - label_sortkey - holds the normalized callnumber suitable for
	  sorting
	  
	  * a new table, asset.call_number_class, which holds the names of
	  each
	  classification scheme and the name of the assorted normalization
	  function
	  
	  * implementations of three normalization functions:
	  * a generic normalizer
	  * a Dewey Decimal Classification normalizer (courtesy the Koha
	  project)
	  * an LC classification normalizer (courtesy Bill Dueber's
	  Library::CallNumber::LC)
	  
	  * a routine in Makefile.install to checkout and install
	  Library::CallNumber::LC
	  
	  * call number sorting routines were modified to use label_sortkey
	  instead of
	  label, where I could find them
	  
	  * corresponding changes to fm_IDL.xml for the new columns + table
	  
	  A suggested means for applying this to an existing library would
	  be to issue
	  update statements against asset.call_number setting label_class
	  to the value
	  in asset.call_number_class that corresponds to owning_lib's
	  scheme, for example:
	  
	  UPDATE asset.call_number SET label_class = 3 WHERE owning_lib IN
	  (4,5);
	  
	  We need to teach the staff client holdings maintenance interfaces
	  how to set
	  the classification scheme for a given call number, and we should
	  also create
	  an org_unit setting that can set the preferred default
	  classification scheme
	  that the staff client should inherit. Or maybe we could just make
	  that a
	  sticky value and have a BEFORE trigger check the incoming value
	  of label_class
	  and only set it to the org_unit default value if it is NULL (to
	  support bulk
	  loads).

2010-08-09  dbs

	* Patch from Ben Ostrowsky <ben@esilibrary.com> to specify "staff
	  account" in proxied pages
	  
	  This change will make it a bit more clear that we're not looking
	  for a
	  patron barcode/PIN in the Selfcheck Login screen (and make the
	  wording
	  consistent across similar login pages).

	* Get the entries into asset.call_number_class before altering
	  asset.call_number

	* Avoid the NOT NULL problem on the auditor table by not creating
	  the constraint in the first place
	  
	  The auditor schemas will be different for a from-scratch DB vs an
	  upgraded database,
	  but just like the would-be iPhone purchaser says, "I don't care."

2010-08-09  erickson

	* combine circ and user fetch into 1 cstore call for SIP items.
	  minor cleanup

2010-08-09  dbs

	* And let's create those new auditor columns first, before any
	  changes ripple through the base table

	* And... keep the index creation on asset.call_number in the right
	  place
	  
	  There's tears in my coffee. These are not tears of joy.

2010-08-09  scottmk

	* Add middle layer functions for maintaining
	  actor.usr_saved_search.
	  
	  M Open-ILS/src/perlmods/OpenILS/Application/Actor.pm

2010-08-09  dbs

	* Teach the staff client volume copy creator to respect OU call
	  number preferences
	  
	  To teach the "Add volumes" dialog in the staff client how to show
	  the correct
	  set of call numbers based on the workstation OU's default
	  classification
	  scheme, this commit:
	  
	  * Adds a column "field" to the asset.call_number_class table that
	  specifies
	  the list of tag/subfield combinations to search for a candidate
	  call number
	  for a given classification scheme
	  * Adds a new OU setting, 'cat.default_classification_scheme',
	  that points
	  to the asset.call_number_class ID
	  * Extends the open-ils.cat.biblio.record.marc_cn.retrieve method
	  to support
	  a second argument, identifying the classification scheme for the
	  call
	  number extraction
	  * Fixes the IDL for asset.call_number_class to include the ID as
	  an explicit
	  field
	  * Makes the "Add volumes" dialog look up the
	  'cat.default_classification_scheme'
	  setting for the workstation OU and apply that to the call to the
	  open-ils.cat.biblio.record.marc_cn.retrieve method
	  
	  TODO:
	  * Provide a means of switching the classification scheme for the
	  current volume,
	  repopulating the call number selector widget
	  * Save the chosen scheme as part of the acn object

	* SQL 101: Remember to name all of the columns before you insert
	  values into said columns

2010-08-09  miker

	* In order to speed up the API call where we ask for the number of
	  visible (or total, in the staff client), available and "unshadow"
	  (aka total) copies, as well as record transcendance visiblity, we
	  create here 10 stored procedures. Eight of them implement the
	  record/metarecord, staff/opac, OU/lasso varients, and two more
	  are wrappers simplifying the calling API.

2010-08-09  dbs

	* Copy/paste-o; asset.call_number ne asset.call_number_class

	* Create the label_class object if null was returned from the
	  method call

2010-08-09  gmc

	* removed executable bit from files that don't need it set
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-08-10  erickson

	* repaired typo/pasto in copy vis upgrade script

2010-08-10  miker

	* aaaaand, another typo of the r17147 ilk

2010-08-10  erickson

	* similar to findbib, replace dojox.data.dom.textContent (which
	  fails for unknown reasons) with node.textContent for bibtemplate
	  rendering in related lineitems page

2010-08-10  phasefx

	* easier to read and corrected regexp for munging iso8601 dates so
	  that they're usable by dojo

	* replace this broken regexp with cleanse_ISO8601

2010-08-10  miker

	* Two things: 1) match old output, with rows for no holdings 2)
	  calculate transcendance only once per function call

2010-08-10  gmc

	* fix age protection proximity test for in-DB circ
	  
	  Patch from John Craig.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-08-10  erickson

	* use staff query for lineitem->bib linking ui

2010-08-10  gmc

	* bug 592777: allow authoritative version of open-ils.circ.retrieve
	  
	  Part of a fix to avoid race condition that can occur
	  when patron renews an item in the OPAC in a database
	  that uses pgpool and replication, which sometimes
	  results in an erroneous 'action_circulation_not_found' error.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-08-10  senator

	* Acq: fix certain dialogs needlessly flashing on-screen while
	  li_table loads

2010-08-11  erickson

	* added an UI for editing vandelay import item attribute
	  definitions. it's a basic autogrid version for now. TODO: fix
	  some grid height styling issues

2010-08-11  phasefx

	* tweak auto-barcode method to support barcodes of arbitrary
	  length. trims last digit from seed barcode if 9 or 14 digits.
	  works with alphanumeric barcodes like b1, test1, demo1 with no
	  checkdigits (so it'll generate demo2, demo3, etc.)

	* change Check Barcodes? checkbox in Volume/Item creator to Use
	  Checkdigit. In addition to checking the barcodes, it also
	  dictates whether the Auto-Generate Barcodes function will use
	  checkdigits or not

	* tweak the layout for the volume/copy creator so that buttons/etc
	  are always on-screen, with just the input textboxes in the
	  scrollable area

2010-08-11  miker

	* missed one fix in previous optimisation effort

2010-08-11  atz

	* Add page title and tidy up

	* Respect activate_po option in interface

2010-08-11  miker

	* Use a COALESCE/NULLIF nested structure instead of CASE (one
	  branch, easy peasy) for 4x speedup in the core search query

2010-08-11  phasefx

	* redundant with util_overlay.xul

2010-08-11  erickson

	* Gave the base login code the ability to find username/password
	  from a
	  cookie. for security reasons, we don't put login data into
	  cookies, but if the
	  login info is available to us in that format already (say, via
	  external means), we'll
	  use it. This can be useful for persistent logins (e.g.
	  self-check) or
	  automatic logins (pushing cookie data out to workstations)
	  
	  Minor cleanup of the login code to make it more re-use friendly.
	  
	  Added self-check support for verifying the staff login before
	  each patron
	  login.

2010-08-11  scottmk

	* Plug some memory leaks.
	  
	  In many places we were creating dbi_results without freeing them;
	  pretty much everything involving transactions, savepoints,
	  inserts, updates, and deletes.
	  
	  M Open-ILS/src/c-apps/oils_sql.c

2010-08-12  miker

	* register the autoloader earlier, and log about the use it gets

2010-08-12  scottmk

	* Complain when a sequence name is not qualified by a schema.
	  
	  M Open-ILS/src/c-apps/idlval.c

2010-08-12  dbs

	* Remove broken old JavaScript in Google Book preview code
	  
	  I /think/ this was supposed to change the title of the "Preview"
	  link to
	  "Read this online" or the like in the case that the full text is
	  available,
	  but it was relying on a function that didn't exist (setText) and
	  trying
	  to reference an ID that didn't exists. So it broke in those rare
	  cases
	  where Google Books did provide the full text.

2010-08-12  erickson

	* avoid confusion by not installing the non-functional
	  GenerateBatchOverduePDF reactor with the seed data.

	* created batch/streaming versions of hold placement and
	  possibility check calls:
	  open-ils.circ.holds.create[.override].batch and
	  open-ils.circ.title_hold.is_possible.batch. Arguments are the
	  same as non-batch, just delivered as an array; responses are
	  delivered in order inbound params

2010-08-12  phasefx

	* yet more auto-scrolling to stamp out

	* yet more auto-scrolling to stamp out

2010-08-12  erickson

	* yet more auto-scrolling to stamp out

	* re-label recv_date as 'Invoice Date' to avoid confusion around
	  the 'receive date' of constituent physical items

2010-08-12  atz

	* Allow * in file portion of pathname
	  
	  Example:
	  incoming/*.xpo => incoming/yegagufoNy.xpo
	  
	  You cannot put an asterisk in the path portion of the string,
	  however,
	  since that would mean the target directory was not determined.

2010-08-13  miker

	* protect authority linking trigger against broken $0 values

2010-08-13  phasefx

	* change the (Copy) link next to addresses in the patron summary to
	  (Copy/Print), with a popup menu for choosing which action to do

2010-08-13  erickson

	* DOM text/pattern highlighter
	  
	  openils.Util.hilightNode(
	  node,
	  [pattern1, pattern2, ...],
	  {classname:foo}
	  );

2010-08-13  miker

	* fix cut-n-paste-o

2010-08-13  phasefx

	* add title to item notes window and an accesskey for closing the
	  window. Spawn the item note window during the Mark Item Missing
	  Pieces workflow

	* add standing penalty prompt to Mark Item Missing Pieces workflow

	* spawn external text editor for Patron Letter during Mark Item
	  Missing Pieces workflow. Put configuration option under Admin ->
	  Local System Administration -> External Text Editor Command

2010-08-13  erickson

	* repaired class name typo (thanks dbs). made args more generally
	  useable

2010-08-13  phasefx

	* playing around with Find in Page functionality; the recent dojo
	  highlighter commit prompted me to share this

	* go ahead and expose the Find in Page functionality, but hide it
	  under the Debug label for now. Other than being incomplete (no
	  Find Next, etc.), the main problem I see are our dynamic dojo
	  interfaces where the text one might be tempted to search for
	  won't actually be rendered yet on the screen (say in a scrolling
	  list)

	* meant to hide these Find in Page buttons

2010-08-13  dbs

	* Add Debian Squeeze prereq support, drop out-of-date items
	  
	  * Drop Debian Etch ("Security updates have been discontinued as
	  of the end of February 2010.")
	  * Drop PostgreSQL server packages pre-8.4 as they are no longer
	  supported
	  
	  TODO: To continue to support Ubuntu Hardy and Debian Lenny, we'll
	  need to
	  start pulling in backports of postgresql-8.4.

2010-08-13  senator

	* merge seials-integration [sic] branch into trunk
	  
	  Dan Wells has provided tremendous efforts in developing a user
	  interface
	  and middle-layer logic for controlling serials. His work builds
	  on the
	  serial schema hashed out earlier in the year, also with his heavy
	  involvement,
	  and it provides ways to manage subscriptions, distribution,
	  prediction,
	  receiving and more. Although this code is but a beginning, much
	  of it
	  is functional today.
	  
	  This commit brings Dan's work into trunk. Dan has provided some
	  release
	  notes here:
	  http://www.open-ils.org/dokuwiki/doku.php?id=acq:serials:release_notes:initial_trunk_merge

2010-08-14  scottmk

	* Pedantic change for const-correctness: changed three calls to
	  jsonObjectGetKey() to call jsonObjectGetKeyConst() instead.
	  
	  M Open-ILS/src/c-apps/oils_utils.c

2010-08-15  scottmk

	* Pedantic change for const-correctness: replaced a call to
	  jsonObjectGetKey() with a call to jsonObjectGetKeyConst().
	  
	  M Open-ILS/src/c-apps/oils_auth.c

	* Pedantic change for const-correctness: replaced two calls to
	  jsonObjectGetKey() with calls to jsonObjectGetKeyConst().
	  
	  M Open-ILS/src/c-apps/test_json_query.c

	* Pedantic changes for const-correctness:
	  
	  1. Add the const qualifier to most of the parameters of SELECT().
	  
	  2. In almost all cases: replace calls to jsonObjectGetKey() with
	  calls to jsonObjectGetKeyConst(). A couple of calls remain that
	  would be more trouble to replace than they're likely to be worth.
	  
	  M Open-ILS/src/c-apps/oils_sql.c

2010-08-16  phasefx

	* Disable Replace Barcode button for new patrons, and disable the
	  barcode field for existing patrons. If Replace Barcode is
	  activated, then enable the barcode field, give it focus, and
	  disable the Replace Barcode button.

	* tsbere pointed out this typo

	* redundant refresh() can cause duplicate rows in list. Also, perm
	  failure is an "expected" error here, so we can skip the skull and
	  crossbones if folks without the permission cancel the Void All
	  Billings action

2010-08-16  atz

	* 0372 - acq.edi_message.vendacct
	  
	  Needed for some but not all vendors (separate from SAN).

2010-08-16  phasefx

	* forwardport of 17216, org hiding depth in opac

	* ui.circ.suppress_checkin_popups disables dialog prompts during
	  check-in, but in the case print slip dialogs, it should still
	  print the slips if the Auto-Print Hold and Transit Slips checkbox
	  is toggled on (the action is still occuring). However, only the
	  dedicated Check-In interface had such a checkbox, and if you were
	  to check-in from Item Status or Items Out with that org unit
	  setting active, you'd have no option to print any slips
	  associated with the check-in. This fixes all that

2010-08-16  erickson

	* patch from Ben Ostrowsky to help clarify the CREATE_MARC and
	  IMPORT_MARC permissions descriptions

2010-08-17  erickson

	* libbusiness-creditcard-perl is installed with DEBS. removing from
	  squeeze-specific debs. make sure we install the
	  EXTRA_DEBS_SQUEEZE as part of install_extra_debs_squeeze

2010-08-17  dbs

	* Fix typo in i18n Makefile that afflicted install

	* Move to CSS-based styling of validated vs. unvalidated fields
	  
	  This sets the stage for differentiating between validated fields
	  that
	  match authority records, and validated fields with a controlling
	  $0
	  subfield that match an authority record. This also gives sites a
	  bit
	  of an easier entry point to customize their MARC editor - say,
	  for example,
	  to support accessibility requirements if red vs. black doesn't
	  satisfy
	  the needs of those who are colour-blind.

	* Tell developers that they need to install Dojo

2010-08-18  dbs

	* Create indexes on some Vandelay tables to speed up retrieval and
	  delete operations

2010-08-18  phasefx

	* thinko here was throwing off the tallies for checked_out.count

2010-08-18  atz

	* Descriptive notes in interface

	* Fix closing </tr> tags

2010-08-18  dbs

	* Fedora packages perl-MARC-Record at 2.0.0, but 2.0.1 is required

2010-08-18  phasefx

	* some defensive coding. TODO: disable actions in Holds list
	  interfaces that affects items when the selected holds have no
	  Current Copy

2010-08-18  dbs

	* Give authority records an XML-valid XML formats list
	  
	  Still need to trim the actual list of formats for authority
	  records,
	  as marcxml-full and marcxml-uris get listed, and those do not
	  work
	  or make sense for authority records.

2010-08-18  miker

	* so, some datasets have records with multiple 245a subfields.
	  yeah, really.

	* so, some datasets have records with multiple 245a subfields.
	  yeah, really.

2010-08-18  atz

	* Fixup ctx.page_title and script type declarations
	  
	  Some had ctc.page_title, another had page_titel, but most didn't
	  have any.

2010-08-18  dbs

	* Only Debian Squeeze currently packages MARC::Record > 2.0.1

2010-08-18  erickson

	* provide an explicit import() sub to collect the boostrap config
	  name at import. force child_init to run (once) if not run by
	  Apache

	* money_open_user_summary may not exist if the user has no
	  transactions to summarize. protect against null summary object

2010-08-19  dbs

	* Add basic authority browse/edit/delete interface
	  
	  http://localhost/eg/cat/authority/list should get you where you
	  need to be
	  
	  The paging is comical, the JS should probably be split out from
	  the
	  declarative markup, the interface needs i18n, the UI needs to
	  become
	  usable - but at least we have exposed some functionality for
	  working
	  with authority records now.
	  
	  Ideally this becomes a widget that we can just embed into other
	  interfaces to maintain context (which suggests using openils.cgi
	  to seed the initial values of the widget).
	  
	  Note that the delete function works - it sets the deleted flag
	  for
	  an are to "true" - but the underlying authorities browse
	  interface
	  currently doesn't care about such niceties and always returns
	  deleted
	  records along with undeleted records. So that might be the next
	  stop.

	* Forgot to set the open-ils.pcrud controller for are in r17255
	  
	  And making the new perm section tab-consistent while I'm at it

	* Don't return deleted authority records in a browse list

	* Don't show deleted authority records in startwith browse, either
	  
	  Also restore the >= operator that was stomped in r17257

	* Fix some defects in the first iteration of the authority
	  edit/delete interface
	  
	  * Ensure that the correct ID is assigned to the edit/delete
	  request
	  * Prevent caching of results so that when a record is deleted, we
	  don't continue to see it

	* Give the authority list interface a place on the staff client
	  Cataloging menu
	  
	  The interface itself still needs usability love, but exposing
	  basic edit/delete
	  functionality for authority records should give authoritarians
	  some level of
	  happiness.

2010-08-19  erickson

	* downgraded a debug log message from error() to debug()

	* added clear_marc to po li retrieval to cut down network; mild
	  code cleanup

	* automatically create lineitem assets (i.e. load bibs and items)
	  during po activation when necessary since activation requires it;
	  only do this during non-dry-run calls

	* for consistency, use same 'icons' to indicate PO and PL. don't
	  show PO/PL links when no such object is linked to the lineitem

	* added missing closing td

2010-08-19  miker

	* Add support to BibTemplate for arbitrary XML chunks (DOM node)
	  via the "xml" constructure param, which disables automatic
	  format-specific fetching.
	  
	  Add a new module, openils.FeedTemplate which, given:
	  
	  * an xml feed (URI or pre-collected DOM node)
	  * a dojo.query to pull out items from the feed
	  * the DOM node of a template to clone for each item
	  * the target DOM node into which it should shove the item-filled
	  template instances
	  
	  will render a feed of arbitrary xml for you.

2010-08-19  dbs

	* Further enhancements to the authority list interface
	  
	  * Offer Next / Previous buttons instead of forcing the number
	  spinner
	  * Submit searches onBlur of the search box instead of having to
	  click Submit
	  * Accept CGI params so we can kick off a search from other
	  interfaces
	  * Factor out the displayRecords() code so we can attach other
	  events to it

2010-08-19  senator

	* Acq: make view/place orders open a new tab w/ xul browser wrapped
	  therearound

	* Serials: an alternative batch receiving interface, to support
	  certain
	  heavy-barcoding workflows.
	  
	  Still needs some things hooked up in the middle layer to create
	  serial.units.
	  Still needs some configurability. Access from "Actions for this
	  Record" in
	  the staff-client-wrapped OPAC for a record with subscriptions and
	  items
	  attached.

2010-08-19  erickson

	* added util function for printing an html string; use new func for
	  PO printing; TODO, use new func in selfcheck code to reduce
	  duplication

	* circ_modifier codes could be defined, but non-true (i.e. '0').
	  test for defined instead of truthiness when analyzing LID circ
	  modifiers. repaired (invisible) bug that unnecessarily lead to
	  using circ mod objects instead of codes, depending on context

2010-08-19  dbs

	* Class::DBI::Frozen::301 needs to be forcefully installed on
	  Debian Squeeze

2010-08-19  erickson

	* move PO status to top of page for clarity

	* submit unified search query on Enter when focused on value widget

2010-08-20  dbs

	* Give the Authority List interface the ability to merge records...
	  almost
	  
	  Separate the interface into separate JavaScript vs markup files
	  
	  To-do:
	  * Provide a middle layer method that accepts the array of records
	  to merge and merges them
	  * Teach the mergeRecords() to call that method when it exists
	  * Provide a way of reordering the records or otherwise flagging
	  which record should be the lead
	  * Prevent the same record from being added to the merge slushbox
	  twice

	* Add a speedbump (confirmation dialog) when deleting authority
	  records

	* Add a speedbump to the MFHD delete workflow

	* When initiating a new authority search, reset the pager to zero
	  to avoid surprises

	* Hitting ENTER in the term search box fires off a search now, as
	  you would expect

2010-08-20  gmc

	* bug 620899: fix broken test for oils_web.xml
	  
	  Patch from Rick Scott <rick@shadowspar.dyndns.org>
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-08-20  dbs

	* Add the authority record merge middle-layer API
	  (open-ils.cat.authority.records.merge)
	  
	  Also add a pertinent permission (MERGE_AUTH_RECORDS)

	* Hook up the authority management interface to the middle layer
	  
	  For now, uses the first record in the list as the master; we
	  either
	  need to give users the ability to select the master record at
	  merge
	  time, or to select it prior to clicking "Merge"

2010-08-20  erickson

	* repair faulty lineitem detachment from invoices

	* propagate estimated price to created copy as copy price (aka list
	  price or replacement price); propagate invoiced amount to created
	  copy as copy cost (aka library cost); caveats and consderations
	  noted in the code.

	* until distrib formula skip_count is used (and possibly even
	  then), let's hide it from the setup UI

	* during LI creation, adopt the provider of the PO if linked to a
	  PO (and no provider was selected). repair event description
	  copy/paste error

2010-08-20  dbs

	* Apply a little bit of style to group form elements together in
	  confined spaces

2010-08-20  phasefx

	* eliminate false positives for ContentCafe features for a given
	  bib

2010-08-20  erickson

	* added support for a SIP config option that forces the server to
	  return the no_i18n version of the patron profile group name from
	  the 'ptype' sub (aka PC field in patron-info requests); added
	  config options getter sub; cleaned up some string concats to
	  prevent warnings

2010-08-20  dbs

	* Add an API for counting the number of bibs linked to each
	  authority record in the input list
	  
	  srfsh# request open-ils.cat
	  open-ils.cat.authority.records.count_linked_bibs [1,2,3,4,5,6]
	  
	  Received Data: [
	  {
	  "bibs":1,
	  "authority":1
	  },
	  {
	  "bibs":1,
	  "authority":2
	  },
	  {
	  "bibs":2,
	  "authority":3
	  }
	  ]

2010-08-20  senator

	* Booking: more progress on the forward-port from rel_1_6
	  
	  This completes the merging of changes from r15878 except for
	  those to
	  Circulate.pm, which are more involved and call for more
	  untangling.
	  
	  More to come soon.

2010-08-20  erickson

	* added internal_id handler
	  
	  in anticipation of possible sip extension for returning patron ID

	* added sample SIP config for patron_type_uses_code option

	* re-tab to use tabs for consistency with rest of file; for now,
	  add embedded vim command to settle the issue

2010-08-20  atz

	* Add type="text/javascript" to <script> tags where needed.
	  
	  Probably just a formality.

	* Allow STAFF_CLIENT_BUILD_ID to be passed in or set in ENV
	  
	  Deconflict actions for STAFF_CLIENT_BUILD_ID='current'. Build
	  will
	  always end up in datestamped directory, but a symlink will be
	  added
	  to it w/ the build ID string. That should keep everybody happy.

2010-08-20  senator

	* Booking: finish the forward-port from rel_1_6
	  
	  This /should/ complete the forward port of booking from the
	  rel_1_6 branch,
	  which means that booking in trunk should work just how it does in
	  the latest
	  1.6.1.* releases.
	  
	  Most of the changes in this commit were to Circ/Circulate.pm, and
	  cursory
	  tests don't indicate any problems in the circulation logic
	  overall, but the
	  lay of the land there is quite different now in trunk than it was
	  when Booking
	  was initially developed, so I'd be somewhat wary for a little
	  while.
	  
	  Going forward, trunk can accept improvements/bug fixes/etc for
	  booking, and
	  those changes can be *back*ported to branches in the usual way.
	  Yay!

2010-08-20  gmc

	* fix seed for item_barcode Vandelay bib attribute definition
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-08-21  miker

	* we need an index on LOWER(barcode) with r17018

2010-08-22  dbs

	* Show the number of bibs linked to each authority record
	  
	  This information is important to cataloguers when deciding which
	  records
	  to merge or delete.

2010-08-23  miker

	* Branching for the 2.0 series

2010-08-23  erickson

	* perl 5.8 requires quotes around the version #

2010-08-23  gmc

	* display copy counts correctly in staff search results
	  
	  Useless use of a constant in void context at
	  .../OpenILS/Application/Search/Biblio.pm line 263.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-08-23  phasefx

	* backport 17314: address deletion in patron editor

2010-08-23  atz

	* Failure to open a file(handle) should be a fatal error.
	  
	  Otherwise we aren't getting any output anyway.
	  
	  Also a few formatting touchups for readability.
	  
	  TODO: use warnings! use Cronscript for standardized lockfile and
	  options.

	* Perltidy
	  
	  death to tabs

	* Paste error

2010-08-24  atz

	* 1-line fix for false 404 from sylvar
	  
	  solves "The requested URL
	  /xul/rel_1_6_0_7/server/patron/ue.xhtml&clone=112879 was not
	  found on this server."

2010-08-24  phasefx

	* rip the join tab feature out of 2.0; it's still experimental and
	  doesn't work well with the embedded OPAC

2010-08-25  miker

	* update standing penalty query for blocked barcode list, trunk
	  style!

2010-08-26  senator

	* Backport r17346 to fix broken OPAC renewals

2010-08-26  miker

	* examples of how to specify default preferred language and weight
	  values

2010-08-27  phasefx

	* backport 17361: support hiding of patron credit functionality. To
	  do this, create a server/skin/global_custom.css file containing
	  .hide_patron_credit { display: none }

2010-08-30  phasefx

	* backport 17375-17379 for context sensitive (role-based) print
	  settings

	* backport 17335: circ.missing_pieces.copy_status org unit setting
	  to support the Mark/Scan as Missing Pieces workflow

2010-08-30  senator

	* Backport 17373, making "show item details" consistent within
	  "items out" i'face

2010-08-30  phasefx

	* backport 17383: show penalty/message notes on "Stop Sign Page"

	* backport 17385: option to not include claims returned circs in
	  summary sidebar and under-button tallies

2010-08-30  senator

	* Backport r17387, basic copy template editor

2010-08-30  scottmk

	* Backporting corrections to some org unit setting types.
	  
	  A
	  Open-ILS/src/sql/Pg/upgrade/0378.data.fix_org_unit_setting_types.sql
	  M Open-ILS/src/sql/Pg/950.data.seed-values.sql

2010-08-31  senator

	* Backport r17405: fix start/end date selection problem with
	  reservations

2010-08-31  phasefx

	* fixes a bug when purging offline transactions after an Export

	* printable_output() support in util.browser had stopped working,
	  and this fixes that. If an interface embedded in util.browser has
	  a printable_output() function, the text output from that function
	  should be printed, instead of a direct print attempt against the
	  content window

2010-09-01  miker

	* backport r17396 from trunk: Allow the OPAC to autoload IDL
	  classes instead of either pulling in a long class list and
	  evaluating them all, or loading a .5MB+ xml file and parsing the
	  whole thing. 40% speedup in simple tests where cache is bypassed.

	* backport r17419 from trunk: added explicit IDL class loading for
	  cbreb, cbrebi, mvr, and ahr

2010-09-01  senator

	* Backport r17364 from trunk: serial batch receive improvements

	* Backport r17428 from trunk: serial batch receive improvements (w/
	  call number)

	* Backport r17431 from trunk, checkbox to en/disable batch receive
	  w/ units

2010-09-02  dbs

	* Backport biblio source enhancements from trunk:
	  
	  * Make biblio source selection in Vandelay set the source for
	  imported
	  bib records.
	  
	  * Place a biblio source editor widget on the MARC Editor when
	  invoked
	  with a biblio record that already exists in the database
	  ("rtype": "bre"
	  with a specific ID).

	* Backport spine label editing and printing enhancements from trunk
	  
	  * Automatically add prefix and/or suffix to a spine label if set
	  in the copy locations editor
	  
	  * Set default font size, family, and weight along with label
	  height, width,
	  and left margin for each library via library settings editor.
	  
	  * Navigate up and down using cursor keys and insert/delete lines
	  with
	  the insert/delete keys.
	  
	  * Provide some basic LC formatting for line wrapping.
	  
	  * Use different print strategies depending on whether we're using
	  xulrunner 1.9.0 or 1.9.2.

	* UI portions of spine label editing enhancements listed in r17437
	  
	  Also include the IDL for the new fields on asset.copy_location.
	  Oops.

	* Backport r17343 from trunk: Add explicit identification of the
	  master authority record when merging
	  
	  We now generate a table with the first cell containing either
	  "Master"
	  (indicating the record into which the other records will be
	  merged) and
	  or "Target" (indicating that the record will be merged into the
	  master.
	  
	  This also adds a horizontal rule to delineate between the form
	  buttons
	  at the top, and adds borders to provide more clarity between the
	  mergebox
	  contents.

	* Backport rtype parameters for invoking MARC editor
	  
	  This will result in no different behaviour than before,
	  but adding the rtype parameter won't hurt, either.

2010-09-02  phasefx

	* backport 17441: stop the chilifresh undefined errors in craftsman

2010-09-02  senator

	* Backport r17447: kill CAPTURE_RESERVATION

2010-09-02  phasefx

	* fix the problem where login does not work immediately after
	  registering a workstation

2010-09-02  erickson

	* back-porting: conify UIs for circ/hold-related config.rule_
	  tables

	* back-porting: added support for configuring redirect depth, skin,
	  and locale during IP-based org unit redirection; w/ sample config

	* back-porting: added support for returning hold shelf expire time
	  (CM field) in item info response when an item has been captured
	  for a hold. value is populated if item is on holds shelf or in
	  transit to holds shelf

	* back-porting: 17355 use openils.Util.printHtmlString for invoice
	  printing; added progress dialog while wiating for invoices to
	  arrive

	* back-porting: 17389 => show lineitem ID for each lineitem in
	  lineitem table (po/pl) and general lineitem summary blob
	  (invoicing)

	* back-porting: 17390 => disallow self-check login w/ inactive
	  barcode

	* back-porting: r17391 17397 17398; pcrud/fieldmapper bug fixes;
	  autogrid suppress edit fields option

	* back-porting: 17399 17413 => optimized distrib formula management
	  UI

	* back-porting: 17400 17401 => support for overridable physical
	  location in checkin and honoring current_location in SIP checkin
	  code

	* back-porting: 17416 17417 17418 => filtering-tree-select disable
	  fields query w/ auto-widget pass-thru; disable non-user-group
	  fields in patron editor

	* back-porting: 17446 => display PO order (activation) date in PO
	  page

2010-09-03  phasefx

	* backport 17445, 17464: A/T template based full pull list printing
	  for holds

	* up the default pull list limit from 50 to 100

2010-09-03  erickson

	* back-port: 17467 => users with no transaction history will have
	  no xact summary; protect

2010-09-03  miker

	* backporting supercat improvements from r17469 and r17470

2010-09-03  senator

	* Backport r17472 from trunk, serials pattern code wizard

2010-09-03  gmc

	* allow updates of permission.perm_list.id to cascade
	  
	  Doing this to make it possible to reshuffle permission IDs
	  for upgrades to 2.0.x
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-03  erickson

	* repaired thinko in hold targeting org-unit max-loops check

	* back-porting: 17480 => patron address copy on clone instead of
	  link

2010-09-03  gmc

	* restrict deletion of perm_lists in use
	  
	  Per suggestion by Mike Rylander; prevents overzealous
	  administrator from removing necessary permisions that
	  are in use.
	  
	  TODO: UI to make it clear when that happens
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* give default OUs separate addresses
	  
	  Per suggestion from Anoop Atre to avoid a new user
	  changing one OU address in a new database and wondering
	  why all of the OU addresses were changed.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-03  miker

	* backporting r17476, r17477 and r17486 from trunk -- MARC Dojo
	  module improvements

2010-09-03  erickson

	* event code may be 0 (SUCCESS) == false in SIP checkin, check
	  defined instead

2010-09-03  senator

	* Backport r17491 from trunk: fix timestamps in AutoFieldWidget

2010-09-07  scottmk

	* Consolidated upgrade script for 1.6 -> 2.0.
	  
	  Things still missing:
	  
	  1. Inserts and other changes to permission.perm_list and
	  permission.grp_perm_map. These can't be derived in a simple way
	  from
	  the individual upgrade scripts, and will have to be hand-crafted
	  to
	  fit what's already in the seed data.
	  
	  2. Operations on optional schemas need to be moved out of the
	  transaction so that the script will work in a database that
	  doesn't have them.

2010-09-07  erickson

	* make lineitem price updates synchronous to prevent race condition
	  between onChange of price set completion and PO activation

2010-09-07  phasefx

	* Only modify msg when needed or we'll get spurious 'stop sign'
	  pages

2010-09-07  scottmk

	* Move some operations out of the transaction so that they can
	  fail without killing the script. The affected objects do
	  not necessarily exist -- i.e. the reporter schema, the
	  extend_reporter schema, and the
	  auditor.action_hold_request_history
	  table.

	* The reporter and extend_reporter schemas are no longer optional.
	  So changes to them go back into the transaction.
	  
	  ALTERs to auditor.action_hold_request_history stay outside of the
	  transaction, at least for now, until the status of that table
	  is clarified.

2010-09-08  phasefx

	* backport 17508, 17509, for better user stat cat lookups and
	  exposing such stat cats in hold slips

2010-09-08  erickson

	* back-porting: 17502 17503 => cache the SIP login session to
	  determine 'where' a transaction is occuring in case the caller
	  does not indicate the location; compare hold pickup lib to
	  physical location to determine alert type; small logging and
	  format tweaks

2010-09-08  phasefx

	* backport 17506, 17507 for saner navigation in Holdings
	  Maintenance

2010-09-08  miker

	* backporting r17514 from trunk: A simple "vital stats" collector
	  method returning information about a user for display in the OPAC
	  or Staff Client.

2010-09-08  dbs

	* Backport r17518 from trunk: install Library::CallNumber::LC from
	  CPAN
	  
	  We briefly had to grab Library::CallNumber::LC from the SVN repo,
	  but
	  that broke on systems without subversion installed (argh).
	  Thankfully
	  the maintainer moved Library::CallNumber::LC to CPAN so our job
	  becomes
	  routine.

	* Backport r17520: Make Class::DBI::Frozen::301 a common forced
	  module for all distros; genericize RHEL/CentOS

2010-09-08  phasefx

	* Backport 17516, 17517, 17522, 17523: Allows us to create an
	  /openils/var/web/css/skin/default/register_custom.css file
	  containing local CSS for styling the patron editor. Example:
	  
	  TR[fmfield=ident_type] { display: none; } /* be sure to set the
	  ui.patron.default_ident_type setting */
	  TR[fmfield=ident_value2] { border: solid thick red; font-size:
	  x-large; }
	  TR[fmfield=barred] { display: none; }
	  TR[fmfield=country] { display: none; } /* be sure to set the
	  ui.patron.default_country setting */
	  TR[fmfield=master_account] { display: none; }
	  TR[fmfield=alert_message] { display: none; }
	  TR[fmfield=ident_value] { z-index: -1; }
	  TR[stat_cat_id='1'] { border: solid thick red; font-size:
	  x-large; }

2010-09-08  senator

	* Backport r17525 from trunk: summary generation at receive time

2010-09-09  dbs

	* Make OpenLibrary the default added content provider
	  
	  OpenLibrary is a better choice than Amazon for added content out
	  of the box
	  because:
	  
	  1) The OpenLibrary added content handler provides cover images +
	  tables of content, whereas the Amazon added content handler only
	  provides cover images.
	  
	  2) The terms of use for OpenLibrary content are much friendlier
	  than
	  the Amazon "Product Advertising API".
	  
	  We discussed this back in mid-2009:
	  http://markmail.org/message/csx2hl6aleznapga

2010-09-09  miker

	* Merging r17527-17529 from trunk: Backend issuance-level hold
	  logic

2010-09-09  dbs

	* Address typos and grammar in seed data
	  
	  TODO: Consistently wrap translatable content in
	  oils_i18n_gettext() calls

2010-09-09  erickson

	* back-port: 17535 => for consistency, use 'issuanceid' as the
	  issuance ID param for holds possibility testing; removed some
	  crusty, old hold create code

2010-09-09  senator

	* Backport r17537 from trunk: serials pattern wizard bugfix

2010-09-09  erickson

	* updated ils_version for 2-0 branch, updated comment on format

2010-09-09  miker

	* Backport from trunk: With group billing calls we need a new index

	* Backporting from trunk: should have had this index all along, but
	  was less important until now where copy notes are used up front

	* Backport from trunk: loop over users in a group, as the plan for
	  usrgroup+mous is terrible

2010-09-09  senator

	* Backport r17547 from trunk: overrideEditWidgets in AutoGrid
	  improvement

2010-09-09  phasefx

	* merge r17549 from trunk for brief bib summary bar

	* merge r17550 from trunk for call number sorting in volume/item
	  creator

2010-09-09  senator

	* Backport r17555 from trunk, better autogrid overrideEditWidget
	  value shoving

2010-09-09  phasefx

	* merge r17557 from trunk for to prevent accidental address
	  deletion attempt in patron editor

2010-09-09  erickson

	* back-porting: 17553 17554 => support for viewing and editing
	  existing issuance-level holds to the default opac skin; alternate
	  issuance flesh call that only fleshes the subscription; used for
	  public/opac display

2010-09-09  phasefx

	* merge r17560 from trunk for tweaks to holds and hold details
	  interfaces

2010-09-10  senator

	* Backport r17563 from trunk: booking bugfix

2010-09-10  erickson

	* back-porting: 17566 => added command line option for defining a
	  stderr output log file for the SIP server

2010-09-10  phasefx

	* merge r17576-r17580 from trunk for improved columns in Patron
	  Search results list. Also fleshes some patron data sent to misc
	  receipt templates

	* merge r17582 from trunk for
	  ui.patron.registration.require_address setting

	* merge r17588-r17592 from trunk for patron refunds and misc tweaks

2010-09-10  senator

	* Backport r17595 from trunk, nav buttons in view/place orders

	* Backport r17597 from trunk, autogrid refresh

	* Backport r17599 from trunk, refresh grid buttons

2010-09-11  miker

	* Backporting 17856, 17587, 17593, 17601 and 17603 from trunk:
	  mod_deflate support; improved and expanded dojo layers; support
	  for limiting facet retrieval in IE to just the initially
	  displayed set (IE is terrible with large data sets)

2010-09-12  senator

	* Backport r17607 from trunk: serials predictions until end_date

2010-09-12  miker

	* Backporting r17609 from trunk: add maxValuesPerFacet attr/param

	* Backporting r17605 and r17606 from trunk: Method for retrieving
	  received issuances attached to a bib, optionally scoped by
	  location, holding type or item status, with paging and ordering
	  support

2010-09-12  senator

	* Backport r17612 from trunk: serials prediction for multiple dists

	* Backport r17615 from trunk: serials quick-and-dirty admin
	  interfaces

2010-09-12  phasefx

	* merge r17614 from trunk for customizable circ modifier rendering
	  in staff client

	* merge r17617 from trunk for _custom.properties file overlays with
	  messagecatalog

2010-09-12  senator

	* Backport r17620 from trunk: serials opac method bugfix

2010-09-13  erickson

	* back-port: 17622 => wrap custom props file reader in try/catch to
	  prevent xhr complaining about missing file

2010-09-13  gmc

	* make the other two k_* MARC templates usable by default
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-13  erickson

	* added declaration of facet cache limit var, which was likely
	  missed during back-port

2010-09-13  miker

	* Backport r17629 and r17630 from trunk: teach fielder to cache
	  (off by default), with a default timeout of 5min; have fielder
	  cache some frequently used data

2010-09-13  gmc

	* fix retrieval of cat.default_classification_scheme
	  
	  Fixes bug where the cat.default_classification_scheme OU
	  setting was effectively ignored in bib call # display
	  in bib overlay and list of default call numbers during volume
	  creation.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-13  dbs

	* Merge r17574, r17575, r17584, r17585, r17628, r17639 from trunk
	  to delete deprecated cgi-bin configuration interfaces
	  
	  The CGI interfaces have not been maintained; the interfaces
	  available through
	  the Admin -> Server Administration menu in the staff client are
	  the recommended
	  method for setting up new libraries in the organizational
	  hierarchy,
	  permissions, copy statuses, and circulation rules.
	  
	  Note that an adjustment to eg.conf is recommended to point to the
	  offline.pl script, which is the only remaining CGI script in use;
	  this
	  should avoid conflicting Apache definitions for the /cgi-bin/
	  alias.
	  
	  Most modern systems will install Class::DBI::Frozen::301 to avoid
	  conflicts with incompatible Class::DBI packages. We need to teach
	  offline.pl how to use Class::DBI::Frozen::301 if it is available.
	  
	  Note that we're using "use parent" instead of "use base" per the
	  recommendation of "perldoc base"; accordingly, we're adding the
	  system prerequisite for the parent pragma.

2010-09-14  miker

	* Backport I18N protection for permission descriptions

	* Backport from trunk: method for generating a set of compressed
	  holdings statements

	* Backport from trunk: slimpac cleanup

	* Backport r17653: unbreak item count in result list of slimpac

2010-09-14  phasefx

	* regexp for robust filename mangling

2010-09-14  erickson

	* back-port: 17658 =>additional issuance holds supporting code; in
	  this case, hold_to_mvr func which is used by the uber hold
	  details method; commit also includes a small speed tweak for
	  fetching details for copy holds (1 less cstore call)

2010-09-14  senator

	* Backport r17657 from trunk: payflowpro support

	* Backport r17661 from trunk, serials opac holding display

2010-09-14  dbs

	* Backport r17644 from trunk: Integrate authority browse and
	  creation support into the MARC editor
	  
	  This commit changes the contextual authority menu to be based on
	  the authority browse interface; this should result in better
	  matching behavior. The browse axis (author, subject, title,
	  topic)
	  is based on the context tag.
	  
	  The browse interface has enabled the contextual menu to grow
	  "Next page" / "Previous page" menu items to enable cataloguers
	  to wade through long lists of similar authority entries.
	  
	  The browse interface has also grown a "Create new authority
	  record"
	  menu with two submenu items:
	  
	  * "Create immediately" takes the field in context and creates a
	  new authority
	  record based on that field, with matching indicators and
	  subfields.
	  
	  * "Create and edit..." displays the MARCXML for the authority
	  record in
	  a MARC editor window before saving the record to the database.
	  
	  TODO: Make the "Create..." contextual options add the $0 linking
	  subfield
	  to the newly controlled field.
	  
	  TODO: Address some of the flaky UI behaviour, such as having to
	  right-click
	  three times on an authority-controllable field to display the
	  authority menu.

2010-09-15  gmc

	* MARC tooltip updates
	  
	  * updated bibliographic tooltips; now current as of LC MARC21
	  Bibliographic
	  Update 11, including the RDA tags. Along the way, enhanced the
	  bib tooltips to:
	  * include definitions for embedded holdings tags (84X, 853-855,
	  863-868, 876-878)
	  * expand dropdown for nonfiling indicator values
	  * added tooltip files for authority records and MFHDs
	  * taught MARC editor how to choose the correct tooltip file
	  
	  Caveat: if you localize the authority and MFHD tooltips for a
	  locale other than
	  en-US, you must edit marcedit.js, either to take your translation
	  into account
	  or to make it smarter about checking for available translations
	  of the tooltips.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com

	* backport EDI changes from trunk (r17669:17690,r17692)
	  
	  EDI work done by Joe Atzberger; highlights of the enhancements
	  are:
	  
	  * ORDRSP processing improvements
	  * overhaul of edi_fetcher
	  * EDI test files
	  * Beginning of modperl EDI message viewer
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-15  miker

	* Backporting from trunk: A big pile of useful serial-schema
	  indexes

2010-09-15  erickson

	* back-port: 17699 => filter debits/allocs by fund in view fund UI

2010-09-15  miker

	* Backporting r17702 from trunk: Require that the matchpoint
	  is_renewal flag be respected if set

2010-09-15  scottmk

	* 1. Revamp the contents of permission.perm_list:
	  
	  a) Renumber the permissions so that predefined permissions and
	  non-predefined permissions are in separate ranges. That was
	  always the intent but the intent has not always been followed.
	  
	  b) Add permissions that are referenced in the IDL but not
	  defined in the database.
	  
	  c) Where the description is NULL, apply the code as a
	  description;
	  that's better than nothing.
	  
	  2. Incorporate miscellaneous recent changes from individual
	  upgrade
	  scripts.

2010-09-15  phasefx

	* merge r17707-r17708 from trunk for batch call number updates in
	  same UI as batch barcode updates

2010-09-15  scottmk

	* Replace the seed data for permission.perm_list, using the values
	  assigned for predefined permissions by the upgrade script from
	  1.6.1 to 2.0.
	  
	  M Open-ILS/src/sql/Pg/950.data.seed-values.sql

2010-09-15  miker

	* Backporting r17710 from trunk: Need to start the arrayref out
	  right

2010-09-16  miker

	* Backporting r17715 from trunk: Patch from Dan Wells to extend the
	  serial schema a bit in pref for upcoming improvement to existing
	  features

	* Backport of r17718 from trunk: teach
	  open-ils.storage.serial.issuance.ranged_tree about "global"
	  issuances

2010-09-16  senator

	* Backport IDL-chunking work for interfaces under web/templates, as
	  well as
	  AutoWidget/AutoFieldWidget improvements to deal with some cases
	  of not having
	  an IDL class preloaded.

2010-09-16  dbs

	* Drop the arn_value / arn_source columns on authority.record_entry
	  and create an index instead
	  
	  The authority record number (ARN) was problematic when trying to
	  generate
	  local authorities because the number had no correlation to the
	  content of
	  the authority heading. By creating an index on authority records
	  based on
	  their heading, thesaurus, and heading text, we can do a better
	  job of
	  controlling the actual content of the authority records.
	  
	  In a future release, we may convert this index to a unique index.
	  2.0
	  will give sites an opportunity to begin cleaning up their
	  authorities
	  by identifying duplicate and problematic records through the
	  authority.normalize_heading(TEXT) database function.

	* Backport r17723 from trunk: Add AutoIDL classes for Vandelay
	  happiness
	  
	  Vandelay needs these class definitions for basic import
	  operations.
	  
	  Ideally every templated page wouldn't need to load these, but
	  this seems to be the best short-term solution.

2010-09-16  scottmk

	* Incorporate several late-breaking upgrades into the upgrade
	  script.
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

2010-09-16  miker

	* A couple useful, missing backports for the IDL

	* Missed some holds-related OU setting types from
	  0077.data.holds_local_avail_and_override.sql in the seed data

	* This needs to be the same in 2.0 as trunk, and the changes to
	  this script need to make it into the 1.6-2.0 upgrade script as
	  well, if not there already

	* no need to ignore this improvement, which makes browser-focused
	  dev simpler

	* typo backport

	* This needs to be the same in 2.0 as trunk, and the changes to
	  this script need to make it into the 1.6-2.0 upgrade script as
	  well, if not there already

2010-09-16  scottmk

	* Make acq.provider_contact.name NOT NULL.
	  
	  This change corrects the effect of a typo (NULL NULL instead of
	  NOT NULL).
	  
	  M Open-ILS/src/sql/Pg/200.schema.acq.sql
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql
	  A
	  Open-ILS/src/sql/Pg/upgrade/0404.schema.acq-provider-contact-null-null.sql

2010-09-16  senator

	* Backport r17736 from trunk: more IDL chunking-related fixes

	* Backport r17738 from trunk: more IDL chunking fixing

	* Backport r17735 from trunk, opac holds issuances expandy

	* Backport r17717 from trunk

2010-09-16  gmc

	* remove internal limit with querying on facets
	  
	  This allows non-selective facets such a material type facet
	  to bring in correct results - the tradeoff is that queries
	  that involve facets will run slower.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-16  miker

	* .pot files generated during the alpha2 build process

2010-09-16  scottmk

	* Add column usr_summary to actor.stat_cat. (This column was added
	  before we started maintaining individual update scripts.)
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

2010-09-16  senator

	* Backport r17750 from trunk, IDL chunks + copy template UI fix

2010-09-17  senator

	* Backport r17752 from trunk

2010-09-17  miker

	* Backport r17754 from trunk: Only show "issues held" if there is
	  something to show

	* Backport r17757 from trunk: OU locale lookup needs a bit more
	  work, it needs to pass a language instead of an xx-YY locale
	  string

	* Backport r17759 from trunk: normalize all locales used in
	  locale-lang mapping for QueryParser

2010-09-17  scottmk

	* -- Dropping a foreign key (which has already been dropped from
	  the
	  -- base installation scripts).
	  
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql
	  A
	  Open-ILS/src/sql/Pg/upgrade/0405.schema.acq-hold-copy-map-drop-fkey.sql

2010-09-17  senator

	* Backport r17763 from trunk

2010-09-17  erickson

	* back-port: 17765 => protect against fetching lineitem details by
	  ref instead of ID

2010-09-17  senator

	* Backport r17767 from trunk, vandelay Edit Attributes fix

2010-09-17  dbs

	* Backport r17769 from trunk: use HTTP URLs to download prereqs to
	  avoid protocol-blocking annoyances

2010-09-17  erickson

	* back-port: 17772 => vandelay import list report all option

2010-09-17  scottmk

	* Restore two foreign keys that were somehow inadvertently
	  dropped, probably by some funky interaction with inheritance.
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

2010-09-17  dbs

	* Backport r17776 from trunk: Revert attempt to prevent encoding
	  corruption that was causing encoding corruption
	  
	  LDR/09 was never showing up as 'a' where it was being tested, and
	  adding the
	  'a' was preventing a reconversion to UTF8. It somewhat looks like
	  the UTF8
	  MARCXML input gets converted to MARC8 as part of MARC::Batch's
	  magic, then
	  gets converted back to UTF8 by MARC::File::XML::as_xml_record().
	  Seems like
	  this would mean potential performance / encoding problems but it
	  works, which
	  is better than what my meddlesome tests were doing.

2010-09-17  senator

	* Backport r17778, IDL chunking fixes

2010-09-17  phasefx

	* get rid of the disabled-look for the Actions for this Record menu
	  label

	* merge r17782 from trunk to fix progressbar and list refresh after
	  modifying/archiving existing message/penalty in Patron Messages
	  UI

2010-09-17  gmc

	* enable translation of location name in copy location/status
	  summary
	  
	  Implementation is iffy because it exposes oils_i18n_xlate outside
	  of cstore.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-17  senator

	* Backport r17786, acq po activation failure improvements

2010-09-17  erickson

	* load the right class in the on-the-fly IDL loader call

	* need cit and actsc for patron reg

2010-09-17  gmc

	* added format.po.jedi hook to initial seed
	  
	  Signed-off-By: Galen Charlton <gmc@esilibrary.com>

2010-09-18  erickson

	* more user stat cat classes

2010-09-18  senator

	* Backport r17796 from trunk: serials batch receive improvements

2010-09-18  gmc

	* silly me, acqpo.activate is the new format.po.jedi
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-18  miker

	* Backport r17800 from trunk: Offer a global flag to cause the
	  testing of hold matrix rules against the receiving user instead
	  of the requestor, and set the initial value to enabled as this
	  seems to be the less surprising value for current users of in-db
	  hold logic

	* Patch from James Fournie of SITKA:
	  
	  This is a patch that makes the toolbar work with the little
	  jellybean
	  button on Macs. It's that little lozenge-like button on the top
	  right of Mac programs that shows/hides the toolbar. With this
	  patch
	  it will show/hide the toolbar "button bar", making it behave more
	  like
	  most Mac programs. It shouldn't have any affect on other
	  platforms.

2010-09-18  dbs

	* Backport r17802 and r17803 to provide a human-visible RSS feed in
	  the dynamic OPAC
	  
	  Despite having RSS and Atom feeds at the core since version 1.0,
	  it can be
	  hard for humans to access those feeds. This will dynamically add
	  a feed to
	  the dynamic OPAC so that the RSS feed indicator will light up.
	  Google Reader,
	  look out!

2010-09-18  scottmk

	* Remove UNIQUE NOT NULL from config.index_normalizer.description.
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

2010-09-18  erickson

	* back-port: 17810 => added cnal to autoidl pile

	* in acq copies display, default to ws lib as recipient lib

2010-09-19  phasefx

	* Make sure offline interfaces correctly load printer settings
	  outside of logins. Some refactoring

2010-09-19  erickson

	* back-port: 17817 => for large sets of holds, usually around 10 or
	  more, the holds display takes a little too long. instead of
	  collecting them all and sorting them by queue position, slot them
	  into the display table (by queue position) as they arrive

2010-09-19  phasefx

	* remove redundant invocation of custom.js, and tweak how menu.js
	  loads it

2010-09-19  senator

	* Backport r17821 from trunk: delay acq provider loading

2010-09-20  senator

	* Backport r17823 from trunk: acq po and invoice interfaces

	* Backport r17825 from trunk: changing "Picklist" to "Selection
	  List"

2010-09-20  dbs

	* Backport r17827 from trunk: Search for humans: AND and OR are
	  more understandable than "&&" and "||"
	  
	  The operators && and || will not mean much to many people,
	  whereas AND and
	  OR have common meanings that will aid in understanding the
	  advanced search
	  interface.

2010-09-20  senator

	* Backport r17829 from trunk: actions menu to ordinary select in li
	  table

	* Backport r17831 from trunk: holding code miniwizard

2010-09-20  gmc

	* marc_add_ids - better failure recovery
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-20  erickson

	* back-port: 17836 => addd missing opac_visible col and labels to
	  config.usr_setting_type

2010-09-20  phasefx

	* merge r17838 from trunk, change to stat cat display in horizontal
	  patron summary

2010-09-20  senator

	* Backport r17840: misspelling fixing

2010-09-20  scottmk

	* Resolving various discrepancies between an upgraded 2.0 database
	  and a freshly installed one.
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

2010-09-20  erickson

	* back-port: 17844 => added pgpt class to pre-load set

2010-09-20  miker

	* Backport BibTemplate callback support from trunk

2010-09-20  senator

	* Backport r17848 from trunk, sort of
	  
	  In rel_2_0, one of these permissions was already there, and the
	  IDs are
	  different, but this should be functionally equivalent.

2010-09-20  gmc

	* add missing upgrade script for maintain_901() stored function
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-20  senator

	* Backport r17853 from trunk

2010-09-21  dbs

	* Backport r17855 from trunk: Use verbose parameters for createdb
	  
	  Thomas Berezansky noticed that the README was using "createdb -t
	  template0",
	  which isn't a valid option. To avoid case problems and to be more
	  apparent
	  what these options mean, let's use the verbose parameters.

	* Merge r17587 and r17588 from trunk to add $0 control subfields
	  for newly controlled fields
	  
	  In the MARC editor, when editing a bibliographic record and
	  right-clicking on
	  a controllable subfield, the "Create new authority from this
	  field" options
	  now both add a $0 control subfield to the target bib field once
	  the new
	  auth record has successfully been created.

	* Backport r17860 from trunk: Clean up description of ARN in
	  O:A:Cat::Authority now that arn_value is gone
	  
	  A comment in the create_authority_record_from_bib_field() method
	  stated that
	  the ARN value needed to be unique across the database; that is no
	  longer true
	  as of r17722. Fix comment accordingly.

2010-09-21  gmc

	* backport r17862 and r17863 from trunk
	  
	  Two new internal_flags to improve parallel bib ingest.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-21  scottmk

	* Correct various discrepancies, especially in the auditor schema,
	  between a freshly installed 2.0 database and an upgraded one.
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

2010-09-21  phasefx

	* merge r17867 from trunk for HoldIsCancelled action_trigger
	  validator

	* merge r17869 from trunk for offline printer role

2010-09-21  scottmk

	* Resolve some discrepancies in the auditor schema between a
	  freshly installed
	  database and an upgraded one.
	  
	  A
	  Open-ILS/src/sql/Pg/upgrade/0413.schema.upgrade-auditor-tables.sql

	* Don't update history tables to fill in new columns
	  
	  M
	  Open-ILS/src/sql/Pg/upgrade/0413.schema.upgrade-auditor-tables.sql

	* Don't make new auditor columns NOT NULL, or update them
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

	* Replace some changes that had inadvertently been deleted
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

2010-09-22  phasefx

	* merge r17879 from trunk to increase timeout for full pull list
	  call

	* handle null as a return result for an empty list

2010-09-22  dbs

	* Forward port r17847: Make query parser a bit more careful when
	  converting convenience classes to search classes
	  
	  Queries like "Heart disease: a global problem" were getting
	  converted to series searches
	  due to the trailing "se:" in the search terms. This change
	  ensures that the convenience
	  class is either at the start of the input or preceded by
	  whitespace.

2010-09-22  scottmk

	* In acq.fund_transfer: drop the NOT NULL constraint from dest_fund
	  and
	  dest_amount, in order to accommodate deallocations -- where we
	  move
	  money out of a fund without moving it into another fund.
	  
	  This change was applied via upgrade script # 0135, but apparently
	  was
	  never applied to the base installation script.
	  
	  M Open-ILS/src/sql/Pg/200.schema.acq.sql

	* For action.circulation and action.aged_circulation: add indexes
	  on the target_copy column.
	  
	  This change was made in upgrade script # 0017, but was apparently
	  never applied to the base install script.
	  
	  M Open-ILS/src/sql/Pg/090.schema.action.sql

	* Adding a trigger. Upgrade # 0364 created the trigger function but
	  not
	  the trigger itself. However the base install script
	  040.schema.asset.sql
	  creates both the function and the trigger.
	  
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  A
	  Open-ILS/src/sql/Pg/upgrade/0414.schema.call-number-upd-ins-trigger.sql

2010-09-22  phasefx

	* merge r17892 from trunk for holdings maintenance fix allowing
	  volumes at top of org tree

	* merge r17894 from trunk to fix bug in Item Status -> Alternate
	  View for items with no circ modifier

	* merge r17896-17897 from trunk for printing fixes

2010-09-23  senator

	* Backport r17899 from trunk: fix a pull list sorting issue

	* Backport r17901 from trunk: IDL chunking fixin'

2010-09-23  miker

	* Backport r17903 from trunk: only flesh up to, but not including,
	  the leaf for the group_field

2010-09-23  dbs

	* Backport r17906: Remove most UI annoyances from authority
	  management interface
	  
	  * term input field now gets the focus automatically
	  * pressing enter in most places submits a new search
	  * removed the onBlur event as that required users to click a
	  second
	  time to open the action menu

	* Browse through 20 authority records at a time in management
	  interface
	  
	  The default browse list is set to 9 elements, but we have enough
	  vertical
	  space to make use of more. Perhaps we should check the font size
	  and
	  viewport height and then adjust accordingly, but that would be
	  Hard.

	* Remove most annoying UI "feature" of the new authority browse
	  list interface
	  
	  When I added the new authority browse list interface, I used
	  dojo.xhrGet()
	  to retrieve records from the authority browse backend - but
	  because I didn't
	  specify sync:true, when you first right-clicked on a subfield,
	  the function
	  would return immediately and default to showing the context menu.
	  You would
	  then need to click two more times to show the authority list.
	  
	  Now you get it on your first right-click, as it should be.

2010-09-23  scottmk

	* Dropping and recreating a foreign key constraint for
	  config.metabib_field,
	  in order to change its name. WHen this foreign key was first
	  introduced,
	  the upgrade script gave it one name and the base install script
	  gave it
	  a different name. Here we bring the names into sync.
	  
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  A
	  Open-ILS/src/sql/Pg/upgrade/0415.schema.rename-field-class-fkey.sql

2010-09-23  miker

	* Forward-port of a patch from Steve Callendar, via James Fournie,
	  via launchpad:
	  
	  When the patron.password.use_phone is set, new patrons are
	  created with their password set to the last 4 digits of their
	  phone number, HOWEVER, when a
	  patron's password is reset, it does not work properly. Although
	  the little underlined summary shows the proper 4 digits, the
	  password box displays 9-
	  ish digits, and is not the last 4 digits of the password.
	  
	  The attached patch was created by Steve Callender and is
	  confirmed working on 1.6.0
	  
	  ORIGINAL CAVEAT: This patch will not work on 2.0 as that has a
	  new user editor, but it would presumably be worthwhile to verify
	  this functionality wor
	  ks in that editor as well.
	  
	  ED NOTE: Because it is possible to use the old editor -- it still
	  exists -- this patch should be applied. It does what it
	  advertises to do, which is
	  fix the old editor to follow the "use phone number" OU setting.

	* Merging r17905 and r17914 from trunk: A/T transaction semantics
	  fixes
	  
	  r17905: Use a transaction to avoid talking to a replicated db
	  when building A/T data structures
	  r17914: In EventGroup.pm, fetch updated event back from the R/W
	  db before comitting

	* Backport r17912 from trunk: Have the CStoreEditor grow a DESTROY

	* Backport r17913 from trunk: event firing util code needs to run
	  in a xact

2010-09-23  phasefx

	* disable holds Detail View button until the asynchronously loading
	  details UI is ready

2010-09-23  scottmk

	* Resolving various discrepancies between a freshly built 2.0
	  database and an upgraded one.
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

2010-09-23  erickson

	* repaired search call for user_setting. cstoreeditor uses the
	  fieldmapper name, sos/usr/user/

2010-09-23  senator

	* Backport r17933 from trunk: unneeded comma removed to placate IE

2010-09-23  erickson

	* I can has authoritative for selfcheck receipts

2010-09-23  miker

	* Backport r17939 from trunk: Stopping the leak

2010-09-24  senator

	* Backport r17941 from trunk: miker's permacrud authoritative
	  search

2010-09-24  scottmk

	* Apply some fixes that were earlier applied to the base
	  installation script
	  090.schema.action.sql, but not in an upgrade script.
	  
	  Also: correct a typo (INTEVAL -> INTERVAL). Hence this upgrade
	  needs to go
	  to v2.0 as well as to trunk.
	  
	  M Open-ILS/src/sql/Pg/090.schema.action.sql
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  A
	  Open-ILS/src/sql/Pg/upgrade/0418.function.action.fix-purge-circ.sql

2010-09-24  miker

	* Backport r17946 from trunk: use _session_request in RO calls

2010-09-24  phasefx

	* We're starting to get events where ilsevent == empty string now,
	  not just null or a number.

2010-09-24  senator

	* Backport r17950 from trunk

2010-09-24  phasefx

	* this call returns an array; fixes surprise stat cats in patron
	  display

2010-09-24  gmc

	* improve hold targetting
	  
	  * all potential capturable copies are now checked (up to the
	  first
	  one that is permitted for the request), instead of a small random
	  subset of them
	  * don't do redundant permission checks
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-24  phasefx

	* merge r17958 from trunk for patron display juvenile CSS

2010-09-24  miker

	* Backporting hold queue stats fixes from 17956, 17957 and 17963

2010-09-24  phasefx

	* spawn item attribute editor instead of item notes UI during
	  process missing pieces workflow

2010-09-24  miker

	* Backport r17972 from trunk: removed extra {}s from where clause

2010-09-24  senator

	* Backport r17974 from trunk

2010-09-24  gmc

	* backport 17976 from trunk
	  
	  Remove confusing older targeter version; move status trimming to
	  earlier in the process --miker
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-24  erickson

	* clean up the fire_object_events cstore xact

	* more transaction cleanups

2010-09-25  senator

	* Backport r17982 from trunk

	* Backport r17985

2010-09-25  erickson

	* events don't have granularity's. removing

2010-09-25  senator

	* Backport r17989 from trunk

	* Backport r17992 from trunk: misplaced paranoia

2010-09-26  gmc

	* don't leak cstores if CStoreEditor rollback fails
	  
	  Patch by Mike Rylander.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* more selfcheck receipt transaction hackery
	  
	  Instead of having authoritative versions of
	  open-ils.circ.fire_*_trigger_events, wrap just the
	  target retrieval itself in a transaction. Avoids as
	  yet unexplained rollback failure that occurs if
	  processing a selfcheck receipt with more than a few items on it.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-26  phasefx

	* make address_type required in the patron editor, otherwise a
	  blank value sends a null to the db where it silently fails

2010-09-26  miker

	* Backport r18007 from trunk: allow more complex facet ordering

	* Backport r18009 from trunk: Only show facetOrder limited facets
	  that have values

2010-09-26  gmc

	* added missing columns to CDBI table definitions
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-26  dbs

	* Remove a debugging statement that slipped in

2010-09-26  erickson

	* backport 18015 : push copy location order update into ML method.
	  return updated orders from method to prevent replication issues.
	  update UI JS to match

	* backport 18016: no need to warn when emails may just be disabled

	* backport 18017: honor SIP return date as the circ backdate

2010-09-27  gmc

	* avoid multiple clicks of selfcheck logout link
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-27  scottmk

	* Resolve differences between stored procedures in a freshly
	  installed
	  2.0 database and those in an upgraded one.
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

2010-09-27  miker

	* Backport r18025 from trunk: Provide for limiting the number of
	  classOrder elements to a specific number. Skips those without
	  facet values.

	* Backport r18027 from trunk: Adjust hold-to-record view to cover
	  I, F and R hold types

2010-09-27  phasefx

	* since we're enforcing the requiredness of address type, let's
	  give it a default value (since empty strings don't work with
	  these widgets)

	* accidental change in previous commit. long term plan here is a
	  'slip' printer role

	* merge part of r18002, and all of r18003 and r18004 from trunk for
	  persistent/sticky slider positions and window sizes

2010-09-27  miker

	* Backporting r17984 from trunk: pedantic protection of cstore
	  backends -- always use die_event when in xact mode, and rollback
	  otherwise

	* Backport r18034 from trunk: use transaction when gathering
	  records from a newly created queue; adjust rollback usage in
	  import loop

2010-09-27  erickson

	* backporting some xact management fine tuning

2010-09-27  gmc

	* fix default path to selfcheck sounds
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-27  miker

	* Backporting 18039 from trunk: make pubdate sorting on search
	  faster by pre-munging date1 and date2 into an acceptable sortkey

	* Backport r18041 from trunk: Correct the subquery for A/T
	  opt_in_setting

	* missed in the previous commit, sorry folks

2010-09-27  gmc

	* fix glitch in hold target OU weighting
	  
	  We want to weight by the copy's circulation library, not the
	  pickup library.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* fix another hold targeting glitch
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* adjustments to pubdate sorting patch
	  
	  * handle upgrade for date1/date2 containing the empty string
	  * syntax error fix
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-27  senator

	* Backport r18051: fix a glitch with the granularity column of the
	  event def UI

2010-09-27  scottmk

	* 1. Turn some ints into bigints.
	  
	  2. Rename the uniqueness constraint for booking.resource_type.
	  
	  M Open-ILS/src/sql/Pg/090.schema.action.sql
	  M Open-ILS/src/sql/Pg/200.schema.acq.sql
	  M Open-ILS/src/sql/Pg/012.schema.vandelay.sql
	  M Open-ILS/src/sql/Pg/095.schema.booking.sql
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  M Open-ILS/src/sql/Pg/070.schema.container.sql
	  A Open-ILS/src/sql/Pg/upgrade/0421.schema.embiggen-ints.sql

2010-09-28  atz

	* Utility for ISBN10->ISBN13 upconversion

	* Script is executable

	* edi_translator sample EDI/JEDI docs
	  
	  EDI test and sample data
	  
	  Ingram ORDRSP that fails translation

2010-09-28  dbs

	* Use quoted attribute values to make Firefox / XULRunner happier
	  about dojo queries
	  
	  The unquoted values in BibTemplate and the OPAC detail template
	  were generating
	  mucho noise in the JavaScript console; this hushes it up nicely.

2010-09-28  atz

	* For edi_translator on RHEL
	  
	  Note: RubyGems 1.3.4 is not available anymore

	* Fix POD for RemoteAccount

	* Minor cleanup

	* typo in POD

2010-09-28  scottmk

	* Turn an int into a bigint in acq.acq_lineitem_history, following
	  up on
	  a similar change to acq.lineitem.
	  
	  M Open-ILS/src/sql/Pg/002.schema.config.sql
	  A
	  Open-ILS/src/sql/Pg/upgrade/0422.schema.acq.lineitem-history-bigint.sql

	* Incorporate several recent upgrade scripts, through # 0422.
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

2010-09-28  miker

	* Backport r18077 from trunk: add support for the null() xpath
	  function, which works in pgxml (AKA xml2) but not in the builtin
	  XPATH function for 8.3+

2010-09-28  dbs

	* Change memcached default location to 127.0.0.1 from localhost
	  
	  Debian Squeeze currently doesn't fare well with memcached servers
	  pointing to
	  localhost and needs an explicit 127.0.0.1, whereas Ubuntu Lucid
	  is happy with
	  either. Changing the default here means one less possible gotcha
	  in the out
	  of the box install & configure experience for Debian Squeeze
	  folk.

2010-09-28  phasefx

	* this breaks (hides) the buttonbar in windows. Sorry James, miker

2010-09-28  erickson

	* repaired logic bug in lineitem worksheet template

	* backport 18084: sip override checkins, bug fixes

	* for troubleshooting, log the size of the template output to be
	  stored

2010-09-28  senator

	* Backport r18089 from trunk. A/T feature.

2010-09-28  miker

	* Backport r18091 from trunk: move the early-out response so we
	  avoid breaking the caller

2010-09-28  phasefx

	* Delete all cookies on logoff. There's dojo code that looks for
	  stale session cookies and has the xul client prompt for a new
	  session. When you logoff, the session is destroyed, but the stale
	  cookies were being left behind (and not overwritten on login? I
	  don't understand that part). But this fixes it

2010-09-28  miker

	* Backport r18095 from trunk: Use transactions everywhere in
	  Vandelay

2010-09-29  miker

	* Backport r18097 from trunk: Process item imports during record
	  import, not as a secondary call (never should have worked, but
	  for transaction timing)

	* Backport r18099 from trunk: support per-grunlarity parallelizing
	  via flag and lock file

2010-09-29  gmc

	* reporter: don't try to write Excel formulas
	  
	  Any cell value that starts with = is now always written
	  as a text cell in spreadsheet output. Avoids a possible
	  exploit as well as errors like this:
	  
	  Couldn't parse formula: = at /openils/bin/clark-kent.pl line 429
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* fix FM type of reporter.report.data
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-09-29  phasefx

	* merge r18106 from trunk for needless auth prompting

2010-09-30  dbs

	* Merge r18076 from trunk: Make authority validation rules match
	  authority ingest rules for better matches
	  
	  This resolves a problem in
	  O:A:Storage:Publisher:authority:validate_tag() where
	  the full NACO normalization rules that are applied to the
	  subfields of the
	  authority records when they are ingested into authority.full_rec
	  are not similarly
	  applied to the incoming subfields of the bib field that is being
	  validated;
	  only diacritic characters in the bib field subfields were being
	  normalized.
	  
	  Now we apply naco_normalize() to the search terms so that they
	  will match
	  the ingested form of the authority record.

2010-09-30  erickson

	* fire the hold_request.cancel.staff when hold is cancelled by
	  staff

2010-10-01  dbs

	* Add serial.record_entry to CDBI definitions
	  
	  Better late than never; never added the serial.record_entry
	  CDBI definitions in the 1.6 series, but as that table can
	  still be active in 2.0 we might as well get it in place.

	* Teach marc_export script how to export MFHD serial records
	  
	  Passing the --mfhd flag will export any non-deleted MFHD records
	  in
	  serial.record_entry associated with each bib ID. So, for a
	  hypothetical set of
	  bib IDs 1, 2, 3, where 2 has no associated MFHD records and 3 has
	  2 MFHD records
	  associated with it, the output will be structured as follows:
	  
	  Bib MARC for bib ID 1
	  MFHD MARC for bib ID 1
	  Bib MARC for bib ID 2
	  Bib MARC for bib ID 3
	  MFHD MARC for bib ID 3
	  MFHD MARC for bib ID 2

2010-10-01  phasefx

	* tweak remoteauth.cgi to offer usrname and barcode params in
	  addition to user. user param now looks for the opac.barcode_regex
	  org unit setting to determine whether the value is a usrname or
	  barcode. change double-quotes to single-quotes if we're not doing
	  string interpolation. change apache instructions for
	  configuration

2010-10-01  atz

	* Silence warning
	  
	  Warnings was:
	  Use of uninitialized value in subroutine entry at
	  /openils/lib/perl5/OpenILS/SIP/Patron.pm line 230.
	  
	  Signed-off-by: Joe Atzberger <atz@esilibrary.com>

2010-10-01  phasefx

	* use an opac login here, which doesn't require the STAFF_LOGIN
	  permission by default

2010-10-01  senator

	* Backport r18124 from trunk: another pull list printing pathway

2010-10-01  dbs

	* Set due times for durations measured in days to 23:59:59 after
	  inserts OR updates
	  
	  The existing trigger acted only on the initial insert of a
	  circulation
	  transaction for duration intervals perfectly divisible by 24
	  hours.
	  If updates to those due dates were subsequently issued, then the
	  due
	  time would revert to 00:00:00 - which could cause surprising
	  overdue
	  fines to be generated on the due date, rather than after the due
	  date.
	  
	  This commit makes the trigger take effect on both INSERT and
	  UPDATE
	  to the action.circulation table.

2010-10-01  senator

	* Backport r18130 from trunk

2010-10-02  miker

	* Backporting r18123 from trunk: Implement a process-local cache
	  for event target fleshing -- particularly helpful with large
	  event groups

	* Backportin r181323 and r18133 from trunk: Massive search
	  core-query speed improvement.
	  
	  * Only compile the tsquery once
	  * Use direct ids instead of going back to the db udring a queyr
	  * Change a remaining CASE to COALESCE/NULLIF

	* Backporting r18136 from trunk: configurable chunking of the holds
	  stream to avoid the xulrunner "I forgot the chunked stream"
	  problem

2010-10-03  scottmk

	* Incorporate upgrade scripts 0423 and 0424
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

2010-10-04  miker

	* Backport r18140 from trunk: moved the cache clear to later in the
	  firing to pick up data; fixed some typos/thinkos

	* Backport r18141 from trunk: Allow caller to ignore selected facet
	  classes; ignore identifier class by default

2010-10-04  senator

	* Backport r18148 from trunk: fix pull list retrieval bug for alt
	  pull list print

2010-10-04  erickson

	* fixed typo in vandelay merge profile permission check

2010-10-04  senator

	* Backport r18158 from trunk: patron alias column in some holds
	  interfaces

2010-10-04  dbs

	* French translation of password reset form and prompts at
	  /opac/password/fr-CA/

2010-10-05  erickson

	* avoid running activated hook when in dry run mode

2010-10-05  gmc

	* make it easier to grep for bib search durations from the Pg log
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-10-05  phasefx

	* merge r18169 from trunk for CSS hooks

2010-10-05  atz

	* EDI job POD

	* Add title to PO view page.

2010-10-05  senator

	* Backport r18175

2010-10-05  atz

	* The whole point of test mode, NOT actually committing actions.

2010-10-05  phasefx

	* be quiet with errors retrieving remote column settings

2010-10-05  gmc

	* hold matrix selection: treat root OU as just another OU
	  
	  Treat the root OU as just another OU for the purpose of
	  calculating OU proximity adjustments when selecting a
	  matchpoint.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-10-06  miker

	* Backport r18187 from trunk: Add a retargetting specific version
	  of the hold-permit function which skips user tests

	* Backport r18188 from trunk: usr_grp is entirely unused currently;
	  hide it

2010-10-06  erickson

	* first level of groups hash can be array or hash, leading to
	  breakage; for now, keep it simple and return continue-status to
	  keep the caller alive

2010-10-06  miker

	* Backport r18195 from trunk: Make retargetting check less lax by
	  including appropriate patron-side test

2010-10-06  erickson

	* suppress usr_grp field in hold matrix matchpoint; see also 18188

2010-10-06  scottmk

	* Backporting a syntax correction; SQL functions cannot reference
	  their parameters by name.
	  
	  M Pg/upgrade/0428.schema.hold_retarget.sql
	  M Pg/110.hold_matrix.sql

2010-10-06  phasefx

	* hold/transit slips may want to use stat cats as well

2010-10-06  erickson

	* avoid retreiving/searching a linked object, when there is no
	  object to retrieve (i.e. ident value is null) and silence various
	  warnings by skipping this scenario. mild variable refactor for
	  easy reading for feeble eyes.

2010-10-06  scottmk

	* Incorporate upgrades 0427 and 0428 into the consolidated upgrade
	  script.
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

2010-10-06  miker

	* Backport spackling from trunk: db upgrade script dislikes holes
	  -- spackle this one

2010-10-06  senator

	* Backport r18215 from trunk: alternate printing for expired holds
	  shelf lists
	  
	  This is slim so that it supports bigger datasets than the usual
	  interface for
	  this. Needs improvment: make the template more customizable

2010-10-06  atz

	* Warn but continue on skipped upgrade revs.

2010-10-07  phasefx

	* merge r18220 from trunk for %destination_shelf% macro in hold and
	  hold/transit slip templates

2010-10-07  senator

	* Backport r18222 from trunk: reasonable default sorting for
	  expired holds list

2010-10-07  atz

	* EDI template update for ORDERS
	  
	  This template produces JSON for the edi translator to convert
	  into
	  actual EDI lines. It now handles vendor-specific requirements for
	  account and sub-account identification, and also transmits notes
	  of the vendor-public variety as FTX segments in the lineitem.

2010-10-07  senator

	* Backport r18226 from trunk

2010-10-07  gmc

	* choose the hold permit test variant correctly
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-10-07  senator

	* Backport r18230 and 18231, hold shelf clearer/printer

2010-10-08  gmc

	* do not apply superpage limit inside bib search joins
	  
	  Oddly, empirical evidence suggests that this might actually
	  be faster, and if this pans out, search results will definitely
	  be more complete.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-10-08  dbs

	* Avoid scary SSL / HTTPS errors in Apache configuration
	  
	  When port 443 is the last listener port, Apache generates lots
	  of "unknown protocol speaking not SSL to HTTPS port!?" errors in
	  the logs - which are scary, but harmless. Putting port 80 last
	  avoids those errors entirely, per
	  http://wiki.apache.org/httpd/InternalDummyConnection

2010-10-08  phasefx

	* moving users in and out of groups produced dialogs that expected
	  vertical patron summaries. this fixes that

	* fix logic error where we were just testing for the presence of a
	  user setting instead of its value

2010-10-08  senator

	* Backport r18249 from trunk: clear hold shelf work even on
	  brokenish holds

2010-10-08  phasefx

	* typo

2010-10-08  erickson

	* mild fixes for a/t interface admin interface. sort by def name
	  instead of hook, which probably makes more sense to a human. hide
	  the opt-in and max-delay columns to free up some badly needed
	  horizontal space. use percentage width for name column, which
	  acts a lot like 'auto', but allows the user to manually resize

2010-10-11  erickson

	* wait to run-pending if a specific granularity used

2010-10-11  atz

	* Tighter verbose format for skipped POs

2010-10-11  phasefx

	* initialize these lists just once to prevent display glitch

	* avoid race condition with post-save patron editor refresh and
	  replicated databases

2010-10-12  scottmk

	* Incorporate upgrade # 0433 into the consolidated upgrade script.
	  
	  M Open-ILS/src/sql/Pg/1.6.1-2.0-upgrade-db.sql

2010-10-12  atz

	* Be sure to copy new JS files from OpenSRF on a FULL
	  update/install

2010-10-12  miker

	* Backporting MARC js fixes from trunk

2010-10-13  miker

	* thinko supporting multiple rules of the same type in in-line
	  merge rulesets

2010-10-13  erickson

	* clean up duplicate system-controlled penalties during penalty
	  calculation; perform penalty trigger event creation after the
	  standalone commit occurs. todo, handle non-standalone post-commit
	  penalty trigger event creation

2010-10-13  scottmk

	* Change the treatment of ORDER BY. Except as noted, these changes
	  apply only to methods other than json_query.
	  
	  1. Allow the use of array syntax for specifying an ORDER BY
	  clause
	  as an array of field specifications, such as can be used in
	  json_query.
	  The older syntax, using a hash based on class name, is still
	  available.
	  
	  2. For json_query, using the array syntax: relax the requirement
	  that a
	  class be in scope. A field from an out-of-scope class will now be
	  silently ignored. This change avoids certain problems with
	  fleshing
	  queries, which use the same order_by array at multiple levels.
	  
	  3. For the hash syntax: relax the requirement that the class be
	  referenced in the SELECT clause. Now it suffices that it be in
	  scope in the generated SQL. As a result, you can now sort by a
	  column in a joined class without artificially including that
	  column
	  in the SELECT list.
	  
	  4. When all or part of an ORDER BY clause is expressed as a
	  string
	  literal: require that the string not contain any semicolons, in
	  order
	  to block certain kinds of SQL injection. This measure could
	  create
	  problems if a semicolon appears within a quoted string -- which
	  is
	  possible in theory but highly improbable in practice.
	  
	  5. Don't include a virtual field in an ORDER BY clause. If one is
	  specified, silently ignore it.
	  
	  M Open-ILS/src/c-apps/oils_sql.c

2010-10-14  phasefx

	* change the Swap Editor button to a persisted checkbox

2010-10-14  miker

	* correct top-half ordering by label_sortkey

	* patch from Steve Callendar to avoid resetting the passwd every
	  time a phone number changes

	* cast label_sortkey to bytea in order to get ascii-betical sorting
	  in any locale, even C. stupid glibc ...

	* backward compat indexing for label instead of label_sortkey

	* "as" not "to" ... you pointed that out the first time, miker,
	  what is your deal?

	* upgrade version number fix

2010-10-14  erickson

	* Back-porting a number of action/trigger fixes from trunk:
	  
	  parallel collection and reaction with multisession
	  cut down xact begin/rollbacks to reduce call overhead during
	  collection
	  force granularity-only when running w/ --granularity

	* If an item is captured for a hold, but not in transit (i.e. on
	  holds shelf), set the destination_location equal to the pickup
	  library (i.e where it's supposedly on the shelf). This is useful
	  for autmated sorting so that the item will return to the branch
	  whose shelf where it belongs.

2010-10-15  gmc

	* tweak expanding search field aliases
	  
	  Avoids a glitch that can occur if a search field alias
	  exists that happens to have the same name as a search field.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-10-15  miker

	* Poked by scottmk to incorporate 0438 into the 1.6.1-2.0 upgrade
	  script. This may duplicate effort if one is already on 1.6.1.3+
	  (when it exists) but there is no harm in it either.

2010-10-16  miker

	* Backporting r18364-r18366 from trunk: use a function to wrap up
	  escaping of solidus and casting to bytea, propogate to indexing
	  and where/order_by

2010-10-18  phasefx

	* merge r18374-18375 from trunk for bill receipt fixes

	* make Circulation -> Enter Offline Interface open a new window
	  instead of a tab, like the button from the login window. This
	  works around a permission issue with loading the offline receipt
	  templates

	* stop sign page was incorrectly coming up for all penalties

2010-10-18  dbs

	* Protect biblio.extract_located_uris() from a NULL uri_use value
	  by using the href as a fallback
	  
	  If an 856 field contained a subfield "9" but did not contain a
	  subfield
	  "z", "2", or "n", then ingest of the MARC record would fail as it
	  attempted
	  to retrieve an asset.uri row where uri_use = NULL - which was
	  never true.
	  
	  This change adds the subfield "u" to fall back to for the uri_use
	  variable,
	  just like we do for the uri_label variable, and prevents ugly
	  ingest errors
	  from getting thrown back at the client.

2010-10-18  senator

	* Backport r18384 from trunk: serials previous issue copy location
	  moving

	* Backport r18386 from trunk, asset.copy_template editing
	  improvement

2010-10-18  gmc

	* fix mapping of the crossed D character in naco_normalize
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* update 1.6.1 to 2.0 upgrade script for 0441
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-10-19  miker

	* expand the scope of BT on the result list page, allowing simpler
	  slots

2010-10-20  miker

	* Backporting r18396 from trunk: Patch from Thomas Berezansky
	  providing an alternate implementation of Hard Due Dates

2010-10-20  erickson

	* during checkin, an item's hold may have a fleshed pickup_lib.
	  added code to detect and protect against treating a ref as an ID.
	  minor cleanup

2010-10-20  senator

	* Backport r18407 from trunk: alt serials interface tweak

2010-10-20  dbs

	* Prevent "Validate" from matching against deleted authority
	  records
	  
	  2.0 introduces the ability to delete authority records. The
	  routines in
	  OpenILS:Application:Storage:Publisher:authority check for
	  matching values
	  of authority.full_rec without concern about whether the
	  corresponding
	  entry in authority.record_entry has been deleted or not.
	  
	  This change removes entries from authority.full_rec when an
	  authority.record_entry row is deleted, with the (possibly
	  incorrect)
	  assumption that there won't be many cases where users will want
	  to
	  search for deleted authority records and undelete them. If that
	  assumption turns out to be incorrect, then further changes can
	  follow;
	  this change at least makes the current behaviour for user-visible
	  actions work as expected.

2010-10-20  miker

	* 1.6.1-2.0 upgrade script needs to fall in line with reality, re
	  0442

2010-10-20  senator

	* Backport r18414 from trunk

	* Backport r18416 from trunk: a/t use rstore to flesh if cstore not
	  available

2010-10-20  miker

	* Patch from tsbere to address backporting issue of hard due dates
	  patch against trunk (also, get rid of 3-space indentation..)

2010-10-20  senator

	* Backport r18419 from trunk: supercat bugs on records with serials
	  data attached

	* Backport r18421 from trunk

2010-10-20  phasefx

	* don't allow inactive cards with web-selfcheck

2010-10-20  miker

	* add start_date and end_date to scap serialization

	* These fields exist ... tell the IDL about them

2010-10-20  erickson

	* added some time diagnostics to checkin process; more org unit
	  caching; do less user fleshing on hold user during checkin (only
	  card and name is needed)

2010-10-20  gmc

	* use a transaction when searching for the nearest hold request
	  
	  Solves the following problem in a setup that uses Slony - if
	  multiple items that can fulfill the same hold are checked
	  in one after another, occassionally two items will end up
	  being put in transit for the same hold request.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-10-21  gmc

	* improve call number sorting
	  
	  oils_text_as_bytea now does uppercasing in addition
	  to converting strings to bytea, working around
	  the limitation that json_query can't stack transforms
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-10-21  phasefx

	* ilsevent is no longer a number, but a string. I knew that, but
	  missed this test

2010-10-21  senator

	* Backport r18442 from trunk, autogrid cut-off tweak

2010-10-22  miker

	* Move dojo loading around to avoid the "white screen of death" in
	  Firefox and xulrunner (See:
	  http://o.dojotoolkit.org/forum/dojo-foundation/general-discussion/firefox-3-fires-domcontentloaded-event-prematurely
	  )

2010-10-22  senator

	* Backport r18448 from trunk, minor acq glitch with view/place
	  orders interface

2010-10-22  miker

	* typo in setTimeout spotted by dbs

	* Use standard JS syntax; var [...] seems to be a Spidermonkey
	  extension

2010-10-22  erickson

	* further protection against dreaded opac bank page; wrap
	  settimeout redetail bibtemplate loading in an onload to ensure it
	  runs after dojo onload events

2010-10-25  miker

	* Dump some debugging output from clark; may later make this
	  optional, but we usually need it when looking for the cause of
	  problems.

	* Backport r18462-r18463 from trunk: Remove some connectby() uses
	  and update upgrade script

	* quickly, before anyone notices ... minor speed enhancement (aka,
	  thinko)

2010-10-25  phasefx

	* Floating field in alternate item details UI

2010-10-26  miker

	* include more information in the debugging dump; correct the "back
	  to index" link

2010-10-26  gmc

	* fix NACO normalization of four letter modifier characters
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-10-26  senator

	* Backport r18480 from trunk: copy template editor bugfix

2010-10-27  phasefx

	* View Source option for embedded browser (click on the Debug link)

2010-10-27  gmc

	* fix glitch in escaping call number labels
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-10-27  senator

	* Backport r18489 from trunk: distribution formula UI paging

2010-10-27  erickson

	* added grid autoHeight to distrib formula page to prevent the grid
	  from consuming the whole page

2010-10-27  gmc

	* remove unused settings and permission
	  
	  circ.holds.alert_if_local_avail and
	  circ.holds.deny_if_local_avail
	  are redundant; circ.holds.hold_has_copy_at.{alert|block} are the
	  settings that will actually be used. Also remove a related,
	  redundant permission.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-10-27  senator

	* Backport r18502 from trunk: make booking avoidable in circ
	  service (speedup!)

2010-10-27  miker

	* Backport of r18494, r18500 and r18501 from trunk: split fine
	  generation

2010-10-27  erickson

	* since they typically repeat, cache the org and requestor objects
	  in the permit loop of the find-best-hold calculation

2010-10-27  miker

	* Move towards unnest (faster than explode_array); bring upgrade
	  script up to speed

2010-10-27  erickson

	* more micro-optimization of checkin code; protect against undef
	  var warning in info message; removed unused sub

2010-10-27  senator

	* Backport r18514 from trunk, more circ speedups when booking not
	  in play

2010-10-28  dbs

	* Backport r18516: Ensure call numbers are returned to the holdings
	  editor in ascending sorted order
	  
	  James Fournie in https://bugs.launchpad.net/evergreen/+bug/635121
	  reported
	  that call numbers were being displayed in the order that they had
	  been
	  added to the database, rather than in sorted call number label
	  order.
	  
	  Although I have been unable to reproduce this problem on two
	  different
	  test systems, the patch he provided for 1.6.1 (which fixes the
	  problem on their
	  test system) shouldn't hurt other systems.
	  
	  For sortkey-aware branches, I modified James' patch to take
	  advantage of the
	  asset.call_number.label_sortkey column and the
	  oils_text_as_bytea() function.

2010-10-28  erickson

	* condensed SIP patron lookup by barcode into 1 cstore call;
	  provided option for slimmed-down user object fetching in the case
	  of checkin, where all we really need is the barcode of the user
	  on the circulation

2010-10-28  phasefx

	* backport r18498-18499 from trunk for staff-initiated age overdue
	  circ/item to Lost functionality, with upgrade script

2010-10-28  senator

	* Backport r18530 from trunk: misc alt serials UI minor
	  improvements, tweaks

2010-10-28  erickson

	* calling noop with no arguments (and not capturing the output) is,
	  well, a no-op. set the value to true as originally intended

2010-10-28  gmc

	* wrap some EDI message retrievals in transactions
	  
	  Avoid errors when operating under Slony.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-10-29  gmc

	* loosen cross-check of line item ID when processing incoming EDI
	  messages
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* adjust quoting of phrase searches
	  
	  This has three main effects:
	  
	  * This formalizes the current behavior where a
	  phrase search like
	  
	  title:"^Harry Potter"
	  
	  acts as a left-anchored search and
	  
	  title:"Harry Potter$"
	  
	  acts as a right-anchored search.
	  
	  In particular, this can be useful for constructing
	  searches of bibliographic call numbers.
	  
	  * Other regex metacharacters in phrase searches are
	  now escaped.
	  
	  * Phrase searches like "C++" will no longer crash; in fact,
	  this makes a phrase search currently the only way to
	  accurately retrieve all C++ titles with the usual
	  normalization rules
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-01  gmc

	* let libraries allow funds to be overcommitted
	  
	  The check constraints on the balance warning and
	  stop limits were too strict - a library can validly
	  choose to permit a fund to have a commitment greater
	  than 100% of its allocation
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-01  miker

	* Include copy counts in holdings XML -- I will destroy MVRs yet!

2010-11-01  phasefx

	* syntax

2010-11-01  miker

	* Backport of in-db hold permit improvements from trunk

	* Backport thinko fix for count reporting

	* we should not restrict to the top org only, get all counts

2010-11-01  dbs

	* Ensure that changes to authority records propagate to linked
	  bibliographic records
	  
	  Per https://bugs.launchpad.net/evergreen/+bug/669596, updated
	  authority records
	  weren't being reflected in bibliographic records with fields that
	  link to those
	  authority records. We were missing the call to
	  authority.propaagate_changes()
	  withing the ingest trigger on authority.record_entry.

	* Replace hard-coded '(CONS)' for MARC control number identifier in
	  authority records
	  
	  We created an actor.org_unit_setting,
	  'cat.marc_control_number_identifier', for
	  specifying the preferred MARC control number identifier, but when
	  we create a
	  new authority record from the MARC editor, the hardcoded value of
	  'CONS' is being
	  used.
	  
	  This teaches the staff client how to pull the appropriate value
	  from the AOUS
	  when invoking the MARC Editor.
	  
	  Resolves https://bugs.launchpad.net/evergreen/+bug/669245

2010-11-01  miker

	* Backporting r18561 from trunk: Make vandelay.add_field smarter
	  about applying add rules when no target field exists before hand

2010-11-01  gmc

	* yet another replication race condition fix
	  
	  Fixes problems that can occur when creating a lineitem
	  from an existing bib in the catalog; adds an authoritative
	  version of open-ils.acq.lineitem.retrieve.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-02  dbs

	* Enable merge of authority records to do the right thing
	  
	  The target and source authority record was flipped, causing
	  the update to fail. In reconsidering this function, it is not
	  necessary to change the contents of the source authority record
	  just to propagate the content of the target authority record
	  to any linked bibliographic records.
	  
	  Instead, take the approach of updating the ID of the controlled
	  field in the bib record, then temporarily set "reingest on same
	  MARC" to TRUE and update the target authority record by setting
	  deleted = FALSE (which propagates the "changes" to the linked
	  bib records), then set "reingest on same MARC" flag back to its
	  original value.
	  
	  This has the bonus of actually working.

2010-11-02  erickson

	* in SIP patron retrieval, only fetch non-archived penalties and
	  penalties that that matter (fines, overdues, blocking penalties).
	  pair down the penalty comparisons to avoid fleshing the penalty
	  type, potentially numerous times for a given type, by using the
	  constant identifiers

	* back-porting 18571, 18572. provider fetching updates,
	  autofieldwidget linked class loader

2010-11-02  gmc

	* don't break up title and author when ingesting acquisitions MARC
	  
	  Note that this can be done more cleanly once oils_xpath groks
	  XPATH 2.0 functions, in particular string-join.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* enable authoritative versions of various acq retrieval functions
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* DROP TRIGGER IF EXISTS push_due_date_tgr ON action.circulation;
	  add definition for UPC line item attribute
	  
	  Useful for providers of audiovisual material that
	  don't have ISBNs.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-02  miker

	* Patch from Steve Callender to address a booking-related
	  collection agency reporting problem

2010-11-02  senator

	* Backport r18583 from trunk, fund totals on an invoice voucher

	* Move upgrade to upgrade directory

	* Backport r18535 from trunk: hard due date interfaces

2010-11-03  senator

	* Backport r18589 from trunk: acq invoice voucher fix

2010-11-03  gmc

	* flip sense of spending limit check
	  
	  Testing showed users expecting that the limit would
	  be based on amount spent, not the amount available
	  to send.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-03  miker

	* add the Batch Bib Update module to startup.pl

2010-11-03  gmc

	* blimey

2010-11-04  gmc

	* add TT helper to squeeze strings into the UNOB straitjacket
	  
	  The force_jedi_unob helper strips non-ASCII characters from
	  template output but does so nicely by converting the string
	  to NFD first. This is meant to be used by EDI templates, although
	  could be useful for A/T output that goes to receipt
	  printers that cannot print diacritics.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-04  miker

	* over-aggressive backporting -- only in trunk and 1.6

	* General 2.0b1 cleanup
	  
	  * Problem in vandelay.add_fields spotted by tsbere
	  * Syncing 1.6.1-2.0 upgrade script with reality

	* cut down on reloading of IDL classes

2010-11-04  senator

	* Backport r18606 from trunk: no more Net::uFTP

2010-11-05  phasefx

	* backporting r18609 patch from bshum for catalog search in button
	  bar

2010-11-05  miker

	* remove some extra rollbacks, and catch the failure of others
	  where they may or may not be needed

2010-11-05  gmc

	* fix user password reset request time column def
	  
	  Needs to be a timestamp with time zone; fixes a bug
	  where it was interpreted as a UTC time, throwing off
	  the calculation of the expiration of the password reset
	  request.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-05  senator

	* Backport r18622 from trunk: legacy serials OPAC fix

2010-11-05  gmc

	* remove aupr.request_time fix from 1.6.1-2.0 upgrade
	  
	  Fix also in 1.6.1.3
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-05  phasefx

	* backport r18548, 18564, and 18602 from trunk for opac login form
	  tweaks

2010-11-05  gmc

	* missed database update from password reset fix
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* switch to authoritative methods for various acq retrievals
	  
	  Avoid race condition when using Slony replication
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* #671213: remove extraneous insert from upgrade script
	  
	  Somebody upgrading from 1.6.1 should already have this.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-08  dbs

	* Improve Fedora prerequisite installer
	  
	  * Explicitly install wget, which isn't installed in a minimal
	  install
	  * Hack JavaScript-SpiderMonkey Makefile.PL for 32-bit Fedora
	  * Provide a fedora14 target
	  * Change "fedora-13" to "fedora13" to match OpenSRF prereq
	  installer

	* Add UUID::Tiny to Fedora prerequisites

	* Further Fedora prereq installer tweaks
	  
	  * Install the Perl DBD::Pg module
	  * Force the CPAN modules, as
	  Business::OnlinePayment::AuthorizeNet
	  still suffers from an install-crippling bug

2010-11-08  erickson

	* holds retrieval API call sorting and cleanup; sort non-cancelled
	  holds by ready-for pickup, then active, then suspended; use
	  json_query to fetch IDs first, so id_list calls can avoid
	  fetching the full hold objects in the ML. sort fleshed transit by
	  send time to pick up the latest transit

2010-11-08  miker

	* Backporting r18652: Teach vandelay.replace_field to be a little
	  smarter by allowing simple cases of both replacing and
	  regexp-testing the same subfield

	* 1.6-2.0 upgrade script syncing, re r18652

	* Bacport r18657: syntax problem spotted by Jason Etheridge

	* More fixing related to r18657

2010-11-08  senator

	* Backport r18662 from trunk: don't try to render dropdown of all
	  bib IDs

2010-11-08  miker

	* Backporting IDL bug fixes

2010-11-08  erickson

	* dynamically loaded classes also need access to toHash

2010-11-09  phasefx

	* merge r18675 from trunk for DP_DateExtension removal

2010-11-10  gmc

	* do not use TRUNCATE when refreshing
	  reporter.materialized_simple_record
	  
	  Previous behavior would break Slony replication after doing a
	  bib load. Since a deletion is slower than a truncate, if you're
	  not using Slony replication, you may prefer to truncate rmsr
	  prior to calling
	  reporter.enable_materialized_simple_record_trigger.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-10  miker

	* Move the magic-bib update to the top of the file, avoiding
	  triggers that care about XML namespaces

2010-11-10  senator

	* Backport r18688 from trunk: booking bugfix

	* Backport r18685 and r18691 from trunk: serials-integration work +
	  patch from
	  Dan Wells

2010-11-10  dbs

	* Enable "maintain control numbers" and "record ID as TCN" behavior
	  by default
	  
	  Per http://ur1.ca/2bgc4, this behavior hews more closely to the
	  MARC21
	  specification. Note, however, that duplicate bib detection in the
	  "Import via Z39.50" interface will be somewhat affected; a more
	  trustworthy workaround is to include the "Local catalog" in
	  Z39.50 searches to
	  determine if a matching record already exists in the database.

2010-11-11  dbs

	* Update the edit dates for authority and MFHD records when they
	  are edited
	  
	  Addresses the oversight in the original implementation that
	  missed this;
	  important if we're going to differentiate between creating and
	  editing
	  a record for triggers.

2010-11-11  erickson

	* wraps tips appendChild in try/catch to prevent occaisonal
	  exeptions.

2010-11-11  dbs

	* Do not supply a default value for 003 in new authority records
	  
	  With cat.maintain_control_numbers enabled by default, we can
	  trust
	  the database trigger to create the appropriate 003 for us - and
	  by
	  not supplying a 003 in the new record, we won't create a spurious
	  035 for a brand new record.

	* Avoid munging 035 when a new record is created
	  
	  If there is no 003 in the record when it is created, then we will
	  not attempt
	  to generate a 035. If the incoming record contains a 001 and 003,
	  then we will
	  create a 035.

2010-11-12  phasefx

	* merge r18687 from trunk for cookie library changes

	* ensure that we only fetch this setting once per page

2010-11-12  erickson

	* Back-port of 18712 and related changes: Server-generated IDL JS
	  
	  
	  The goal is to reduce use of pre-onload XHR, which is known to
	  cause
	  problems (dreaded white-screen-of-death) in firefox/xulrunner.
	  Change
	  allows opac, staff client, and embedded browser interfaces to
	  load
	  a pre-formatted JS object instead of IDL XML via XHR. In addition
	  to
	  dropping the XHR, clients no longer parse the XML, which should
	  reduce
	  page render time. Finally, in the staff interfaces, the full IDL
	  is
	  once again loaded, so there is no need to specifiy per-page
	  classes.
	  Per-page classes are still supported and used in the OPAC to
	  reduce the
	  up-front load time.
	  
	  Change requires an update to the Evergreen Apache config.
	  
	  Part of this change included condensing fieldmapper.hash and
	  fielmapper.dojoData content into fieldmapper.Fieldmapper to avoid
	  circular dependencies, which was causing problems with IE. Will
	  eventually want to deprecate .hash and .dojoData, but for now
	  they still
	  function as before.

2010-11-12  miker

	* Trim the set of classes and fields pulled in by Searcher; Cache
	  the cmc data (cmf is too big)

	* Cache the language set (per locale) in a cookie

	* Backporting r18686 for great justice (and PCRUD speed)

2010-11-12  erickson

	* in some scenarios, the 'mous' class may not have loaded yet.
	  pre-load the class in myopac init

2010-11-13  dbs

	* Merge translations from Launchpad

2010-11-15  dbs

	* Do not cache the authority context menu
	  
	  Caching would be great, except when you add an authority in the
	  flow and you expect to see it the next time you right-click
	  on the authority that you just added.

	* Fix negative paging issue in
	  open-ils.supercat.authority.author.startwith
	  
	  When paging backwards through authority lists, we were skipping
	  the
	  first page of results. By reducing the offset by the value of one
	  page, we restore the expected order.
	  
	  The same problem might affect other paging interfaces: to be
	  determined.
	  
	  Closes Launchpad bug 669247

	* Prevent creation of authority records that are truncated by one
	  letter
	  
	  The summarizeField() function grabbed the values of the XUL
	  elements,
	  which were set by the keypress event listeners on the XUL
	  elements.
	  However, the keypress event listener seems to capture the value
	  of
	  the XUL element before the value of the new key is appended to
	  the
	  existing value in a textbox - so, when you typed a new subfield,
	  then
	  right-clicked to create an authority, the value that was captured
	  was
	  missing the final character.
	  
	  Adding the "input" event to the registered listeners captures the
	  actual value for creating an authority and solves the problem. It
	  might be possible to remove the keypress event listeners, but for
	  now we'll take the cautious route.
	  
	  Address Launchpad bug 669445

2010-11-15  miker

	* Reverting and extending r18472 to correct implementation thinko

2010-11-15  erickson

	* make sure dojo.cookie is loaded before use; removed unnecessary
	  import of dojoData

2010-11-15  senator

	* Backport r18745 from trunk: serials ease-of-use issues
	  
	  It's comical how near a miss this commit is to making it into
	  beta2, but it's
	  fairly minor stuff.

2010-11-15  erickson

	* return AutoIDL to its original state of loading the while IDL if
	  no classes are selected. This will ease the process of moving to
	  /IDL2js; other minor cleanup

2010-11-16  miker

	* push the asset.uri pkey serial into reality -- before 2.0 we did
	  not use the serial

2010-11-16  dbwells

	* Backport r18760: small serial fixes

2010-11-17  gmc

	* add libnet-ssh2-perl to Debian package deps
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-17  miker

	* pass the supplied depth parameter to the query parser for use

	* 0 (zero) is a valid depth, so allow it via defined()

2010-11-17  dbs

	* Add authority control support for 630 and 648 fields
	  
	  Thanks to Ole Kerpel <oke@iisg.nl> for providing the additional
	  definitions for this support to bring us closer to MARC
	  authority control norms.

2010-11-17  senator

	* Hold targeting didn't work right on type I (issuance) holds, but
	  now it does

	* Backport r18762 from trunk:
	  
	  Wonder of wonders, a Dojo data store supporting lazy loading
	  objects via pcrud!
	  
	  So openils.PermaCrud.Store was dreamt up and directed by Mike
	  Rylander, and
	  implemented by me. Right now it gives us a new way to provide
	  widgets for
	  selecting objects in Dojo-based interfaces.
	  
	  Where previously we had some dropdowns here and there that really
	  shouldn't
	  be dropdowns (such as one for selection lists in Acq, and several
	  for resources
	  and resource types in Booking -- these examples I've replaced,
	  but there are
	  surely more) because loading a dropdown with potentially zillions
	  of items
	  to choose from can take forever and break the interface, now we
	  can have
	  autocompleting textboxes that only load items matching what you
	  type (and
	  even then with a low-ish default limit so that if you're vague in
	  your input
	  you still don't get huge unwieldy result sets).
	  
	  Easiest way to see an example is if you already have any acq
	  selection lists.
	  Just go to any catalog record, choose Actions for this Record,
	  choose View/Place
	  orders, then click "Add to Selection List." In the resulting
	  dialog, that
	  second field used to be a dropdown, but now it's an
	  autocompleting textbox.
	  
	  Alternatively, you can see these in the affected booking
	  interfaces (see files
	  modified in this commit) under Admin -> Server Administration ->
	  Booking.
	  
	  The future promises even better things for this store. When it
	  implements the
	  Dojo Write API, interfaces using grids can potentially be vastly
	  simplified
	  by relying on the store to save its own dirty objects. The
	  Notification API
	  would facilitate easy use of single stores with multiple widgets.
	  All good
	  things for faster-to-write interfaces.
	  
	  ------------------------------------------------------------------------

2010-11-18  erickson

	* Apparently, IE versions 6+ can handle ssl+keepalive. this apache
	  change should help speed up IE w/ ssl and reduce server
	  back-and-forth

	* fetch more than the default 10 (per page) distrib formulas; 500
	  is arbitrary, but still notably less than the infinity that was
	  in effect before paging. todo: research optiosn for using the new
	  autofieldwidget/dojo/pcrud-store instead

2010-11-18  gmc

	* fetchItemByIdentity now returns null immediately upon null
	  identity
	  
	  Besides being trivially more efficient, this avoids a situation
	  where pcrud can sometimes time out when attempting to retrieve
	  a row by a null PK value.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* use pcrud auto-complete widget when selecting providers
	  
	  Fixes general slowness working with invoice and PO forms if
	  more than a couple hundred providers are defined.
	  
	  This could be generalized with a bit of work with Fieldmapper
	  to define "has-one-chosen-by-user-from-cast-of-thousands"
	  relationships that should trigger use the auto-complete widget.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* mark some non-NULL provider and EDI fields as required
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-18  dbwells

	* Replace deprecated use of window.opener in unit selection window.

2010-11-18  dbs

	* Unbreak the Russian translation
	  
	  Ampersands at the end of msgstr entries break translate-toolkit
	  but good.

	* Stomp another ru-RU PO problem in lang.dtd

2010-11-18  gmc

	* only allow choice from active providers when creating POs and
	  invoices
	  
	  Also removed cusotm defaultLinkedDataLoader for the provider
	  selection widget;
	  no longer necessary since pcrud handles filter by OUs
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-19  phasefx

	* no one likes the persisting call number with fast add, not even
	  me :)

2010-11-20  dbs

	* Address maintain_control_numbers() database function bug #677160
	  
	  Jason Stephenson reported a bug handling records with multiple
	  001 or 003 fields, and supplied a set of test records to
	  reproduce the condition. The bug caused the ingest process
	  to throw a database error, rolling back the transaction and
	  preventing the actual ingest of those records.
	  
	  The solution was to simplify the logic in
	  maintain_control_numbers().
	  Now, in the case that there are either multiple 001s or 003s in
	  the
	  incoming record, we simply delete all of the 003s and 001s and
	  create the desired 001 and 003. Also, if there are not exactly
	  one
	  001 and one 003 in the incoming record, we do not try to preserve
	  one of those values in the 035 as it would be close to
	  meaningless.
	  
	  Many thanks to Jason for the clear bug report and test cases!

2010-11-22  gmc

	* hold targeter: add option to run parallel targeter processes
	  
	  Permit the hold targeter to divvy up the work and run more than
	  one process
	  at a time by setting the opensrf.xml setting
	  hold_targeter/parallel to a
	  value greater than one. Doing so can significantly reduce the
	  time it takes to (re)target a large number of hold requests,
	  although
	  only up to a point (in other words, if increasing the number of
	  parallel
	  targeters beyond one, it is recommended to do so slowly.)
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* parallel fine generator
	  
	  The fine generator cronjob can now use multiple
	  parallel processes by setting fine_generator/parallel
	  in opensrf.xml to a value greater than 1. This
	  can speed up periodic fine generation in a database
	  containing a large number of overdue loans.
	  
	  Also added a service to return just the list of
	  IDs of overdue loans and reservations - fleshing
	  the entire set of overdue loans when generating fines
	  has been observed to cause significant swap-thrashing in
	  at least one large database.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-22  miker

	* add field to IDL needed by, well, a bunch of stuff:
	  sstr-[has_many]->items

	* more SuperCat XML fixup needed to support serials data --
	  important for opac customization though BibTemplate (as in, "do
	  not blow up")

2010-11-22  gmc

	* bug #680096 - upgrade script to partially reingest bibs after
	  upgrade to 2.0
	  
	  This solves the problem of the new facets sidebar showing up
	  empty in
	  OPAC search results. Since the process of populating
	  metabib.facet_entry
	  and updating metabib.*_field_entry can take a long time on large
	  databases,
	  the update SQL is generated by a separate script,
	  reingest-1.6-2.0.pl. Usage
	  from an example run is:
	  
	  ./reingest-1.6-2.0.pl: generate SQL script to reingest bibs
	  during an upgrade to Evergreen 2.0
	  
	  By default, the script writes to the file reingest-1.6-2.0.sql.
	  To modify
	  this script's behavior, you can supply the following options:
	  
	  --config /path/to/opensrf_core.xml used to get connection
	  information to
	  the Evergreen database
	  --chunk_size n number of bibs to reingest in a chunk;
	  specify if you don't want all of the
	  bibs in the database to be reindexes
	  in a single transaction
	  --output /path/to/output_file.sql path of output SQL file
	  
	  Writing output to file reingest-1.6-2.0.sql
	  
	  SQL script complete. To perform the reingest, please run the
	  script using
	  the psql program, e.g.,
	  
	  psql {connection parameters} < reingest-1.6-2.0.sql
	  
	  If you are running a large Evergreen installation, it is
	  recommend that you
	  examine the script first; note that a reingest of a large
	  Evergreen database
	  can take several hours.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-22  phasefx

	* append to bottom of list for xul-based hold list interfaces. The
	  result of this is that rows appended off-screen (with just the
	  hold id) will not make a network request for fleshing until they
	  either become visible, or a column sort action is initiated

2010-11-22  miker

	* minor FeedTemplate bug fixes

2010-11-22  gmc

	* fix missing dep that prevented acq bib search form from working
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-23  gmc

	* fix broken prefix and namespace URI for the mods32 transform
	  
	  This breakage can be found in databases that started out at
	  version 1.2 or earlier; matters since in-DB ingest is stricter
	  with its XPATH processing.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-23  senator

	* Backport r18838 from trunk
	  
	  Serials: Fix error in batch receiving when trying to change the
	  shelving
	  location of the previous item in the stream when there /is/ no
	  previous
	  item in the stream

2010-11-24  dbs

	* Add an index on asset.copy(create_date) for item-age browse
	  
	  Running an item-age browse against a database with a reasonable
	  number of entries in asset.copy is dog-slow without an index
	  like this.

2010-11-24  senator

	* Backport r18845 from trunk
	  
	  Everything else in the menu is alphabetized (in English anyway),
	  so Copy
	  Template Editor may as well be too.

2010-11-24  dbs

	* Add the asset.copy(create_date) index to the 1.6.1-2.0 update
	  script

2010-11-28  dbs

	* Address 1.6.1-2.0 upgrade problems reported by Ben Shum
	  
	  1. We were attempting to update the asset.uri ID sequence value
	  with the wrong syntax; also, adding just 1 would return an error
	  in the event that only the seed value for asset.uri had been
	  inserted.
	  
	  2. Somehow the body of the maintain_control_numbers() function
	  was pasted twice, resulting in a syntax error.

2010-11-29  phasefx

	* merge r18841 from trunk for label interface bug
	  https://bugs.launchpad.net/evergreen/+bug/677628

2010-11-29  miker

	* Patch from Jeff Godin, backported from trunkified version:
	  
	  In the staff client, the holds context menu option "Edit
	  PickupLibrary" displays and allows selection of org units that it
	  shouldn't.
	  
	  Org units whose type has can_have_users = FALSE are not valid
	  pickup locations.
	  
	  Using the default types as an example, CONS and SYS1 are invalid
	  pickup locations.
	  
	  The OPAC enforces this when allowing patrons to edit a hold.
	  
	  The staff client does not enforce this when staff edit a hold.
	  
	  The can_have_users() method of the au object returns a string 't'
	  or 'f' which is then compared to 0.
	  
	  The attached patch corrects this issue. ( foo == 0 becomes
	  !isTrue(foo) ).

	* logic error (inversion) in retargetting of previous copy when no
	  other holds are looking at it

2010-11-30  gmc

	* fix failure when attempting to create invoice
	  
	  Occurred for line items that were not part of a selection list
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* straighten out triggers that maintain rmsr
	  
	  In particular, make sure that the old zzz_
	  trigger on metabib.real_full_rec is completely removed, as
	  it needlessly slows down bib ingest.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-30  phasefx

	* menu entry for Admin->Server Administration->Acquisitions->Line
	  Item MARC Attribute Definitions

2010-11-30  gmc

	* specify default leader for acq brief bibs
	  
	  In particular, avoid fun that could ensue if the
	  Leader/09 is not set to 'a'.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-30  dbs

	* Enable GET params to be added properly in buildOPACLink()
	  
	  Symptom was that the "?l=#" parameter wasn't being added to the
	  home screen "Advanced Search" link. Cause was that the
	  dojo.addOnLoad(init) call was being made after the
	  dojo.addOnLoad(home_init) call, which depended on globals being
	  set by init(). This started happening when the JavaScript was
	  shifted around in an attempt to kill the white screen of death.
	  
	  There may be other similar issues in other interfaces; keep
	  your eyes open!

2010-11-30  gmc

	* protect some of the supercat browse interfaces from unboundedness
	  
	  E.g., browsing from a call number that contains forward slashes,
	  e.g.,
	  
	  "02/05/2004"
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-11-30  dbs

	* Clean up some of the Apache config mod_rewrite rules
	  
	  Thomas Berezansky suggested some improvements to the mod_rewrite
	  rules in eg_vhost.conf on the -devel mailing list; this is a stab
	  at correcting the most egregious problems.
	  
	  Tested with Zotero and unAPI still works; tested with the staff
	  client and language-switching still works, as do the Conify and
	  Vandelay interfaces. Seems reasonably good.

	* Move Google Preview badge below the book cover image, if there is
	  one
	  
	  There might be a more correct way to do this in CSS, but works++
	  
	  Also, give a little room between the images.

2010-11-30  gmc

	* test case for minimum required version of Perl modules
	  
	  Encode > 2.12 particularly matters, but there are likely
	  others of significance.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-12-01  dbwells

	* Assorted small serials fixes

2010-12-01  dbs

	* Return the copy status name when a copy is not available
	  
	  It looks like the checkout operation used to return a fleshed
	  config.copy_status object, but that changed and we now get a
	  raw ccs ID back.
	  
	  Retrieve the status name using the ccs ID and present that
	  to the users. Also, in case problems like this happen in
	  the future, provide a more specific error message and var
	  name so that it will be (hopefully!) a little clearer what
	  payload was expected in the first place :)
	  
	  Resolves https://bugs.launchpad.net/evergreen/+bug/680575
	  
	  Thanks to Jason Etheridge for a major assist with this bug.

2010-12-02  phasefx

	* copy/paste-o. Retrieve Patron in the patron log section of the
	  Admin->Local Admin->Work Log uses the right list now

2010-12-03  miker

	* Normalize spaces in notcontains advance search query terms to
	  address bug https://bugs.launchpad.net/evergreen/+bug/677122

2010-12-03  senator

	* Backport part of r18912 from trunk
	  
	  BibTemplate: make a couple of IE-friendly changes to BibTemplate.

2010-12-03  miker

	* protect against empty control fields (bad MARC)

	* The "All Subjects" index never made it into 1.6, so we need it in
	  the upgrade script

	* Moving bits around and protecting against a pre-existing
	  subject|complete index definition that some sites have

2010-12-07  senator

	* Backport r18931 from trunk
	  
	  Serials: When the fully compressed serial holdings are active in
	  the OPAC,
	  you get this "issues held" display with an expand/compress toggle
	  that will
	  either show you individual holdings (and allow you to place holds
	  on them)
	  or compressed holdings statements.
	  
	  The functionality existed in trunk before this commit, but this
	  cleans it up
	  and makes it better. It's more consistent with the the result
	  detail table,
	  it doesn't offer you the change to place holds on issues that
	  don't have
	  units (copy-equivalent objects), etc etc.

2010-12-08  dbwells

	* Add a simple subfields_list() method to MFHD/Caption.pm to match
	  that in Holding.pm

	* Support for predicting serials with no chronology caption

2010-12-08  senator

	* Backport r18800 from trunk (I thought I already had! r18932
	  depends on it)
	  
	  Place holds on issuances from the OPAC. Also a couple very minor
	  API
	  documentation fixes.

2010-12-09  phasefx

	* transit isn't in payload first time through with ROUTE_ITEM
	  checkin, fallback on check.org

	* big thinko. Going by the stock receipt template, this should be
	  the workstation lib. Destination is handled by a different
	  variable

2010-12-10  dbs

	* Give the recent_changes list the ability to sort authority
	  records correctly
	  
	  We were always sorting by bibliographic record entry, which does
	  not
	  work all that well for authority records.

	* Return authority records for freshmeat when authority records are
	  requested
	  
	  Previously, freshmeat was hardcoded to return bibliographic
	  records, even
	  when authority records were requested.

2010-12-10  miker

	* Backporting r18957 from trunk:
	  
	  Fix two bugs:
	  * Wide Character warning in authority.generate_overlay_template
	  due to the generated template not being UTF-8 encoded internally
	  * Correctly test the same space-normalization form of the pre-
	  and post-strip records during the application of a replace rule
	  in vandelay.replace_field
	  
	  This addresses https://bugs.launchpad.net/evergreen/+bug/687996
	  for 2.0beta5

	* Provide a mechanism to load any random JS file via
	  dojo.require()-ish syntax.
	  
	  Why would we want to do such a thing, you might ask?
	  
	  Well, the short answer is that Firefox hates pages that have more
	  than one script block (inline is worse than tag) that contains
	  pre-onLoad XHR. So, this allows us to pull the actual loading of
	  JS from the same domain as the page into an inline block. This
	  allows us to eliminate the WSOD on FF by pulling all (dangerous)
	  JS into a single, final inline block, after which we don't care
	  if the DOMContentLoaded event fires -- that's when it should
	  fire, structurally -- but in FF it may fire for a different
	  reason (bug) than it should (fell of the end of the page in the
	  rendering engine).

	* Patch from James Fournie to address
	  https://bugs.launchpad.net/evergreen/+bug/622908 wherein we learn
	  that related item physical description might be used as the main
	  PD of the main item, if the main item lacks such a field in the
	  MARC

	* bumping version numbers

	* arg ... reverting version bump that got applied to the wrong
	  branch

2010-12-13  erickson

	* repaired order-by in update_hard_due_dates function to prevent
	  sql errors

	* repaired order-by in update_hard_due_dates function to prevent
	  sql errors

2010-12-13  miker

	* Backport of r18989: boolean test for hard due force flag

2010-12-13  gmc

	* regularize spelling of "fulfill"
	  
	  Based on patch by Steve Callender
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-12-13  senator

	* Serials: simple bug in batch receive. Certain field values got
	  treated
	  like strings sometimes when they weren't. No more.

2010-12-15  miker

	* Two bug fixes: 1) only allow one fine generator call per
	  circulation during a given transaction; 2) require that a
	  circulation be open, based on the xact_finish field, in order to
	  be the parent of a renewal (I suspect this used to depend on the
	  open-circ view)

2010-12-15  phasefx

	* augment the useragent for the xulrunner staff client

2010-12-15  dbs

	* Address the call number browsing performance problem raised in LP
	  690242
	  
	  The ORDER BY clause currently generated by call number browsing
	  does not
	  have a sufficient index to use to assist the sorting of the
	  returned rows,
	  and consequently does a sequential scan of the asset.call_number
	  table.
	  Which, as you can imagine, is not fast for a system with more
	  than a few
	  thousand call numbers.
	  
	  This adds an index specifically to enable the query to go back to
	  an
	  index scan instead of a sequential scan. We can investigate
	  whether other
	  indexes should be removed to enable efficient data loading once
	  we've
	  squashed the sequential scan problem.

2010-12-16  senator

	* Backport r18852, r19005 from trunk
	  
	  [18852] Serials: make some IDL changes and some changes to field
	  order in an
	  AutoGrid to support easier creation of working copy templates
	  with serials.
	  
	  [19005] Serials: the circ_lib field on a copy template has no
	  meaning in the
	  only context where these copy templates are used, which is
	  serials. Any
	  copy-like objects that are created in serials have their circ_lib
	  determined
	  by distribution.holding_lib
	  
	  So remove the circ_lib from the interface.

2010-12-17  erickson

	* dump() is a mozilla thing; use console.log instead

2010-12-17  dbs

	* Do an equality test, instead of assigning a value
	  
	  Thanks to Bill Erickson for catching this; this fixes a bug where
	  SuperCat requests would end up returning authority records
	  instead of
	  bibliographic records.

2010-12-17  senator

	* Backport r19013 from trunk
	  
	  Thanks to Sally Fortin for drawing attention to this bug, wherein
	  new
	  Holding Subfields can't be created in this interface via the
	  staff client.
	  
	  Acq: Tracked down a small but subtle bug with the Holding
	  Subfield tab of
	  the Provider editor interface.
	  
	  We apparently have a global variable "name" defined somewhere
	  which, when
	  assigned in place of an overrideWidget for an AutoGrid thanks to
	  some vestigial
	  code, ultimately causes an error from within AutoFieldWidget, if
	  you're using
	  the staff client. That's because name is the string
	  "browser_browser" in the
	  staff client, but if you access this interface from Firefox, name
	  is apparently
	  set to some value that evaluates to false in a boolean context,
	  because
	  AutoFieldWidget doesn't choke on it (the comparison at line 182
	  of that file
	  will return false).

2010-12-20  dbs

	* Provide starting context for authority browse in MARC Editor
	  context menu
	  
	  Using the browse interface instead of startwith provides a first
	  page
	  of results that shows some of the authority entries that precede
	  the
	  first alphabetical match for the chosen term. Context is good.

	* Display the tag of the displayed authority record in MARC Editor
	  context
	  
	  We currently display both 1xx and 5xx fields in the authority
	  record,
	  but do not display the tag. This can lead to some confusion when
	  a 5xx
	  field is actually present. Ergo, show the tag to disambiguate the
	  fields
	  in the authority browse selection interface.

	* Display the tag and indicators for authority records in the merge
	  box
	  
	  Also, avoid the risk of creating or stomping on global variables
	  by
	  using 'var' to declare our variables.
	  
	  Also, apply copyright statement for the International Institute
	  of
	  Social History. Thanks for sponsoring this contribution to
	  Evergreen!

	* Add an "Apply full authority" option to the MARC editor
	  
	  By definition, the only subfields that should be applied from an
	  authority record to a bibliographic record are the complete set
	  from the 1XX field of the authority record. So, rather than
	  forcing
	  the user to select the correct subfields from the chosen
	  authority
	  record, give them this handy shortcut to do the right thing.
	  
	  Also, add copyright / licensing header - hopefully accurate.

2010-12-20  senator

	* Acq: In fund propagation and rollover, add amounts as numbers,
	  not strings

2010-12-20  erickson

	* protect against null orig-location resulting in depth=-1 searches
	  after logout

2010-12-21  senator

	* Acq: Fix a bug where upon PO activation, lineitems in the
	  order-ready state
	  would stay there, rather than progressing to the on-order state

2010-12-21  dbs

	* Propagate merged authority record change to bibliographic record
	  
	  Launchpad bug 688015 reported that the merge of authority records
	  resulted in the control number identifier in a controlled field
	  in a bibliographic record changing to the right value, but the
	  value of the field itself wasn't being changed.
	  
	  The problem turned out to be a confusion of the "source" and
	  "target" values in the authority.merge_record() function. Once
	  that was straightened out, the merge updated the controlled
	  field as expected.

	* Add line feeds to the output of org_tree_proximity.pl
	  
	  When another routine was appended to autogen.sh, the output
	  was appended to the result string returned from
	  org_tree_proximity.pl;
	  adding a linefeed cleans that up.

2010-12-21  dbwells

	* 'Bindery' item status rethink - this status should eventually be
	  tracked at the unit level, not the item level.

	* For making predictions, remove some debug/dead code, refresh the
	  list.

2010-12-22  senator

	* OPAC/Serials: small aesthetic change to render held issues more
	  neatly

2010-12-23  miker

	* allow vandelay.replace_field() to handle a complex field spec by
	  splitting and looping; bringing 1.6.1-2.0 upgrade script up to
	  date

	* Patch from Nathanael Schilling protecting cstore/pcrud from
	  no-search-param segfaults (with minor editorializing)

2010-12-23  gmc

	* addressing two Breaker-format issues: 1) supply an "empty"
	  (space) value for indicators in the internal format if they are
	  left out and 2) add indicator placeholders to incoming Breaker
	  datafield lines if they seem to be missing. Addresses
	  https://bugs.launchpad.net/evergreen/+bug/693468
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* When the subfield delimiter is configured as "$" (the default),
	  use {dollar} to represent a literal dollar sign. This is
	  apparently in line with other Breaker-format tools. Fix suggested
	  by Galen Charlton, thanks gmc!
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

	* commit 620f5d756619b84200add4c534a7cf22e1c0d037
	  further fixes to null indicator handling in flat-text MARC editor
	  
	  [1] ensure that null indicators are converted to blanks
	  [2] fix glitch when supplying default indicator values
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2010-12-28  erickson

	* refresh cached user during auth session reset
	  
	  Add a boolean (1/0) param to open-ils.auth.session.reset_timeout
	  that forces open-ils.auth to refresh the cached user object.
	  Useful if
	  a column on actor.usr was updated and the client may be pulling
	  the
	  object from the cache w/ a page reload, etc.
	  
	  Signed-off-by: Bill Erickson <erickson@esilibrary.com>

	* Update auth-cached user after payment
	  
	  After payment toward one's own account, reset the cached user
	  object so
	  that it will contain the latest last_xact_id value. This is
	  necessary
	  for supporting patron credit card payments in the catalog.
	  
	  Signed-off-by: Bill Erickson <erickson@esilibrary.com>

2010-12-29  dbs

	* Towards a more useful authority delete confirmation pane
	  
	  Rather than simply creating a raw confirm dialogue that only
	  provides the cataloguer with the ID of the authority record that
	  is about to be deleted (not an especially useful handle), supply
	  a confirmation dialogue that recaps how many bibliographic
	  records
	  are linked to this authority record and also displays the MARC of
	  the record about to be deleted.
	  
	  Most authority records appear to be short enough that the MARC
	  display is not a concern, but if it becomes a problem we can opt
	  not to show the MARC by default and give the cataloguer the
	  ability
	  to click a "View MARC" button on the confirmation dialog instead.
	  
	  Along the way, make some more variables local and remove some
	  unnecessary workarounds for object IDs.

	* Enhance usability of authority record deletion dialogue
	  
	  Don't show the number of linked bib records unless it is
	  a non-zero sum.
	  
	  Make "Cancel" the button with focus in the dialog, so that
	  an errant press of the "Enter" key doesn't do the wrong thing.
	  
	  Trim space from the authority text in the display. Move the
	  authority text from the dialog title to the contents of the
	  dialog.
	  
	  Do not display the MARC for the authority record by default;
	  add a "View MARC" button and toggle it to show/hide MARC.

	* Invoke MARC editor with the appropriate control number identifier
	  
	  The control number identifier is most critical for the creation
	  of authority records; given that the callers have the required
	  context, have them pass in the control number identifier to the
	  MARC editor. Edit MARC record, new MARC record, import MARC
	  record;
	  those have to be the big ones, right?

	* Create authority records with meaningful cataloging agency values
	  
	  Hardcoded values in the 040 are problematic for sites that want
	  to be a source of authority records; with the addition of another
	  parameter to the
	  open-ils.cat.authority.record.create_from_bib(.readonly)
	  API, we can solve that problem. The callers of this API (the MARC
	  editor)
	  have access to the cat.marc_control_number_identifier OU setting,
	  so as
	  long as that is set correctly, problem solved.

2010-12-29  erickson

	* Vandelay import repairs
	  
	  Disable OpenSRF response chunking on calls that respond with
	  small,
	  sparse status updates.
	  
	  Repaired some bugs with status reporting and changed the
	  reporting style
	  for queue imports to report more early in the import, then
	  plateau.
	  
	  Added some fault-tolerance to record importing
	  
	  Signed-off-by: Bill Erickson <erickson@esilibrary.com>

	* at po activation time, apply the provider's default claim policy
	  to each lineitem when no policy is already applied
	  
	  Signed-off-by: Bill Erickson <berick@esilibrary.com>

2010-12-30  phasefx

	* fix a bug with standing penalties and the stop sign page. We
	  still have a race condition where the stop sign page may not
	  show, and this seems to happen when multiple patrons are
	  retrieved at once from a patron search.

	* Never do money math as anything but pennies I tell you. :-) Three
	  $0.60 transactions run through check-in were showing a running
	  tally of $1.79 instead of $1.80.

2011-01-04  senator

	* Acq: backport r19040 and r19094 from trunk
	  
	  [19040] Acq: support manual claiming as always intended, which to
	  some users
	  means claiming with no predefined policy
	  
	  [19094] Acq: Make manual lineitem claiming work better. When a
	  claiming policy
	  has not been applied, users can now choose claim actions manually
	  (this is what
	  a claiming policy would have specified).

2011-01-04  miker

	* Patch from Jason Stephenson to silence spurious warnings:
	  https://bugs.launchpad.net/evergreen/+bug/695510

	* oils_xpath_table was too strict about field nullness -- we need
	  /some/ data, not /all/ data, to be present

2011-01-04  erickson

	* cleaned up vestigal item import API call; repaired some faulty
	  assumptions in vandelay UI regarding which types of import to
	  attempt based on user input
	  
	  Signed-off-by: Bill Erickson <berick@esilibrary.com>

2011-01-04  miker

	* Addressing https://bugs.launchpad.net/evergreen/+bug/696078 where
	  deleted/inactive records are included in the freshmeat feed.

2011-01-04  erickson

	* mixing use of '/' and '/eg' for the auth cookie path is creating
	  complications; fall back to '/', which is the assumption from
	  most EG code
	  
	  Signed-off-by: Bill Erickson <berick@esilibrary.com>

2011-01-04  dbs

	* Improve see from / see also handling in MARC editor authority
	  menu
	  
	  (Backporting r19091 and r19092 from trunk)
	  
	  The 2.0-style authorities use a browse menu that currently
	  consists
	  of matches against the 1XX entries, which makes working with see
	  from /
	  see also entries rather difficult. To prepare for an authority
	  browse
	  method that does surface matches against 4xx and 5xx entries, we
	  will
	  now display the 4xx and 5xx entries for a given authority record
	  immediately below the 1xx entry in the browse menu, with the
	  entry
	  text italicized, aligned to the right, and prefixed with "See
	  also" or
	  "See from" appropriately. This won't provide a perfect
	  alphabetized
	  solution - we won't know which field provided the alphabetical
	  browse
	  match, so the best we can do is present the 1xx in the main
	  browse
	  menu and the 4xx / 5xx below - but it will provide access to the
	  other
	  references.
	  
	  We now display the 4xx fields in the authority summary / selector
	  menu
	  along with the 5xx fields. As part of making the 4xx and 5xx
	  fields
	  first-class entries in the context menu, 5xx subfields are no
	  longer
	  appended to their 1xx field menu entry with a "/" in the context
	  menu.
	  
	  $0 subfields are no longer added to the 4xx and 5xx fields from
	  the
	  authority summary / selector menu; if a user had selected a 5xx
	  and the
	  $0 that had been added by the menu, the field would have
	  incorrectly been
	  linked to the 1xx authority record. To link to a 5xx entry, for
	  now the
	  workaround is for the user to select the 5xx subfield(s), "Apply
	  Selected",
	  then right-click on the new subfield to generate a new authority
	  context menu.
	  To improve the 5xx handling, we need to make the "See also" entry
	  fire a new
	  authority context menu based on the 5xx contents so that the
	  actual 1xx
	  authority record can be inserted and linked against.
	  
	  Consider an authority record containing the following fields:
	  
	  150 $a Infants
	  450 $a Babies
	  550 $a Children
	  
	  The ASCII-ized authority context menu will now display:
	  
	  Infants ->
	  See from: Babies ->
	  See also: Children ->
	  
	  The submenu in each case will currently lead to the authority
	  record
	  for "Infants". If we teach the underlying authority browse and
	  startswith
	  methods to return matches based on 4xx and 5xx fields instead of
	  just 1xx
	  fields, then the menu triggered by a right-click on "Childs"
	  might look
	  like:
	  
	  Chickens ->
	  Infants ->
	  See from: Babies ->
	  See also: Children ->
	  Choking ->
	  
	  The main entry will be out of alphabetical order, which is not
	  ideal,
	  but the linkage from the 5xx should at least be evident. (Also,
	  this
	  suggests that when clicking on a 5xx entry in the authority menu
	  is
	  changed to launch a new authority menu, it should use the
	  1xx-only
	  browse variant to avoid showing the record from which the user
	  was
	  referred...)

	* Internationalize the JavaScript portion of the "Manage
	  Authorities" interface
	  
	  We can use the dojo i18n infrastructure to support translations
	  of the
	  "Manage Authorities" interface, but unfortunately we still don't
	  have
	  a TT2 solution for i18n. Still, better to do what we can.

	* Clean up marc_export and teach it how to export (all) authority
	  records
	  
	  The new "--type" parameter enables users to specify "authority"
	  and have the expected result.
	  
	  Add an "--all" option to marc_export and silence some warnings
	  
	  Rather than forcing users to generate a set of record IDs using a
	  separate process, the --all option enables to to export all
	  records
	  of the specified type. Note that the approach is basic: grab the
	  record with the highest ID, then start at ID 0 and count up by 1
	  while trying to retrieve each record along the way. While this
	  will
	  undoubtedly generate plenty of warnings for deleted records or
	  gaps
	  in the ID sequences, the alternative of retrieving an ID list for
	  potentially millions of records in large Evergreen instances
	  wasn't
	  appealing.
	  
	  Some other refactoring and fixes:
	  
	  Three large chunks of code were factored out into subroutines to
	  make it a little easier to read the main flow of the code.
	  
	  As we explicitly call uc() on the $format input parameter
	  to begin with, we don't have to call it subsequently.
	  
	  If a requested ID did not exist in the database, then
	  the script would die; now we trap and flag that error but
	  continue to fulfill subsequent requests.
	  
	  The --money parameter is now documented in the help, and
	  the help has a brief overview that describes (poorly) the
	  expected format for the list of IDs.
	  
	  An uninitialized variable error when exporting BRE format
	  records was squashed.
	  
	  Also, $count{did} and $count{bib} resulted in uninitialized
	  variable
	  warnings if no records were actually exported, so initialize them
	  to 0.

2011-01-05  dbs

	* Finish adding authority.js to i18n Makefile
	  
	  Forgot to add some crucial bits in the extensive copy and paste
	  effort that's required to add another file to the i18n build.
	  Sigh. Rewrites welcome! And sorry for leaving this trap for
	  you to fall into, miker.

2011-01-05  erickson

	* roll back xact in set_item_lost when copy is alrady marked lost
	  and we exit the sub; if caller passes an event to
	  editor->die_event, capture it as the editor's last event
	  
	  Signed-off-by: Bill Erickson <berick@esilibrary.com>

2011-01-05  dbs

	* Perhaps naive method of bumping existing custom
	  config.metabib_field entries

2011-01-05  dbwells

	* Unify some summarization code in preparation for further
	  development.

2011-01-07  senator

	* Backport r19134 from trunk
	  
	  Acq: fix prorating bug
	  
	  When prorating, the system decides what funds to target by
	  looking at what
	  funds have already been spent against. Previously, the system
	  only looked at
	  acqie objects, but an invoice can also be composed of acqii
	  objects.

	* Backport r19137 from trunk
	  
	  Make openils.PermaCrud.Store use a default order_by clause in
	  common situations
	  
	  This avoids an issue where, using a FilteringSelect dijit,
	  sometimes you type a
	  couple letters, let's says "ABC", and you get a set of matches
	  like this:
	  
	  "ABCDE"
	  "ABCD"
	  "ABC"
	  
	  just because there happens to be no specific ordering. If you
	  click the ABC
	  match and tab away too quickly, the dijit will reset itself to
	  the first match,
	  "ABCDE". This is probably a Dojo/Dijit bug, as I've been able to
	  duplicate the
	  problem with other stores, but that's all murky.
	  
	  This avoids the issue by making sure the shortest match is at the
	  top of the
	  list.

2011-01-10  dbs

	* Set explicit library versioning for Evergreen 2.0 to 2:0:0
	  
	  This should help for anything linking to core Evergreen
	  libraries;
	  as we revise the -version-info number, anything that links
	  against
	  the core Evergreen libraries will quickly scream if we rev the
	  interface number without specifying via the age number that
	  previous
	  interfaces are still supported. Let's remember to revise it
	  accordingly!
	  
	  Also remove redundant linkage to oils_idl.

	* Clean up c-apps Makefile.am and make everything load cleanly
	  again
	  
	  Executable programs don't have library versions, so don't set
	  -version-info
	  for them.
	  
	  Add -version-info to liboils_idl and liboils_util, and link
	  liboils_util
	  explicitly against liboils_idl rather than relying on AM_LDFLAGS.
	  
	  Set the linking dependencies correctly; if a library links
	  against
	  liboils_util, set that as the sole link dependency; no need for
	  liboils_idl
	  once (let alone twice!)

2011-01-10  erickson

	* avoid fetching user settings for new user registration; the
	  result of fetching settings with a null user id is that settings
	  of the staff/editor were fetched instead, leading to settings
	  that appeared to selected, but were not saved during submit

2011-01-10  dbwells

	* Additional code unification; add 'reset item' capability to
	  unitize_items()

2011-01-11  dbs

	* Backport authority browsing fixes from trunk
	  
	  Primary fix is to remove duplicate records from the results
	  when dupes are returned due to similar 1XX/4XX/5XX values in
	  the same records.

2011-01-11  erickson

	* repaired pending-order vs order-pending thinko. Thanks to Kathy
	  Lussier and Mike R. for the diagnosis

2011-01-11  phasefx

	* fix regression with org selector when specifying ?ol= and the org
	  unit hiding setting is unset

2011-01-11  gmc

	* allow deletion of incomplete invoice LIs
	  
	  Fix silent failure when attempting to delete a LI
	  whose type or cost was not set; dojo.string.subtitute
	  does not like replacement values to be null.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2011-01-12  gmc

	* allow data entry of negative currency amounts
	  
	  Plug in fix for Dojo bug http://bugs.dojotoolkit.org/ticket/9438,
	  which
	  was preventing the input of discounts and credits during invoice
	  creation.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2011-01-12  dbs

	* Backport fixes for custom indexes in the database schema during
	  1.6.1-2.0 upgrade
	  
	  r19133 and r19136 provide more sophisticated, working handling of
	  custom
	  indexes during the 1.6.1-2.0 database schema upgrade.

2011-01-12  gmc

	* AutoFieldWidget no longer uses CurrencyTextBox dijit
	  
	  NumberTextBox used instead to work around problem with
	  CurrencyTextBox's support for negative monetary amounts
	  in Dojo 1.3. See https://bugs.launchpad.net/evergreen/+bug/702117
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2011-01-12  dbs

	* Deprecate overdue/predue config sections in favour of
	  action/trigger
	  
	  Set email notification to "false" for holds, overdues, and
	  predues.
	  
	  Fix one line of whitespace.

	* Add Net::SSH2 to the prereqs as the libnet-ssh2-perl package is
	  not on Debian Lenny

2011-01-14  dbs

	* Enable truncation attribute in Z39.50 queries to be left out
	  entirely
	  
	  Per https://bugs.launchpad.net/evergreen/+bug/702695, some Z39.50
	  servers hate the truncation attribute (@attr 5=anything) and
	  always
	  return 0 hits.
	  
	  This gives you the ability to specify a negative value for the
	  truncation attribute and thereby prevent the truncation attribute
	  from being included in the Z39.50 query for a given server.

2011-01-15  dbwells

	* Postpone advanced serial call-number handling until after 2.0
	  
	  Sharing of a single call-number for multiple volumes, while well
	  intentioned, was not ready for primetime for various reasons.
	  This commit:
	  1) harmonizes and unifies call-number handling in Serial.pm,
	  sticking with current practices
	  2) adds a very basic and now necessary prompt to the Serial
	  Control view

2011-01-17  erickson

	* default ordering-agency org unit to workstation org in PO create
	  dialog

2011-01-17  dbwells

	* In serial control, if they defined a *_call_number, honor it as
	  the default

2011-01-18  dbwells

	* Auto-generation of placeholder barcodes approved for backport

2011-01-18  erickson

	* user saved searches are only accessible to the originating user;
	  remove (incorrect) permacrud config for usr_saved_searches

2011-01-18  gmc

	* fix glitch that could break invoice proration
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2011-01-18  dbwells

	* Protect against blank and invalid scap IDs in issuance editor

2011-01-19  dbs

	* Avoid escaping issues in authority.normalize_heading() by
	  parameterizing the query
	  
	  Long story short: MARC subfield values containing backslashes
	  caused noise
	  and in some cases painful errors. Using
	  spi_prepare/spi_exec_query is the
	  safest way of handling escaping, rather than adding more regexes
	  and munging
	  the data before it even gets to naco_normalize().
	  
	  Most painful case was <subfield code="a">Foo, Bar\</subfield> -
	  the trailing
	  slash ended up escaping the enclosing single quote (because
	  PostgreSQL isn't
	  configured by default with strict conformance to SQL escaping
	  rules yet) and
	  threw an error.

2011-01-19  gmc

	* backport naco_normalize revisions to rel_2_0
	  
	  This implements the latest version of the NACO
	  normalization specification found at
	  
	  http://www.loc.gov/catdir/pcc/naco/SCA_PccNormalization_Final_revised.pdf
	  
	  This version of the algorithm is more general -- for example,
	  all combining characters are removed -- so there should be
	  fewer fiddly edge cases to worry about for most European
	  languages.
	  
	  Rebuilding the metabib.*_field_entry tables (e.g., by using
	  reingest-1.6-2.0.pl) is recommended if there are any bibs that
	  contain
	  any non-ASCII characters.
	  
	  Normalized text is now left in the NFKD form, so while this
	  should
	  be transparent to the search system after reindexing, it does
	  mean
	  that (for example) Korean text in metabib.*_field_entry may not
	  be in the same Unicode normalization form as that found in
	  biblio.record_entry.
	  
	  Also includes fix for bug #684467: more bulletproofing of
	  naco_normalize
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2011-01-19  miker

	* Build and flatten a tree, correcting a sorting issue in some OU
	  dropdowns.
	  
	  The previous code assumed that work org units would be delivered
	  in hierarchical order, but alas, they are not. Thus, we build the
	  hierarchy and then flatten it, sorting at each level. This will
	  be non-fast with many work OUs, but the common case is a small
	  set, which is not painful.
	  
	  Further improvement is warranted when the above proves false.

2011-01-19  senator

	* Backport r19214 from trunk
	  
	  Booking: Robert Soulliere spotted and fixed a bug in processing
	  reservation-
	  related overdue fines. See
	  https://bugs.launchpad.net/evergreen/+bug/705061

2011-01-19  phasefx

	* let amnesty checkin mode trump the restore overdues on lost
	  checkin setting

2011-01-19  erickson

	* remove disallowed permission groups from the perm group selector
	  in user registration; see bug 699914

	* if this user does not have permission to edit an existing user,
	  disable the save and clone buttons

2011-01-20  senator

	* Backport r19229 from trunk
	  
	  Booking: these lines don't belong; they were erroneously copied
	  and pasted
	  from a neighboring section of the file

2011-01-20  phasefx

	* don't offer to cancel related transits that have already
	  completed when canceling holds

2011-01-20  senator

	* Backport r19239 from trunk
	  
	  Acq: use the acqlimad table instead of its ancestor acqliad table
	  to
	  populate a dropdown for the Export Single Attribute List function
	  of lists
	  of lineitems
	  
	  The acqliad table may appear to have duplicate entries since it's
	  a parent, and
	  the point of the function that's trying to use it is just to
	  export lists of
	  ISBNs or UPCs, so acqlimad is a better fit.

	* Backport r19241 from trunk
	  
	  Acq: the "Load Catalog Record IDs" interface failed on files
	  produced in
	  Windows due to not stripping out carriage returns. Fixed.

2011-01-21  dbs

	* Towards a more secure default setup
	  
	  Shipping with a default account user name and password is
	  considered
	  an authentication anti-pattern; see
	  http://code.google.com/p/owasp-development-guide/wiki/WebAppSecDesignGuide_D2
	  
	  By making the user select an admin user name and password at the
	  time
	  they create the database, we avoid the chance that they will
	  forget to
	  change the default password and leave their system open to
	  access.
	  
	  Next step is to change the seed data to insert random values for
	  the
	  admin username and password, then update the documentation
	  accordingly.

	* Part 2 of creating a more secure default setup
	  
	  With this commit, the user name and password for the
	  administrative
	  user will be MD5 hashes of a random string of numbers. You can
	  set
	  the user name and password to your liking using the --admin-user
	  and
	  --admin-pass switches for eg_db_config.pl (this will be the
	  documented method in the install docs) or via straight SQL as:
	  
	  UPDATE actor.usr SET usrname = 'FOO', passwd = 'BAR' WHERE id =
	  1;

	* Part 3 of a more secure default set up
	  
	  With this commit, the hardcoded default barcode is replaced by an
	  MD5 hash of a random string of numbers, preventing the barcode
	  from
	  being used as a known login name in the OPAC interface (which
	  would
	  remove one of the factors required in a brute forcing of the
	  account
	  credentials).
	  
	  You probably don't want to change the barcode for the admin user,
	  but if you feel the need you can use the usual patron editor in
	  the staff client.
	  
	  Thanks to Thomas Berezansky for suggesting this additional
	  change.

2011-01-21  miker

	* Move to the prettier and more useful Laurentian local call number
	  display code as the example

2011-01-21  dbs

	* Avoid hard-coded location IDs for displaying library / call
	  number / copy location /copy status
	  
	  Also use marcxml-full to get the copy location opac visibility
	  attribute,
	  and remove the "hide_me" attribute to make the results visible by
	  default.

2011-01-21  miker

	* slimpac issue where deleted copies are visisble, spotted by Steve
	  Callendar and Jason Etheridge

2011-01-21  dbs

	* Use holdings_xml-full for the copy display
	  
	  Less to munge and transfer over the wire = win win win!

	* Protect against volumes with many copies attached
	  
	  Bill Erickson has good data for testing these cases.

2011-01-22  gmc

	* handle deleting line item from selection list more carefully
	  
	  Once a line item is attached to a purchase order, removing it
	  from a selection list should mean detaching it from the list,
	  not deleting it outright.
	  
	  The open-ils.acq.lineitem.delete method can be removed
	  once the old jubgrid code is finally purged.
	  
	  Signed-off-by: Galen Charlton <gmc@esilibrary.com>

2011-01-23  miker

	* correct XPath attribute test syntax

2011-01-24  miker

	* Fix for spurious warning (LP bug #707114)

2011-01-24  dbs

	* i18n support for a few OPAC strings
	  
	  Enable translation of the "More copies listed in full record
	  details"
	  message for the search results library / call number / item
	  /status
	  lines
	  
	  Also provide translation support for the hold queue status
	  message,
	  including singular / plural variants (most languages do not
	  provide
	  the equivalent of the "item(s)" idiom in English).
	  
	  Instead of burying the display of hold queue status with a hard
	  coded "if (false)" test, turn it into a top-level variable for
	  a bit more exposure.

	* Updated POT from a recent checkout and "make newpot" of 2.0

2011-01-24  dbwells

	* Correct for over-zealous sdist editor field display code

	* Expose (in a very basic way) existing serial item reset
	  functionality, fix small bug in reset code (resetting an item
	  with no unit)
	  
	  Apologies in advance if this shouldn't be backported at this
	  point, but from my perspective, it is both high-value and
	  low-risk.

2011-01-25  dbs

	* Fix existing serial entities that didn't provide .label partners
	  for .accesskey
	  
	  The translate-toolkit project generates a POT file from an input
	  DTD
	  that requires entities ending in .accesskey to have a
	  corresponding
	  .label entity; this is a Mozilla convention for localization. Fix
	  up
	  the serial interface strings that are localized to match this
	  expectation.
	  
	  Also remove two duplicate entities in lang.dtd that were flagged
	  by
	  the build/i18n/tests/check_entities.py script (and which cause
	  Launchpad
	  translation imports to break).

	* Replace a few hardcoded strings in the serials JavaScript
	  
	  There is, unfortunately, an awful lot of this left to fix.

	* Teach the i18n Makefile how to handle serial.properties
	  
	  Also check in the POT for serial.properties and some other
	  foobar.label matches for foobar.accesskey (does not have
	  an effect on properties files but hopefully if we're
	  consistent then the pattern will be evident for entities).
	  
	  Noting in passing that there are a number of "foobar(s)"
	  comined singular/plural labels that should be split to
	  support translation.

2011-01-25  dbwells

	* Small serial interface string fixes

2011-01-25  phasefx

	* backport 19287 for button bar image tweaks, courtesy of Michael
	  Peters

2011-01-25  dbwells

	* Translation string in manage_dists.js : right problem, wrong fix

2011-01-25  phasefx

	* mark this as binary

	* fix the svn:mimetype properties for these

2011-01-25  dbwells

	* This menu was for a different tab (subscriptions), comment out
	  for now

	* Fix broken stream functions, re-enable commented-out menu with
	  correct options

	* Backport r19288 : twice tested, thrice approved
	  
	  This change was confirmed to work at two test sites, and also
	  passed a berick eyeball test. Would always be nice to have
	  more...

2011-01-26  dbwells

	* Clear out some unused code, which in some cases was causing
	  "command bleed"

	* Open-ILS/xul/staff_client/server/locale/en-US/serial.properties

2011-01-26  miker

	* .: 2.0.0 for realz, yo!
	  
	  (For Grace)

